(window.webpackJsonp=window.webpackJsonp||[]).push([[252],{721:function(s,t,a){"use strict";a.r(t);var n=a(29),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"äº‹åŠ¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡"}},[s._v("#")]),s._v(" äº‹åŠ¡")]),s._v(" "),a("ul",[a("li",[s._v("äº‹åŠ¡æ˜¯æ•°æ®åº“æ“ä½œçš„"),a("strong",[s._v("æœ€åŸºæœ¬å•å…ƒ")]),s._v("ï¼Œé€»è¾‘ä¸Šæ˜¯ä¸€ç»„æ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œå¦‚æœæœ‰ä¸€ä¸ªå¤±è´¥æ‰€æœ‰æ“ä½œéƒ½å¤±è´¥ã€‚")]),s._v(" "),a("li",[s._v("å…¸å‹åœºæ™¯ï¼šé“¶è¡Œè½¬å¸ï¼ˆåªè¦æœ‰å‡ºé”™ï¼Œäº¤æ˜“éƒ½ä¼šä¸­æ–­ï¼‰ã€‚")])]),s._v(" "),a("blockquote",[a("p",[s._v("ğŸ”— "),a("strong",[s._v("äº‹åŠ¡çš„ç‰¹æ€§")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("åŸå­æ€§ï¼ˆ"),a("strong",[s._v("A")]),s._v("tomicityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸å¯åˆ†å‰²ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("ä¸€è‡´æ€§ï¼ˆ"),a("strong",[s._v("C")]),s._v("onsistencyï¼‰ï¼šäº‹åŠ¡æ“ä½œä¹‹å‰å’Œæ“ä½œä¹‹åï¼Œæ€»é‡ä¿æŒä¸å˜ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("éš”ç¦»æ€§ï¼ˆ"),a("strong",[s._v("I")]),s._v("solationï¼‰ï¼šå¤šäº‹åŠ¡æ“ä½œæ—¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šäº§ç”Ÿå½±å“ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("æŒä¹…æ€§ï¼ˆ"),a("strong",[s._v("D")]),s._v("urabilityï¼‰ï¼šäº‹åŠ¡æœ€ç»ˆæäº¤åï¼Œæ•°æ®åº“è¡¨ä¸­æ•°æ®æ‰ä¼šçœŸæ­£å‘ç”Ÿå˜åŒ–ã€‚")])])])]),s._v(" "),a("h2",{attrs:{id:"äº‹åŠ¡æ“ä½œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡æ“ä½œ"}},[s._v("#")]),s._v(" äº‹åŠ¡æ“ä½œ")]),s._v(" "),a("p",[s._v("å¯ä»¥æŒ‰ç…§ JavaEE çš„å…¸å‹ä¸‰å±‚ç»“æ„å®ç°ï¼Œç›®å‰é¦–å…ˆå…³æ³¨  "),a("code",[s._v("Service")]),s._v("  ä¸šåŠ¡æ“ä½œå±‚å’Œ  "),a("code",[s._v("DAO")]),s._v("  æ•°æ®åº“æ“ä½œå±‚ã€‚")]),s._v(" "),a("h3",{attrs:{id:"å‡†å¤‡äº‹åŠ¡æ“ä½œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‡†å¤‡äº‹åŠ¡æ“ä½œ"}},[s._v("#")]),s._v(" å‡†å¤‡äº‹åŠ¡æ“ä½œ")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("ä¸»è¦æ­¥éª¤ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("åˆ›å»ºæ•°æ®åº“è¡¨  "),a("code",[s._v("t_account")]),s._v("  ï¼Œæ·»åŠ å‡ æ¡äº¤æ˜“è®°å½•ã€‚")]),s._v(" "),a("li",[s._v("åˆ›å»ºå¯¹åº”çš„  "),a("code",[s._v("Service")]),s._v("  å’Œ  "),a("code",[s._v("DAO")]),s._v("  ç±»ï¼Œå®Œæˆå¯¹è±¡åˆ›å»ºå’Œå…³ç³»æ³¨å…¥ã€‚")]),s._v(" "),a("li",[s._v("åœ¨  "),a("code",[s._v("Service")]),s._v("  å’Œ  "),a("code",[s._v("DAO")]),s._v("  ä¸­ç¼–å†™ç›¸åº”çš„ä»£ç å®ŒæˆåŠŸèƒ½é€»è¾‘éƒ¨åˆ†ã€‚")])])]),s._v(" "),a("li",[a("p",[s._v("åˆ›å»ºæ•°æ®åº“è¡¨  "),a("code",[s._v("t_account")]),s._v("  ï¼Œæ·»åŠ å‡ æ¡äº¤æ˜“è®°å½•ã€‚")])])]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" t_account\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    id       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    username "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    amount   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("constraint")]),s._v(" transfer_record_pk\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("primary")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t_account "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Lucy'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t_account "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Mary'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("blockquote",[a("p",[s._v("Spring ä¸ Mybatis çš„æ•´åˆä½¿ç”¨åœ¨ä¸Šä¸€èŠ‚å·²ç»è¯¦ç»†è®°å½•æ­¥éª¤ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚")])]),s._v(" "),a("ul",[a("li",[s._v("åˆ›å»º  "),a("code",[s._v("TransferRecordDAO")]),s._v("  æŠ½è±¡ç±»ã€‚")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Repository")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferDAO")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SELECT * FROM t_account"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Account")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("findAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UPDATE t_account set amount=amount-#{amount} where username=#{username}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Param")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"amount"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Param")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"update t_account set amount=amount+#{amount} where username=#{username}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferIn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Param")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"amount"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Param")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("ul",[a("li",[s._v("åˆ›å»º  "),a("code",[s._v("TransferRecordService")]),s._v("  ç±»ï¼Œå¹¶å®Œæˆ  "),a("code",[s._v("TransferRecordDAO")]),s._v("  çš„æ³¨å…¥ï¼Œè°ƒç”¨  "),a("code",[s._v("TransferRecordDAO")]),s._v("  çš„æ–¹æ³•ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordDAO")]),s._v(" transferRecordDAO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getAllAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Account")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" accounts "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" transferDAO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("findAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Account")]),s._v(" account "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" accounts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("account"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"transfer start ... "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        transferDAO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        transferDAO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferIn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"transfer end ... "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("ul",[a("li",[s._v("ç¼–å†™æµ‹è¯•æ–¹æ³•ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testTransferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ApplicationContext")]),s._v(" context "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AnnotationConfigApplicationContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpringConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferService")]),s._v(" transferService "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"transferService"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferService")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    transferService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getAllAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    transferService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Lucy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mary"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    transferService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getAllAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("blockquote",[a("p",[s._v("ä»¥ä¸Šæ— å¼‚å¸¸æƒ…å†µä¸‹ï¼Œ å¯ä»¥å®Œæˆä¸€æ¬¡äº¤æ˜“ã€‚")])]),s._v(" "),a("h3",{attrs:{id:"å¼•å…¥äº‹åŠ¡åœºæ™¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¼•å…¥äº‹åŠ¡åœºæ™¯"}},[s._v("#")]),s._v(" å¼•å…¥äº‹åŠ¡åœºæ™¯")]),s._v(" "),a("p",[s._v("å½“è½¬è´¦ä¸­é€”å‘ç”Ÿå¼‚å¸¸æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œç½‘ç»œå¼‚å¸¸ï¼‰ï¼Œå°è¯•æ¨¡æ‹Ÿå¼‚å¸¸æƒ…å†µï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¿®æ”¹  "),a("code",[s._v("TransferRecordService")]),s._v("  ä¸­çš„æ–¹æ³•ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    transferRecordDAO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    transferRecordDAO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferIn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("ï¼ˆåœ¨æµ‹è¯•æ•°æ®å¤åŸï¼‰è¿è¡Œæµ‹è¯•æ–¹æ³•ï¼ŒæŠ›å‡ºæ— æ³•å®Œæˆæ“ä½œçš„å¼‚å¸¸ï¼š")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("java.lang.ArithmeticException: / by zero\n\n\tat com.simon.service.TransferRecordService.transferAccounts(TransferRecordService.java:13)\n\tat com.simon.service.TransferRecordTest.testTransferAccounts(TransferRecordTest.java:14)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("æ­¤æ—¶å‡ºç°è‡´å‘½æ€§çš„é—®é¢˜ï¼Œå›çœ‹æ•°æ®åº“çš„æ•°æ®ï¼Œå‘ç°è½¬å‡ºè´¦æ–¹è¢«è½¬å‡ºé‡‘é¢ï¼Œè€Œæ”¶è´¦æ–¹å´æ²¡æœ‰æ”¶åˆ°ç›¸åº”çš„é‡‘é¢ã€‚æ­¤æ—¶ï¼Œäº‹åŠ¡çš„ä½œç”¨å°±åœ¨è¿™é‡Œä½“ç°å‡ºæ¥äº†ã€‚")])]),s._v(" "),a("h3",{attrs:{id:"äº‹åŠ¡åŸºæœ¬æ“ä½œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡åŸºæœ¬æ“ä½œ"}},[s._v("#")]),s._v(" äº‹åŠ¡åŸºæœ¬æ“ä½œ")]),s._v(" "),a("ol",[a("li",[s._v("å¼€å¯ä¸€ä¸ªäº‹åŠ¡")]),s._v(" "),a("li",[s._v("è¿›è¡Œä¸šåŠ¡é€»è¾‘å®ç°")]),s._v(" "),a("li",[s._v("æ²¡æœ‰å¼‚å¸¸ï¼Œåˆ™"),a("strong",[s._v("æäº¤äº‹åŠ¡")])]),s._v(" "),a("li",[s._v("å‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™"),a("strong",[s._v("å›æ»šäº‹åŠ¡")])])]),s._v(" "),a("p",[s._v("ğŸŒ° å°†å‰è¿°è½¬è´¦ä¾‹å­  "),a("code",[s._v("TransferRecordService")]),s._v("  ä¸­çš„æ–¹æ³•å¼•å…¥äº‹åŠ¡çš„åŸºæœ¬æ¡†æ¶ï¼š")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Step1ã€å¼€å¯ä¸€ä¸ªäº‹åŠ¡")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Step2ã€è¿›è¡Œä¸šåŠ¡é€»è¾‘å®ç°")]),s._v("\n    transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸è€Œå¯¼è‡´æ“ä½œä¸­æ–­")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferIn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Step3ã€æ²¡æœ‰å¼‚å¸¸ï¼Œåˆ™æäº¤äº‹åŠ¡")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Step4ã€å‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"å£°æ˜å¼äº‹åŠ¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å£°æ˜å¼äº‹åŠ¡"}},[s._v("#")]),s._v(" å£°æ˜å¼äº‹åŠ¡")]),s._v(" "),a("h3",{attrs:{id:"spring-äº‹åŠ¡ç®¡ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spring-äº‹åŠ¡ç®¡ç†"}},[s._v("#")]),s._v(" Spring äº‹åŠ¡ç®¡ç†")]),s._v(" "),a("p",[s._v("åœ¨ Spring ä¸­è¿›è¡Œäº‹åŠ¡ç®¡ç†æœ‰ä¸¤ç§æ–¹å¼ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼šåœ¨å‰è¿°çš„äº‹åŠ¡åŸºæœ¬æ“ä½œå®ç°å°±æ˜¯å…¸å‹çš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ã€‚è¿™ç§æ–¹å¼è™½ç„¶å¹¶ä¸å¥½ï¼Œä½†æ˜¯å¯ä»¥äº†è§£è¿™ä¸ªäº‹åŠ¡çš„æ“ä½œè¿‡ç¨‹ï¼Œä¸€èˆ¬ç”±äºä¸æ–¹ä¾¿ã€å¯¼è‡´ä»£ç çš„è‡ƒè‚¿ã€ç»´æŠ¤èµ·æ¥éº»çƒ¦è€Œä¸ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("å£°æ˜å¼äº‹åŠ¡ç®¡ç†")]),s._v("ï¼ˆæ¨èä½¿ç”¨ï¼‰ï¼šåº•å±‚åŸç†å°±æ˜¯ "),a("RouterLink",{attrs:{to:"/pages/dad650/"}},[s._v("Spring AOP")]),s._v(" ï¼Œåœ¨ä¸æ”¹å˜åŸæ¥çš„ä»£ç é€»è¾‘çš„åŸºç¡€ä¸Šï¼Œæ‹“å±•ä»£ç çš„åŠŸèƒ½ã€‚æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š\n"),a("ul",[a("li",[a("strong",[s._v("åŸºäºæ³¨è§£æ–¹å¼å®ç°")]),s._v("ï¼ˆæ¨èä½¿ç”¨ï¼‰")]),s._v(" "),a("li",[s._v("åŸºäº XML é…ç½®æ–‡ä»¶å®ç°")])])],1)]),s._v(" "),a("h3",{attrs:{id:"spring-äº‹åŠ¡ç®¡ç†-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spring-äº‹åŠ¡ç®¡ç†-api"}},[s._v("#")]),s._v(" Spring äº‹åŠ¡ç®¡ç† API")]),s._v(" "),a("p",[s._v("Spring æä¾›äº†ä¸€ä¸ªæ¥å£ä»£è¡¨äº‹åŠ¡ç®¡ç†å™¨ï¼Œé’ˆå¯¹ä¸åŒçš„ JDBC æ¡†æ¶å­˜åœ¨ä¸åŒçš„å®ç°ç±»ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("PlatformTransactionManager")]),s._v("  æ¥å£ï¼šå³äº‹åŠ¡ç®¡ç†å™¨ï¼Œæœ‰å¤šä¸ªä¸åŒçš„æŠ½è±¡ç±»å’Œå…·ä½“å®ç°ç±»ï¼Œå¯æ»¡è¶³ä¸åŒçš„æ¡†æ¶ã€‚")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("DataSourceTrasactionManager")]),s._v("  å®ç°ç±»ï¼š "),a("code",[s._v("JdbcTemplate")]),s._v("  å’Œ  "),a("code",[s._v("MyBatis")]),s._v("  æ¡†æ¶ä½¿ç”¨åˆ°å®ƒã€‚")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("HibernateTransactionManager")]),s._v("  å®ç°ç±»ï¼š "),a("code",[s._v("Hibernate")]),s._v("  æ¡†æ¶ä½¿ç”¨åˆ°å®ƒã€‚")])])]),s._v(" "),a("h3",{attrs:{id:"æ³¨è§£å®ç°å£°æ˜å¼äº‹åŠ¡ç®¡ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ³¨è§£å®ç°å£°æ˜å¼äº‹åŠ¡ç®¡ç†"}},[s._v("#")]),s._v(" æ³¨è§£å®ç°å£°æ˜å¼äº‹åŠ¡ç®¡ç†")]),s._v(" "),a("ul",[a("li",[s._v("åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®äº‹åŠ¡ç®¡ç†å™¨  "),a("code",[s._v("DataSourceTransactionManager")]),s._v("  çš„å¯¹è±¡åˆ›å»ºã€‚")])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--é…ç½®äº‹åŠ¡ç®¡ç†å™¨--\x3e")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("bean")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("transactionManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("org.springframework.jdbc.datasource.DataSourceTransactionManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("property")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("dataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("dataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("bean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("property")]),s._v("  è®¾ç½®çš„å±æ€§ä¸ºç›®å‰ä½¿ç”¨çš„  "),a("code",[s._v("dataSource")]),s._v("  å¯¹è±¡ã€‚")])]),s._v(" "),a("ul",[a("li",[s._v("åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å¼€å¯äº‹åŠ¡ï¼ˆæ³¨è§£æ–¹å¼ï¼‰ï¼š\n"),a("ul",[a("li",[s._v("å¼•å…¥  "),a("code",[s._v("xmlns:tx")]),s._v("  çš„åç§°ç©ºé—´")]),s._v(" "),a("li",[s._v("é…ç½®  "),a("code",[s._v("<tx:annotation-driven>")]),s._v("  æ ‡ç­¾å¼€å¯äº‹åŠ¡æ³¨è§£é©±åŠ¨")])])])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--å¼€å¯äº‹åŠ¡æ³¨è§£--\x3e")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("tx:")]),s._v("annotation-driven")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("transaction-manager")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("transactionManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("transaction-manager")]),s._v("  å±æ€§é…ç½®å½“å‰çš„äº‹åŠ¡ç®¡ç†å™¨ã€‚")])]),s._v(" "),a("p",[s._v("ï¼ˆæ­¤å¤„å®ç°æ³¨è§£å®ç°å£°æ˜å¼äº‹åŠ¡ç®¡ç†ä¾æ—§éœ€è¦ä¾é  Spring é…ç½®æ–‡ä»¶å¼€å¯äº‹åŠ¡æ³¨è§£ï¼Œè¦å®ç°å®Œæ•´æ³¨è§£å¼€å‘è¯·çœ‹åå¤„ä»‹ç»ã€‚ï¼‰")]),s._v(" "),a("p",[s._v("ğŸŒ° å»¶ç»­å‰è¿°çš„ä¾‹å­ï¼Œåœ¨  "),a("code",[s._v("TransferRecordService")]),s._v("  ä¸­æ·»åŠ äº‹åŠ¡æ³¨è§£  "),a("code",[s._v("@Transactional")]),s._v(" ï¼š")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ... ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("æ³¨è§£  "),a("code",[s._v("@Transactional")]),s._v("  ä¸­é…ç½®äº‹åŠ¡ç›¸å…³çš„å‚æ•°ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("propagation")]),s._v(" ï¼šäº‹åŠ¡ä¼ æ’­è¡Œä¸º")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("isolation")]),s._v(" ï¼šäº‹åŠ¡éš”ç¦»çº§åˆ«")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("timeout")]),s._v(" ï¼šè¶…æ—¶æ—¶é—´")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("readOnly")]),s._v(" ï¼šæ˜¯å¦åªè¯»")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("rollbackFor")]),s._v(" ï¼šå›æ»š")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("noRollbackFor")]),s._v(" ï¼šä¸å›æ»š")])])])])]),s._v(" "),a("h4",{attrs:{id:"ä¼ æ’­è¡Œä¸º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¼ æ’­è¡Œä¸º"}},[s._v("#")]),s._v(" ä¼ æ’­è¡Œä¸º")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("äº‹åŠ¡ä¼ æ’­è¡Œä¸º")]),s._v("ï¼šå¤šäº‹åŠ¡æ–¹æ³•ç›´æ¥è¿›è¡Œè°ƒç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­äº‹åŠ¡æ˜¯å¦‚ä½•è¿›è¡Œç®¡ç†çš„ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("äº‹åŠ¡æ–¹æ³•")]),s._v("ï¼šè®©æ•°æ®è¡¨æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ“ä½œã€‚")])]),s._v(" "),a("p",[s._v("äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º"),a("strong",[s._v("å¯ä»¥æœ‰ä¼ æ’­å±æ€§æŒ‡å®š")]),s._v("ã€‚Spring æ¡†æ¶ä¸­å®šä¹‰äº† 7 ç§ç±»ä¼ æ’­è¡Œä¸ºï¼š")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("ä¼ æ’­å±æ€§")]),s._v(" "),a("th",[s._v("æè¿°")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("REQUIRED")])]),s._v(" "),a("td",[s._v("å¦‚æœæœ‰äº‹åŠ¡åœ¨è¿è¡Œï¼Œå½“å‰æ–¹æ³•å°±åœ¨æ­¤äº‹åŠ¡å†…è¿è¡Œï¼›å¦åˆ™ï¼Œå°±å¯åŠ¨ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡å†…è¿è¡Œ")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("REQUIRED_NEW")])]),s._v(" "),a("td",[s._v("å½“å‰æ–¹æ³•å¿…é¡»å¯åŠ¨æ–°äº‹åŠ¡ï¼Œå¹¶åœ¨å®ƒè‡ªå·±çš„äº‹åŠ¡å†…è¿è¡Œï¼›å¦‚æœæœ‰äº‹åŠ¡æ­£åœ¨è¿è¡Œï¼Œåº”è¯¥å°†å®ƒæŒ‚èµ·")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("SUPPORTS")])]),s._v(" "),a("td",[s._v("å¦‚æœæœ‰äº‹åŠ¡åœ¨è¿è¡Œï¼Œå½“å‰æ–¹æ³•å°±åœ¨æ­¤äº‹åŠ¡å†…è¿è¡Œï¼›å¦åˆ™ï¼Œå®ƒå¯ä»¥ä¸è¿è¡Œåœ¨äº‹åŠ¡ä¸­")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("NOT_SOPPORTED")])]),s._v(" "),a("td",[s._v("å½“å‰æ–¹æ³•ä¸åº”è¯¥è¿è¡Œåœ¨äº‹åŠ¡å†…éƒ¨ï¼Œå¦‚æœæœ‰è¿è¡Œçš„äº‹åŠ¡ï¼Œå°±å°†å®ƒæŒ‚èµ·")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("MANDATORY")])]),s._v(" "),a("td",[s._v("å½“å‰æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨äº‹åŠ¡å†…éƒ¨ï¼Œå¦‚æœæ²¡æœ‰æ­£åœ¨è¿è¡Œçš„äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("NEVER")])]),s._v(" "),a("td",[s._v("å½“å‰æ–¹æ³•ä¸åº”è¯¥è¿è¡Œåœ¨äº‹åŠ¡ä¸­ï¼Œå¦‚æœæœ‰è¿è¡Œçš„äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("NESTED")])]),s._v(" "),a("td",[s._v("å¦‚æœæœ‰äº‹åŠ¡åœ¨è¿è¡Œï¼Œå½“å‰æ–¹æ³•å°±åº”è¯¥åœ¨æ­¤äº‹åŠ¡çš„åµŒå¥—äº‹åŠ¡å†…è¿è¡Œï¼›å¦åˆ™ï¼Œå°±å¯åŠ¨ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¹¶åœ¨å®ƒè‡ªå·±çš„äº‹åŠ¡å†…è¿è¡Œ")])])])]),s._v(" "),a("p",[s._v("ğŸŒ° ä¾‹å­ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ç°æœ‰æœ‰ä¸¤ä¸ªæ–¹æ³•  "),a("code",[s._v("add()")]),s._v("  å’Œ  "),a("code",[s._v("update()")]),s._v("  ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// do something")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("æŒ‰ç…§ä¸åŒçš„ä¼ æ’­è¡Œä¸ºï¼Œå¯ä»¥æœ‰ä¸¤ç§è§£é‡Šï¼š\n"),a("ul",[a("li",[a("code",[s._v("REQUIRED")]),s._v("  ï¼š1ï¸âƒ£ å¦‚æœ  "),a("code",[s._v("add()")]),s._v("  æ–¹æ³•æœ¬èº«æœ‰äº‹åŠ¡ï¼Œè°ƒç”¨  "),a("code",[s._v("update()")]),s._v("  æ–¹æ³•ä¹‹åï¼Œ "),a("code",[s._v("update()")]),s._v("  ä½¿ç”¨å½“å‰  "),a("code",[s._v("add()")]),s._v("  æ–¹æ³•é‡Œé¢äº‹åŠ¡ã€‚2ï¸âƒ£ å¦‚æœ  "),a("code",[s._v("add()")]),s._v("  æ–¹æ³•æœ¬èº«æ²¡æœ‰äº‹åŠ¡ï¼Œè°ƒç”¨  "),a("code",[s._v("update()")]),s._v("  æ–¹æ³•ä¹‹åï¼Œåˆ›å»ºæ–°çš„äº‹åŠ¡ã€‚âš ï¸ æ˜¯"),a("strong",[s._v("é»˜è®¤äº‹åŠ¡ä¼ æ’­è¡Œä¸º")]),s._v("ã€‚")]),s._v(" "),a("li",[a("code",[s._v("REQUIRED_NEW")]),s._v(" ï¼šä½¿ç”¨  "),a("code",[s._v("add()")]),s._v("   æ–¹æ³•è°ƒç”¨  "),a("code",[s._v("update()")]),s._v("  æ–¹æ³•ï¼Œæ— è®º  "),a("code",[s._v("add()")]),s._v(" "),a("strong",[s._v("æ˜¯å¦æœ‰äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°çš„äº‹åŠ¡")]),s._v("ã€‚")])])])]),s._v(" "),a("p",[s._v("ğŸŒ° ä¾‹å­ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¸º  "),a("code",[s._v("TransferRecordService")]),s._v("  è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("propagation "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Propagation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("REQUIRED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"éš”ç¦»çº§åˆ«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#éš”ç¦»çº§åˆ«"}},[s._v("#")]),s._v(" éš”ç¦»çº§åˆ«")]),s._v(" "),a("p",[s._v("å½“ä¸è€ƒè™‘äº‹åŠ¡çš„å››ä¸ªç‰¹æ€§ä¹‹ä¸€éš”ç¦»æ€§æ—¶ï¼Œåœ¨å¹¶å‘æ—¶ä¼šäº§ç”Ÿä¸€ç³»åˆ—çš„é—®é¢˜ã€‚")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("æœ‰ä¸‰ä¸ªå…¸å‹çš„ã€Œè¯»ã€é—®é¢˜ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ã€è™šï¼ˆå¹»ï¼‰è¯»ã€‚")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("è„è¯»")]),s._v("ï¼šä¸€ä¸ªæœªæäº¤äº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("ä¸å¯é‡å¤è¯»")]),s._v("ï¼šä¸€ä¸ªæœªæäº¤äº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªå·²æäº¤äº‹åŠ¡"),a("strong",[s._v("ä¿®æ”¹çš„æ•°æ®")]),s._v("ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("è™šï¼ˆå¹»ï¼‰è¯»")]),s._v("ï¼šä¸€ä¸ªæœªæäº¤äº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªå·²æäº¤äº‹åŠ¡"),a("strong",[s._v("æ·»åŠ çš„æ•°æ®")]),s._v("ã€‚")])])]),s._v(" "),a("li",[a("p",[s._v("é€šè¿‡è®¾ç½®éš”ç¦»çº§åˆ«ï¼Œè§£å†³ä¸Šè¿°çš„ã€Œè¯»ã€é—®é¢˜ï¼š")])])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("äº‹åŠ¡éš”ç¦»çº§åˆ«")]),s._v(" "),a("th",[s._v("è„è¯»")]),s._v(" "),a("th",[s._v("ä¸å¯é‡å¤è¯»")]),s._v(" "),a("th",[s._v("å¹»è¯»")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("READ UNCOMMITTED")]),s._v(" ï¼ˆ"),a("strong",[s._v("è¯»æœªæäº¤")]),s._v("ï¼‰")]),s._v(" "),a("td",[s._v("âœ…")]),s._v(" "),a("td",[s._v("âœ…")]),s._v(" "),a("td",[s._v("âœ…")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("READ COMMITTED")]),s._v(" ï¼ˆ"),a("strong",[s._v("è¯»å·²æäº¤")]),s._v("ï¼‰")]),s._v(" "),a("td",[s._v("âŒ")]),s._v(" "),a("td",[s._v("âŒ")]),s._v(" "),a("td",[s._v("âœ…")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("REPEATABLE READ")]),s._v(" ï¼ˆ"),a("strong",[s._v("å¯é‡å¤è¯»")]),s._v("ï¼‰")]),s._v(" "),a("td",[s._v("âŒ")]),s._v(" "),a("td",[s._v("âŒ")]),s._v(" "),a("td",[s._v("âœ…")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("SERIALIZABLE")]),s._v(" ï¼ˆ"),a("strong",[s._v("ä¸²è¡ŒåŒ–")]),s._v("ï¼‰")]),s._v(" "),a("td",[s._v("âŒ")]),s._v(" "),a("td",[s._v("âŒ")]),s._v(" "),a("td",[s._v("âŒ")])])])]),s._v(" "),a("blockquote",[a("p",[s._v("åœ¨ MySQL ä¸­çš„é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º  "),a("code",[s._v("REPEATABLE READ")]),s._v("  å¯é‡å¤è¯»ã€‚")])]),s._v(" "),a("p",[s._v("ğŸŒ° ä¾‹å­ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¸º  "),a("code",[s._v("TransferRecordService")]),s._v("  è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("isolation "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Isolation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("REPEATABLE_READ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"å…¶ä»–å‚æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…¶ä»–å‚æ•°"}},[s._v("#")]),s._v(" å…¶ä»–å‚æ•°")]),s._v(" "),a("p",[a("strong",[a("code",[s._v("timeout")])]),s._v("ï¼šè®¾ç½®äº‹åŠ¡çš„è¶…æ—¶æ—¶é—´ã€‚")]),s._v(" "),a("ul",[a("li",[s._v("äº‹åŠ¡éœ€è¦åœ¨ä¸€å®šçš„æ—¶é—´å†…è¿›è¡Œæäº¤ï¼Œè‹¥è®¾å®šçš„æ—¶é—´å†…äº‹åŠ¡æœªå®Œæˆæäº¤ï¼Œåˆ™å¯¹äº‹åŠ¡è¿›è¡Œå›æ»šã€‚")]),s._v(" "),a("li",[s._v("é»˜è®¤å€¼ä¸º  "),a("code",[s._v("-1")]),s._v(" ï¼Œ"),a("strong",[s._v("è®¾ç½®æ—¶é—´ä»¥ç§’ä¸ºå•ä½")]),s._v("ã€‚")])]),s._v(" "),a("p",[s._v("ğŸŒ° ä¾‹å­ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("åœ¨  "),a("code",[s._v("TransferRecordService")]),s._v("  è®¾ç½®äº‹åŠ¡è¶…æ—¶çš„æ—¶é—´ä¸º 5 sã€‚")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordDao")]),s._v(" transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ¨¡æ‹Ÿå¤„ç†è¶…æ—¶")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferIn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("ul",[a("li",[s._v("æ­¤æ—¶æäº¤çš„äº‹åŠ¡è¶…è¿‡è®¾ç½®çš„æ—¶é—´ï¼Œåˆ™ä¼šæŠ›å‡º  "),a("code",[s._v("TransactionTimedOutException")]),s._v("  äº‹åŠ¡è¶…æ—¶å¼‚å¸¸ã€‚")])]),s._v(" "),a("p",[a("strong",[a("code",[s._v("readOnly")])]),s._v("ï¼šè®¾ç½®åªè¯»å±æ€§ã€‚")]),s._v(" "),a("ul",[a("li",[s._v("é»˜è®¤å€¼  "),a("code",[s._v("false")]),s._v("  ï¼šè¡¨ç¤ºè¯»å†™æ“ä½œéƒ½å…è®¸ï¼Œå¯ä»¥è¿›è¡Œå¢ã€åˆ ã€æŸ¥ã€æ”¹çš„äº‹åŠ¡æ“ä½œã€‚")]),s._v(" "),a("li",[a("code",[s._v("true")]),s._v(" ï¼šè¡¨ç¤ºåªå…è®¸è¿›è¡Œè¯»å–æ“ä½œï¼ˆæŸ¥è¯¢ï¼‰ã€‚")])]),s._v(" "),a("p",[s._v("ğŸŒ° ä¾‹å­ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¸º  "),a("code",[s._v("TransferRecordService")]),s._v("  è®¾ç½®åªè¯»å±æ€§ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("readOnly "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("è®¾ç½®åªè¯»åï¼Œåˆ™ä¼šæŠ›å‡º    "),a("code",[s._v("TransientDataAccessResourceException")]),s._v("  å³"),a("strong",[s._v("ç¬æ€æ•°æ®è®¿é—®èµ„æºå¼‚å¸¸")]),s._v("ï¼ŒåŒæ—¶è¿˜ä¼šæŠ›å‡º  "),a("code",[s._v("SQLException")]),s._v("  ï¼Œå¹¶æŒ‡å‡ºè¿æ¥æ˜¯åªè¯»çš„ï¼ŒæŸ¥è¯¢å¯¼è‡´æ•°æ®ä¿®æ”¹æ˜¯ä¸å…è®¸çš„ã€‚")])]),s._v(" "),a("p",[a("strong",[a("code",[s._v("rollbackFor")])]),s._v("ï¼šè®¾ç½®å‡ºç°å“ªäº›å¼‚å¸¸æ‰å›æ»šã€‚")]),s._v(" "),a("p",[s._v("ğŸŒ° ä¾‹å­ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¸º  "),a("code",[s._v("TransferRecordService")]),s._v("  è®¾ç½®æˆåªæœ‰æŠ›å‡º  "),a("code",[s._v("ArithmeticException")]),s._v("  å¼‚å¸¸æ—¶ï¼Œæ‰ä¼šè¿›è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œã€‚")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rollbackFor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArithmeticException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordDao")]),s._v(" transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸è€Œå¯¼è‡´æ“ä½œä¸­æ–­")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferIn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("code",[s._v("noRollbackFor")]),s._v(" ï¼šä¸ä¸Šé¢çš„å±æ€§å€¼ç›¸åï¼Œè®¾ç½®å‡ºç°å“ªäº›å¼‚å¸¸ä¸è¿›è¡Œå›æ»šã€‚")]),s._v(" "),a("p",[s._v("ğŸŒ° ä¾‹å­ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¸º  "),a("code",[s._v("TransferRecordService")]),s._v("  è®¾ç½®æˆæŠ›å‡º  "),a("code",[s._v("ArithmeticException")]),s._v("  å¼‚å¸¸æ—¶ï¼Œä¸ä¼šè¿›è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œã€‚")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("noRollbackFor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArithmeticException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordDao")]),s._v(" transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fromUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//æ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸è€Œå¯¼è‡´æ“ä½œä¸­æ–­")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        transferRecordDao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferIn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" toUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h4",{attrs:{id:"å®Œå…¨æ³¨è§£å¼€å‘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®Œå…¨æ³¨è§£å¼€å‘"}},[s._v("#")]),s._v(" å®Œå…¨æ³¨è§£å¼€å‘")]),s._v(" "),a("ul",[a("li",[s._v("åˆ›å»ºé…ç½®ç±»  "),a("code",[s._v("TransactionalConfig")]),s._v("  ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Configuration")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¡¨ç¤ºæ­¤ç±»ä¸ºé…ç½®ç±»")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@ComponentScan")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("basePackages "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.simon"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è‡ªåŠ¨æ‰«æåŒ…")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@EnableTransactionManagement")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¼€å¯äº‹åŠ¡")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@PropertySource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"classpath:jdbc.properties"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¯»å–å¤–éƒ¨æ•°æ®åº“ä¿¡æ¯é…ç½®æ–‡ä»¶")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransactionalConfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${mysql.driverClassName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" driverClassName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${mysql.url}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${mysql.username}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${mysql.password}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å®Œæ•´çš„é…ç½®æ•°æ®åº“ä¸SqlSessionå®ä¾‹åˆ›å»ºå‚ç…§ä¸Šä¸€èŠ‚ç¬”è®°")]),s._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  \t\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é…ç½®äº‹åŠ¡ç®¡ç†å™¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataSourceTransactionManager")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getDataSourceTransactionManger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DriverManagerDataSource")]),s._v(" dataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataSourceTransactionManager")]),s._v(" transactionManager "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataSourceTransactionManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        transactionManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setDataSource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" transactionManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("ğŸŒ° æµ‹è¯•å®Œå…¨æ³¨è§£å¼€å‘ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ç¼–å†™æµ‹è¯•æ–¹æ³•ï¼š")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ApplicationContext")]),s._v(" context "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AnnotationConfigApplicationContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransactionalConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),s._v(" transferRecordService "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"transferRecordService"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransferRecordService")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ntransferRecordService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("transferAccounts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Lucy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mary"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"ä½¿ç”¨-xml-é…ç½®å®ç°å£°æ˜å¼äº‹åŠ¡ç®¡ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-xml-é…ç½®å®ç°å£°æ˜å¼äº‹åŠ¡ç®¡ç†"}},[s._v("#")]),s._v(" ä½¿ç”¨ XML é…ç½®å®ç°å£°æ˜å¼äº‹åŠ¡ç®¡ç†")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("ç‚¹å‡»æŸ¥çœ‹")]),s._v(" "),a("p",[s._v("åˆ›å»º Spring é…ç½®æ–‡ä»¶ç”¨äºå®ç°å£°æ˜å¼ç®¡ç†ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼š")])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("bean")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("transactionManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("org.springframework.jdbc.datasource.DataSourceTransactionManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("property")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("dataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("dataSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("property")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("bean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("é…ç½®äº‹åŠ¡é€šçŸ¥")])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("tx:")]),s._v("advice")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("txAdvice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("tx:")]),s._v("attributes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("tx:")]),s._v("method")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("transferAccounts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("propagation")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("REQUIRED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("isolation")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("REPEATABLE_READ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("read-only")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n                   "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("timeout")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("rollback-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("java.lang.ArithmeticException"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("tx:")]),s._v("attributes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("tx:")]),s._v("advice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[s._v("é…ç½®åˆ‡å…¥ç‚¹å’Œåˆ‡é¢ï¼š")])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("aop:")]),s._v("config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("aop:")]),s._v("pointcut")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("expression")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("execution(* com.simon.service.TransferRecordService.*(..))"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("aop:")]),s._v("advisor")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("advice-ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("txAdvice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("pointcut-ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("aop:")]),s._v("advisor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("aop:")]),s._v("config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);