(window.webpackJsonp=window.webpackJsonp||[]).push([[228],{697:function(s,t,a){"use strict";a.r(t);var n=a(29),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("在 MyBatis 中允许使用缓存，缓存一般都放置在可高速读 / 写的存储器上，比如服务器的内存，它能够有效提高系统的性能。因为数据库在大部分场景下是把存储在磁盘上的数据索引出来。")]),s._v(" "),a("p",[s._v("缓存就是存在于内存中的临时数据。使用缓存的目的是为了减少与数据库的交互次数，提高执行效率。")]),s._v(" "),a("h3",{attrs:{id:"一级缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一级缓存"}},[s._v("#")]),s._v(" 一级缓存")]),s._v(" "),a("p",[a("strong",[s._v("默认开启")]),s._v("。一级缓存是 "),a("strong",[a("code",[s._v("SqlSession")]),s._v("  级别")]),s._v("的，通过同一个  "),a("code",[s._v("SqlSession")]),s._v("  查询的数据会被缓存，"),a("strong",[s._v("下次查询相同的数据，就会从缓存中直接获取，不会从数据库重新访问")]),s._v("。")]),s._v(" "),a("p",[s._v("🌰 例子：在同一个  "),a("code",[s._v("SqlSession")]),s._v("  中查询员工信息多次：")]),s._v(" "),a("p",[s._v(':::: tabs cache-lifetime="5" :options="{ useUrlFragment: false }"')]),s._v(" "),a("p",[s._v("::: tab code")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\x3c!--Emp getEmpByEid(@Param("eid") Integer eid);--\x3e')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("getEmpByEid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("resultType")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("Emp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    select * from emp where eid = #{eid}\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("测试：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SqlSession")]),s._v(" sqlSession "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SqlSessionUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getSqlSession")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CacheMapper")]),s._v(" mapper1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sqlSession"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CacheMapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Emp")]),s._v(" empByEid1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mapper1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getEmpByEid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("empByEid1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CacheMapper")]),s._v(" mapper2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sqlSession"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CacheMapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Emp")]),s._v(" empByEid2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mapper2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getEmpByEid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("empByEid2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v(":::")]),s._v(" "),a("p",[s._v("::: tab result")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("DEBUG "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("09")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("984")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  Preparing: "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" eid "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BaseJdbcLogger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java:"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("137")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \nDEBUG "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("09")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("009")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Parameters: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BaseJdbcLogger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java:"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("137")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \nDEBUG "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("09")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("027")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("      Total: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BaseJdbcLogger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java:"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("137")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \nEmp{eid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" empName"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'张三'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" age"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sex"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'男'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" email"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123@qq.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dept"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v("}\nEmp{eid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" empName"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'张三'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" age"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sex"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'男'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" email"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123@qq.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dept"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v("}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v(":::")]),s._v(" "),a("p",[s._v("::::")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[a("strong",[s._v("使一级缓存失效的四种情况")]),s._v("：")]),s._v(" "),a("ul",[a("li",[s._v("不同的  "),a("code",[s._v("SqlSession")]),s._v("  对应不同的一级缓存。")]),s._v(" "),a("li",[s._v("同一个  "),a("code",[s._v("SqlSession")]),s._v("  但是"),a("strong",[s._v("查询条件不同")]),s._v("。")]),s._v(" "),a("li",[s._v("同一个  "),a("code",[s._v("SqlSession")]),s._v(" "),a("strong",[s._v("两次查询期间执行了任何一次增删改操作")]),s._v("。")]),s._v(" "),a("li",[s._v("同一个  "),a("code",[s._v("SqlSession")]),s._v("  两次查询期间"),a("strong",[s._v("手动清空了缓存")]),s._v("。例如： "),a("code",[s._v("sqlSession.clearCache()")]),s._v("  方法。")])])]),s._v(" "),a("h3",{attrs:{id:"二级缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二级缓存"}},[s._v("#")]),s._v(" 二级缓存")]),s._v(" "),a("p",[s._v("需要"),a("strong",[s._v("手动开启")]),s._v("。是 "),a("strong",[a("code",[s._v("SqlSessionFactory")]),s._v("  级别")]),s._v("，通过统一个  "),a("code",[s._v("SqlSessionFactory")]),s._v("  创建的  "),a("code",[s._v("SqlSession")]),s._v("  查询的结果会被缓存；若再次执行相同的查询语句，结果会从缓存中取出。")]),s._v(" "),a("p",[s._v("二级缓存开启的条件：")]),s._v(" "),a("ul",[a("li",[s._v("在核心配置文件中，全局配置属性  "),a("code",[s._v("cacheEnabled=“ture”")]),s._v(" ，默认就为  "),a("code",[s._v("ture")]),s._v("  不必设置。")]),s._v(" "),a("li",[s._v("在 mapper 映射配置文件中设置标签： "),a("code",[s._v("<cache/>")]),s._v(" 。")]),s._v(" "),a("li",[s._v("二级缓存必须在  "),a("code",[s._v("SqlSession")]),s._v("  中"),a("strong",[s._v("关闭或提交之后")]),s._v("有效。")]),s._v(" "),a("li",[s._v("查询的数据"),a("strong",[s._v("所转换的实体类类型")]),s._v("必须实现"),a("strong",[s._v("序列化的接口")]),s._v("。")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("使二级缓存失效的情况：两次查询之间执行了任意的"),a("strong",[s._v("增删改")]),s._v("，会使"),a("strong",[s._v("一级和二级缓存")]),s._v("同时失效。")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[a("strong",[s._v("二级缓存  "),a("code",[s._v("cache")]),s._v("  标签的相关配置：")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("eviction")]),s._v("  属性："),a("strong",[s._v("缓存回收策略")]),s._v("：\n"),a("ul",[a("li",[a("code",[s._v("LRU")]),s._v(" （Least Recently Used）： "),a("strong",[s._v("最近最少使用")]),s._v("的：移除最长时间不被使用的对象。【默认值】")]),s._v(" "),a("li",[a("code",[s._v("FIFO")]),s._v(" （First in First out） – "),a("strong",[s._v("先进先出")]),s._v("：按对象进入缓存的"),a("strong",[s._v("顺序")]),s._v("来移除它们。")]),s._v(" "),a("li",[a("code",[s._v("SOFT")]),s._v(" （软引用）：移除基于垃圾回收器状态和软引用规则的对象。")]),s._v(" "),a("li",[a("code",[s._v("WEAK")]),s._v(" （弱引用）：更积极地移除基于垃圾收集器状态和弱引用规则的对象。")])])]),s._v(" "),a("li",[a("code",[s._v("flushInterval")]),s._v("  ：刷新间隔，单位为"),a("strong",[s._v("毫秒")]),s._v("。默认情况不设置，即没有间隔，"),a("strong",[s._v("缓存仅仅调用语句（增删改语句）时刷新")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v("size")]),s._v(" ：引用数目，正整数。代表缓存最多存储多少个对象，太大容易导致内存溢出。")]),s._v(" "),a("li",[a("code",[s._v("readOnly")]),s._v("  只读属性， "),a("code",[s._v("true | false")]),s._v("  `。\n"),a("ul",[a("li",[s._v("true：只读缓存；会给所有调用者返回缓存对象的"),a("strong",[s._v("相同实例")]),s._v("。因此这些对象"),a("strong",[s._v("不能被修改")]),s._v("。"),a("strong",[s._v("这提供了很重要的性能优势")]),s._v("。")]),s._v(" "),a("li",[s._v("false：读写缓存；会返回缓存"),a("strong",[s._v("对象的拷贝")]),s._v("（通过"),a("strong",[s._v("序列化")]),s._v("）。这会慢一些，但是"),a("strong",[s._v("安全")]),s._v("，"),a("strong",[s._v("因此默认是 false")]),s._v("。")])])])])]),s._v(" "),a("h3",{attrs:{id:"缓存查询顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存查询顺序"}},[s._v("#")]),s._v(" 缓存查询顺序")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("ul",[a("li",[s._v("先查询二级缓存，因为二级缓存可能会有其他程序已经查询出来的数据，"),a("strong",[s._v("可以直接拿来用")]),s._v("。")]),s._v(" "),a("li",[s._v("如果二级缓存没有命中，再查询一级缓存。")]),s._v(" "),a("li",[s._v("如果一级缓存也没有命中，则查询数据库。")])])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[a("code",[s._v("SqlSession")]),s._v("  关闭之后，一级缓存的数据会写入二级缓存。")])])])}),[],!1,null,null,null);t.default=e.exports}}]);