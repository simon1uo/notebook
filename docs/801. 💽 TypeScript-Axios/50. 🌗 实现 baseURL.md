---
title:  ğŸŒ— å®ç° baseURL
date: 2022-06-17 16:09:40
permalink: /pages/206979/
categories:
  -  ğŸš¶ğŸ» å‰ç«¯å·©å›ºåŸºç¡€
  -  ğŸšŸ axios
  -  ğŸ’½ ä½¿ç”¨ TypeScript é‡æ„ axios åº“
tags:
  - 
---
## éœ€æ±‚åˆ†æ

æœ‰äº›æ—¶å€™ï¼Œéœ€è¦è¯·æ±‚æŸä¸ªåŸŸåä¸‹çš„å¤šä¸ªæ¥å£ï¼Œä¸æƒ³æ¯æ¬¡éƒ½åœ¨å‘é€è¯·æ±‚çš„æ—¶å€™éƒ½å¡«å†™å®Œæ•´çš„ URLï¼Œæ‰€ä»¥å¯ä»¥é…ç½®ä¸€ä¸ª `baseURL` ä¹‹åå¯ä»¥ç©¿ç›¸å¯¹çš„è·¯å¾„ã€‚

> ğŸŒ° ä½¿ç”¨ä¾‹å­ï¼š
>
> ```typescript
> const instance = axios.create({
>   baseURL: 'https://some-domain.com/api'
> })
> 
> instance.get('/get')
> 
> instance.post('/post')
> ```
>
> ä¸€æ—¦é…ç½®äº† `baseURL`ï¼Œä¹‹åä¼ å…¥çš„è¯·æ±‚ URL éƒ½ä¼šä¸ `baseURL` æ‹¼æ¥æˆå®Œæˆçš„ç»å¯¹åœ°å€ï¼Œé™¤éä¼ å…¥çš„ `URL` æ˜¯ç»å¯¹åœ°å€ã€‚

æ‰€ä»¥è¦æ£€éªŒè¯·æ±‚ URL æ˜¯å¦ä¸ºç»å¯¹åœ°å€ã€‚



## ä»£ç å®ç°

ä¿®æ”¹ `AxiosRequestConfig` çš„ç±»å‹å®šä¹‰ï¼š

```typescript
export interface AxiosRequestConfig {
  // ...
  baseURL?: string
}
```



åœ¨ `src/helpers/url.ts` ä¸­å®ç°ä¸¤ä¸ªè¾…åŠ©å‡½æ•°ï¼š

```typescript
export function isAbsoluteURL(url: string): boolean {
  return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(url)
}

export function combineURL(baseURL: string, relativeURL?: string): string {
  return relativeURL ? baseURL.replace(/\/+$/, '') + '/' + relativeURL.replace(/^\/+/, '') : baseURL
}
```



åœ¨ `core/dispatchRequest.ts` ä¸­è°ƒç”¨ï¼š

```typescript
function transformURL(config: AxiosRequestConfig): any {
  let { url, params, paramsSerializer, baseURL } = config
  if(baseURL && !isAbsoluteURL(url!)) {
    url = combineURL(baseURL, url)
  }
  return buildURL(url!, params, paramsSerializer)
}
```



## ç¼–å†™æµ‹è¯• DEMO

`examples/more/app.ts` ï¼š

```typescript
const instance = axios.create({
  baseURL: 'https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/'
})

instance.get('D4kLn9.png')

instance.get('https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/EGVR9A.png')
```