---
title:  ğŸŒ– å•å…ƒæµ‹è¯• Jest çš„ä½¿ç”¨
date: 2022-06-17 23:57:07
permalink: /pages/4b46b1/
categories:
  -  ğŸš¶ğŸ» å‰ç«¯å·©å›ºåŸºç¡€
  -  ğŸšŸ axios
  -  ğŸ’½ ä½¿ç”¨ TypeScript é‡æ„ axios åº“
tags:
  - 
---
> + [Jest å®˜ç½‘](https://jestjs.io/en/)ã€‚å®ƒæ˜¯ Facebook å‡ºå“çš„ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼Œç›¸å¯¹å…¶ä»–æµ‹è¯•æ¡†æ¶ï¼Œå®ƒçš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯å†…ç½®äº†å¸¸ç”¨çš„æµ‹è¯•å·¥å…·ï¼Œæ¯”å¦‚è‡ªå¸¦æ–­è¨€ã€æµ‹è¯•è¦†ç›–ç‡å·¥å…·ï¼Œå®ç°äº†å¼€ç®±å³ç”¨ã€‚



## å®‰è£…ä½¿ç”¨ Jest

> ç”±äº `typescript-library-starter` å·²ç»å†…ç½® `jest` ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡æ–°å®‰è£…æ›´æ–°åˆ°æ–°çš„ç‰ˆæœ¬ï¼š
>
> ```shell
> $ npm i jest
> ```



### Jest é…ç½®

::: details

åœ¨ `package.json` ä¸­çš„ `jest` ç›¸å…³é…ç½®ï¼š

```json
"jest": {
  "transform": {
    ".(ts|tsx)": "ts-jest"
  },
  "testEnvironment": "node",
  "testRegex": "(/__tests__/.*|\\.(test|spec))\\.(ts|tsx|js)$",
  "moduleFileExtensions": [
    "ts",
    "tsx",
    "js"
  ],
  "coveragePathIgnorePatterns": [
    "/node_modules/",
    "/test/"
  ],
  "coverageThreshold": {
    "global": {
      "branches": 90,
      "functions": 95,
      "lines": 95,
      "statements": 95
    }
  },
  "collectCoverageFrom": [
    "src/*.{js,ts}"
  ]
},
```

ç›¸å…³é…ç½®çš„å«ä¹‰ï¼š

+ `transform`ï¼šè½¬æ¢å™¨é…ç½®ã€‚è¿™é‡Œè¡¨ç¤ºçš„å°±æ˜¯ä½¿ç”¨ `ts-jest` å·¥å…·æŠŠ `.ts` å’Œ `.tsx` æ–‡ä»¶å†…å®¹è½¬æ¢æˆ JavaScriptï¼Œå› ä¸ºä½¿ç”¨ TypeScript ç¼–å†™æµ‹è¯•ä»£ç ï¼Œè€Œ Node.js æ˜¯ä¸èƒ½ç›´æ¥æ”¯æŒ TypeScript çš„ï¼Œæ‰€ä»¥éœ€è¦é…ç½®è½¬æ¢å™¨ã€‚
+ `testEnvironment`ï¼šæµ‹è¯•ç¯å¢ƒã€‚è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªç±»æµè§ˆå™¨çš„æµ‹è¯•ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨ç¯å¢ƒä¸­çš„ä¸€äº› APIã€‚
+ `testRegex`ï¼šæµ‹è¯•æ–‡ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚åŒ…å«çš„æ–‡ä»¶æ ¼å¼ã€‚
+ `moduleFileExtensions`ï¼šæ¨¡å—æ–‡ä»¶æ‰©å±•åï¼Œå½“å»å¼•å…¥ä¸€ä¸ªæ¨¡å—å¹¶æ²¡æœ‰æŒ‡å®šæ‰©å±•åçš„æ—¶å€™ï¼Œå®ƒä¼šä¾æ¬¡å°è¯•å»æ·»åŠ è¿™äº›æ‰©å±•åå»æ‰¾ä½ å¼•å…¥çš„æ¨¡å—æ–‡ä»¶ã€‚

+ `coverageThreshold` ï¼šæµ‹è¯•è¦†ç›–ç‡çš„é˜ˆå€¼è®¾å®šã€‚å½“æµ‹è¯•è¦†ç›–ç‡è¾¾ä¸åˆ°é˜ˆå€¼çš„æ—¶å€™ï¼Œæµ‹è¯•ä¼šå¤±è´¥ã€‚
+ `collectCoverageFrom`ï¼šæ”¶é›†æŒ‡å®šæ–‡ä»¶çš„æµ‹è¯•è¦†ç›–ç‡(å³ä½¿ä½ æ²¡ä¸ºè¿™äº›æ–‡ä»¶ç¼–å†™æµ‹è¯•)ï¼Œå®ƒçš„å€¼ä¸º glob patterns ç±»å‹ã€‚

é¢å¤–é…ç½®ï¼š

```json
"setupFilesAfterEnv": [
  "<rootDir>/test/boot.ts"
]
```

+ `setupFilesAfterEnv`ï¼šæµ‹è¯•æ¡†æ¶å®‰è£…åç«‹å³æ‰§è¡Œçš„ä»£ç æ–‡ä»¶åˆ—è¡¨ã€‚è¡¨ç¤ºæ¯æ¬¡è·‘å…·ä½“æµ‹è¯•ä»£ç ä¹‹å‰ä¼šå…ˆè¿è¡Œ `<rootDir>/test/boot.ts` ä¸­çš„ä»£ç ï¼Œ`<rootDir>` è¡¨ç¤ºå½“å‰é¡¹ç›®çš„æ ¹ç›®å½•ã€‚

:::

