---
title: ğŸ”¦ MyBatis è·å–å‚æ•°
date: 2022-03-21 10:40:14
permalink: /pages/33f653/
categories: 
  - _pages
  - ğŸ§‹ JavaEE
  - ğŸ—º MyBatis
tags: 
  - null
author: 
  name: Simon
  link: https://github.com/simon1uo
---





ä¸¤ç§æ–¹å¼ï¼š

+ `${}` æœ¬è´¨æ˜¯ä½¿ç”¨**å­—ç¬¦ä¸²æ‹¼æ¥**çš„æ–¹å¼æ‹¼æ¥ SQL è¯­å¥ï¼Œè‹¥ä¸ºå­—ç¬¦ä¸²ç±»å‹æˆ–è€…æ—¥æœŸç±»å‹çš„å­—æ®µè¿›è¡Œèµ‹å€¼æ—¶ï¼Œ**éœ€è¦æ‰‹åŠ¨æ·»åŠ å•å¼•å·**ã€‚ï¼ˆå¸¦æ¥ SQL æ³¨å…¥é—®é¢˜ï¼‰
+ `#{}` æœ¬è´¨æ˜¯ä½¿ç”¨å ä½ç¬¦èµ‹å€¼çš„æ–¹å¼æ‹¼æ¥ SQL è¯­å¥ï¼Œè‹¥ä¸ºå­—ç¬¦ä¸²ç±»å‹æˆ–è€…æ—¥æœŸç±»å‹çš„å­—æ®µè¿›è¡Œèµ‹å€¼æ—¶ï¼Œ**å¯ä»¥è‡ªåŠ¨æ·»åŠ å•å¼•å·**ã€‚



### å•ä¸ªå­—é¢é‡çš„å‚æ•°

mapper æ¥å£æ–¹æ³•çš„å‚æ•°ä¸º**å•ä¸ª**çš„å­—é¢é‡ç±»å‹ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ `${parameter}` æˆ–è€… `#{parameter}` ä»¥ä»»æ„çš„åç§°ï¼ˆæœ€å¥½ä¸åŸæ¥çš„å‚æ•°åï¼‰è·å–å‚æ•°çš„å€¼ã€‚**æ³¨æ„ä½¿ç”¨ `${}` æ—¶éœ€è¦æ‰‹åŠ¨æ·»åŠ å•å¼•å·ã€‚** 

ğŸŒ° ä¾‹å¦‚ï¼š

`ParameterMapper.java` mapper æ¥å£ä¸­é€šè¿‡ç”¨æˆ·åè·å–ç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ï¼š

```java
public interface ParameterMapper {
  User getUserByUsername(String username);
}
```

`ParameterMapper.xml` ä¸­ï¼š

```xml
<!--User getUserByUsername(String username);-->
<select id="getUserByUsername" parameterType="String" resultType="User">
  select * from user where username = #{username}
  -- select * from user where username = '${username}' 
</select>
```

`ParameterMapperTest` ç±»ä¸­æµ‹è¯•ï¼š

```java
@Test
public void testGetUserByUsername() {
  SqlSession sqlSession = SqlSessionUtils.getSqlSession();
  ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
  User admin = mapper.getUserByUsername("admin");
  System.out.println(admin.toString());
}
```



### å¤šä¸ªå­—é¢é‡çš„å‚æ•°

è‹¥ mapper æ¥å£ä¸­çš„æ–¹æ³•å‚æ•°ä¸ºå¤šä¸ªæ—¶ï¼Œ**æ­¤æ—¶ MyBatis ä¼šè‡ªåŠ¨å°†è¿™äº›å‚æ•°æ”¾åœ¨ä¸€ä¸ª `map` é›†åˆä¸­**ï¼Œä»¥ `arg0, arg1...`ä¸ºé”®ï¼Œä»¥å‚æ•°ä¸ºå€¼ï¼Œæˆ–è€…ä»¥ `param1, param2...` ä¸ºé”®ï¼Œä»¥å‚æ•°ä¸ºå€¼ï¼›å› æ­¤åªéœ€è¦é€šè¿‡ `${}` å’Œ `#{}` è®¿é—® `map` é›†åˆçš„é”®å°±å¯ä»¥è·å–ç›¸å¯¹åº”çš„å€¼ã€‚ã€æ³¨æ„é¡ºåº `0...1...` å’Œ `1...2...`ï¼Œä½† `arg` å’Œ `param` å¯æ··ç”¨ã€‘ã€‚

ğŸŒ° ä¾‹å­ï¼ˆä¸¤ä¸ªå­—é¢é‡å‚æ•°ï¼‰ï¼š

`ParameterMapper.java` mapper æ¥å£ä¸­ç™»å½•éªŒè¯çš„æ–¹æ³•ï¼Œå‚æ•°ä¸ºç”¨æˆ·åå’Œç”¨æˆ·å¯†ç ï¼š

```java
public interface ParameterMapper {
    User checkLogin(String username, String password);
}
```

`ParameterMapper` ä¸­ï¼š

```xml
<!--User checkLogin(String username, String password);-->
<select id="checkLogin" resultType="User">
    <!--select * from user where username = #{arg0} and password = #{arg1}-->
    <!-- select * from user where username = #{param1} and password = #{param2} -->
    select * from user where username = #{arg0} and password = #{param2}
</select>
```

`ParameterMapperTest` ç±»ä¸­æµ‹è¯•ï¼š

```java
@Test
public void testCheckLogin() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
    User admin = mapper.checkLogin("admin", "123456");
    System.out.println(admin.toString());
}
```



### `map` é›†åˆç±»å‹çš„å‚æ•°

è‹¥ mapper æ¥å£ä¸­çš„æ–¹æ³•éœ€è¦çš„å‚æ•°ä¸ºå¤šä¸ªæ—¶ï¼Œæ­¤æ—¶å¯ä»¥æ‰‹åŠ¨åˆ›å»º `map` é›†åˆï¼Œå°†è¿™äº›æ•°æ®æ”¾åœ¨ `map` ä¸­ï¼Œåªéœ€è¦é€šè¿‡ `${}` å’Œ `#{}` è®¿é—® `map` **é›†åˆçš„é”®**å°±å¯ä»¥è·å–ç›¸å¯¹åº”çš„å€¼ã€‚



ğŸŒ° ä¾‹å­ï¼š

`ParameterMapper.java` mapper æ¥å£ä¸­ç™»å½•éªŒè¯æ–¹æ³•ï¼Œå‚æ•°ä¸º `Map` é›†åˆï¼š

```java
public interface ParameterMapper {
    User checkLoginByMap(Map<String, Object> map);
}
```

`ParameterMapper` ä¸­ï¼š

```xml
<!--User checkLogin(String username, String password);-->
<select id="checkLogin" resultType="User">
  select * from user where username = #{username} and password = #{password}
</select>
```

`ParameterMapperTest` ç±»ä¸­æµ‹è¯•ï¼š

```java
@Test
public void testCheckLoginByMap() {
  SqlSession sqlSession = SqlSessionUtils.getSqlSession();
  ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
  Map<String, Object> map = new HashMap<>();
  map.put("username", "admin");
  map.put("password", "123456");
  User admin = mapper.checkLoginByMap(map);
  System.out.println(admin.toString());
}
```



### :star: å®ä½“ç±»ç±»å‹çš„å‚æ•°

è‹¥ mapper æ¥å£ä¸­çš„æ–¹æ³•å‚æ•°ä¸ºå®ä½“ç±»å¯¹è±¡æ—¶ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ `${}` å’Œ `#{}`ï¼Œé€šè¿‡è®¿é—®**å®ä½“ç±»å¯¹è±¡ä¸­çš„å±æ€§å**è·å–å±æ€§å€¼ã€‚



ğŸŒ° æ·»åŠ ç”¨æˆ·ä¿¡æ¯ï¼š

`ParameterMapper.java` mapper æ¥å£ä¸­ç™»å½•éªŒè¯æ–¹æ³•ï¼Œå‚æ•°ä¸º `Map` é›†åˆï¼š

```java
public interface ParameterMapper {
    void insertUser(User user);
}
```

`ParameterMapper` ä¸­ï¼š

```xml
<!-- void insertUser(User user); -->
<insert id="insertUser">
  insert into user values(null, #{username}, #{password}, #{age}, #{sex}, #{email})
</insert>
```

`ParameterMapperTest` ç±»ä¸­æµ‹è¯•ï¼š

```java
@Test
public void testInsert() {
  SqlSession sqlSession = SqlSessionUtils.getSqlSession();
  ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
  User user = new User(null, "æå››", "123456", null, null, null);
  mapper.insertUser(user);
}
```



### ä½¿ç”¨ `@Param` æ ‡è¯†å‚æ•°

å¯ä»¥é€šè¿‡ `@Param` æ³¨è§£æ ‡è¯† mapper æ¥å£ä¸­çš„æ–¹æ³•å‚æ•°ã€‚æ­¤æ—¶ï¼Œä¼šå°†è¿™äº›å‚æ•°æ”¾åœ¨ `map` é›†åˆä¸­ï¼Œ**ä»¥ `@Param` æ³¨è§£çš„ `value` å±æ€§å€¼ä¸ºé”®**ï¼Œä»¥å‚æ•°ä¸ºå€¼ï¼›ä»¥ `param1, param2...` ä¸ºé”®ï¼Œä»¥å‚æ•°ä¸ºå€¼ï¼›åªéœ€è¦é€šè¿‡ `${}` å’Œ `#{}` è®¿é—® `map` é›†åˆçš„é”®å°±å¯ä»¥è·å–ç›¸å¯¹åº”çš„å€¼ã€‚

> ğŸ”— ç›¸å…³é“¾æ¥ï¼š[ä»æºç åˆ†æ `@Param` å®ç°åŸç† (å°šç¡…è°· MyBatis æ•™ç¨‹)](https://www.bilibili.com/video/BV1VP4y1c7j7?p=29&spm_id_from=pageDriver)

ğŸŒ° ä¾‹å­ï¼š

`ParameterMapper.java` mapper æ¥å£ä¸­ç™»å½•éªŒè¯æ–¹æ³•ï¼Œå‚æ•°ä½¿ç”¨ `@Param` æ–¹æ³•æ³¨è§£ï¼š

```java
public interface ParameterMapper {
    User checkLoginByParam(@Param("username") String username, @Param("password") String password);
}
```

`ParameterMapper` ä¸­ï¼š

```xml
<!--User checkLoginByParam(@Param("username") String username, @Param("password") String password);-->
<select id="checkLoginByParam" resultType="User">
    select *
    from user
    where username = #{username}
      and password = #{password}
</select>
```

`ParameterMapperTest` ç±»ä¸­æµ‹è¯•ï¼š

```java
@Test
public void testCheckLoginByParam() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
    User admin = mapper.checkLoginByParam("admin", "123456");
    System.out.println(admin.toString());
}
```