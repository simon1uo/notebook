---
title: â›³ï¸ SpringMVC RESTful
date: 2022-04-01 15:00:45
permalink: /pages/226cf2/
categories: 
  - _pages
  - ğŸ§‹ JavaEE
  - ğŸšSpringMVC
tags: 
  - null
author: 
  name: Simon
  link: https://github.com/simon1uo
---
## RESTful ç®€ä»‹

+ RESTï¼šRepresentational State Transferï¼Œè¡¨ç°å±‚çš„**èµ„æºçŠ¶æ€è½¬ç§»**ã€‚
+ è¡¨ç°å±‚ï¼šå‰ç«¯çš„è§†å›¾é¡µé¢åˆ°åç«¯çš„æ§åˆ¶å±‚ä¸ºã€Œè¡¨ç°å±‚ã€ã€‚
+ **èµ„æº**ï¼š ï¼ˆä¸€ç§çœ‹å¾…æœåŠ¡å™¨çš„æ–¹å¼ï¼Œå°†æœåŠ¡çœ‹ä½œæ˜¯ç”±å¾ˆå¤šç¦»æ•£çš„èµ„æºç»„æˆï¼‰Web å·¥ç¨‹éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼ŒWebå·¥ç¨‹ä¸Šä¸­çš„å†…å®¹åœ¨æœåŠ¡å™¨ä¸Šç§°èµ„æºã€‚ä¸€ä¸ªèµ„æºå¯ä»¥æœ‰å¤šä¸ª URI æ ‡è¯†ï¼ŒURI æ—¢æ˜¯èµ„æºçš„åç§°ï¼Œä¹Ÿæ˜¯èµ„æºåœ¨ Web ä¸Šçš„åœ°å€ã€‚å¯¹æŸä¸ªèµ„æºæ„Ÿå…´è¶£çš„å®¢æˆ·ç«¯åº”ç”¨ï¼Œå¯ä»¥é€šè¿‡èµ„æºçš„ URI è¿›è¡Œäº¤äº’ã€‚
+ çŠ¶æ€ï¼šèµ„æºçš„è¡¨ç°å½¢å¼ï¼Œå¯ä»¥æœ‰å¤šç§æ ¼å¼ï¼Œä¾‹å¦‚ HTML/JSP é¡µé¢ã€CSS/JavaScript æ–‡ä»¶ã€å›¾ç‰‡/éŸ³é¢‘/è§†é¢‘ï¼Œçš†æ˜¯èµ„æºçš„çŠ¶æ€ã€‚
+ èµ„æºè¡¨è¿°ï¼šæ˜¯ä¸€æ®µå¯¹äºèµ„æºåœ¨æŸä¸ªç‰¹å®šæ—¶åˆ»çš„çŠ¶æ€çš„æè¿°ï¼Œå¯ä»¥åœ¨ å®¢æˆ·ç«¯â€”â€”æœåŠ¡ç«¯ä¹‹é—´è½¬ç§»ï¼ˆäº¤æ¢ï¼‰ã€‚èµ„æºçš„è¡¨è¿°å¯ä»¥æœ‰å¤šç§æ ¼å¼ï¼Œä¾‹å¦‚ HTML / XML / JSON / çº¯æ–‡æœ¬ / å›¾ç‰‡ / è§†é¢‘ / éŸ³é¢‘ã€‚èµ„æºçš„è¡¨è¿°æ ¼å¼å¯ä»¥é€šè¿‡åå•†æœºåˆ¶æ¥ç¡®å®šï¼Œè¯·æ±‚â€”å“åº”æ–¹å‘çš„è¡¨è¿°é€šå¸¸ä½¿ç”¨ä¸åŒçš„æ ¼å¼ã€‚
+ **çŠ¶æ€è½¬ç§»**ï¼šå’Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´çš„**è½¬ç§»**ä»£è¡¨ç€èµ„æºçŠ¶æ€çš„è¡¨è¿°ã€‚æµè§ˆå™¨å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡ç«¯å°†è¯·æ±‚çš„èµ„æºã€Œè½¬ç§»ã€åˆ°å®¢æˆ·ç«¯ã€‚é€šè¿‡è½¬ç§»å’Œæ“ä½œèµ„æºçš„è¡¨è¿°ï¼Œæ¥**é—´æ¥å®ç°æ“ä½œèµ„æºçš„ç›®çš„**ã€‚

***

+ RESTfulï¼šåŸºäº REST æ„å»ºçš„ API å°±æ˜¯ RESTful é£æ ¼ã€‚



## RESTful å®ç°

+ å®ç°å…·ä½“è¯´çš„å°±æ˜¯ HTTP åè®®é‡Œé¢ï¼Œå››ä¸ªæ ‡è¯†**æ“ä½œæ–¹å¼çš„åŠ¨è¯**ï¼Œä»¥åŠåˆ†åˆ«å¯¹åº”çš„å››ç§åŸºæœ¬æ“ä½œï¼š

  + `GET` ç”¨æ¥è·å–èµ„æºã€‚

  + `POST` ç”¨æ¥æ–°å»ºèµ„æºã€‚

  + `PUT` ç”¨æ¥æ›´æ–°èµ„æºã€‚

  + `DELETE` ç”¨æ¥åˆ é™¤èµ„æº

+ :star: REST é£æ ¼æå€¡ URI åœ°å€ä¸ä½¿ç”¨é—®å· `?` å¯¹æ–¹å¼æºå¸¦è¯·æ±‚å‚æ•°ï¼Œæå€¡ä½¿ç”¨ç»Ÿä¸€çš„é£æ ¼è®¾è®¡ï¼Œ**ä»å‰åˆ°åå„ä¸ªå•è¯ä½¿ç”¨æ–œæ åˆ†å¼€**ï¼Œå°†è¦å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ä½œä¸ºåœ°å€çš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä¿è¯æ•´ä½“é£æ ¼çš„ä¸€è‡´æ€§ URLã€‚

::: tip 

ä»¥å¾€è®¿é—®èµ„æºçš„æ–¹å¼äº”èŠ±å…«é—®ã€‚ä¾‹å¦‚ï¼Œ

- è·å–ç”¨æˆ·ä¿¡æ¯é€šè¿‡`getUserById`/`selectUserById`/`findUserById`/ç­‰

- åˆ é™¤ç”¨æˆ·ä¿¡æ¯é€šè¿‡`deleteUserById`/`removeUserById`ç­‰

- æ›´æ–°ç”¨æˆ·ä¿¡æ¯é€šè¿‡`updateUser`/`modifyUser`/`saveUser`ç­‰

- æ–°å¢ç”¨æˆ·ä¿¡æ¯é€šè¿‡`addUser`/`createUser`/`insertUser`ç­‰

ä¸Šè¿°æ“ä½œçš„èµ„æºéƒ½æ˜¯ç”¨æˆ·ä¿¡æ¯ã€‚æŒ‰ç…§`RESTful`æ€æƒ³ï¼Œ**æ—¢ç„¶æ“ä½œçš„èµ„æºä¸€æ ·ï¼Œé‚£ä¹ˆè¯·æ±‚è·¯å¾„å°±åº”è¯¥ä¸€æ ·**ã€‚

ğŸŒ° ä¼ ç»Ÿæ–¹å¼ä¸ REST é£æ ¼å¯¹ç”¨æˆ·çš„æ“ä½œçš„ URL åœ°å€åŒºåˆ«

| æ“ä½œ | ä¼ ç»Ÿæ–¹å¼              | REST é£æ ¼               |
| ---- | --------------------- | ----------------------- |
| æŸ¥è¯¢ | `getUserById?id=1`    | `user/1` ï¼Œ`GET` è¯·æ±‚   |
| ä¿å­˜ | `saveUser`            | `user`ï¼Œ`POST` è¯·æ±‚     |
| åˆ é™¤ | `deleteUserById?id=1` | `user/1`ï¼Œ`DELETE` è¯·æ±‚ |
| æ›´æ–° | `updateUser`          | `user`ï¼Œ`PUT` è¯·æ±‚      |

:::



ğŸŒ° ä¾‹å­ï¼šä½¿ç”¨ RESTful æ¨¡æ‹Ÿæ“ä½œç”¨æˆ·èµ„æºï¼š

**æŸ¥è¯¢ã€æ·»åŠ éƒ¨åˆ†ï¼ˆå‘é€ `GET` ã€`POST` è¯·æ±‚ï¼‰**ï¼š

+ åˆ›å»ºæ§åˆ¶å™¨ `UserController` ï¼Œç¼–å†™æ§åˆ¶å™¨æ–¹æ³•ï¼š

```java
@Controller
public class UserController {

    @RequestMapping(value = "/user", method = RequestMethod.GET)
    public String getAllUser() {
        System.out.println("æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯");
        return "success";
    }

    @RequestMapping(value = "/user/{id}", method = RequestMethod.GET)
    public String getUserById() {
        System.out.println("æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯");
        return "success";
    }

    @RequestMapping(value = "/user", method = RequestMethod.POST)
    public String insertUser(String username, String password) {
        System.out.println("æ·»åŠ ç”¨æˆ·ä¿¡æ¯" + username + password);
        return "success";
    }
}
```

+ æµ‹è¯•é¡µé¢ `test_restful.html` ï¼š

```html
<a th:href="@{/user}">æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯</a><br>
<a th:href="@{/user/1}">æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</a><br>
<form th:action="@{/user}" method="post">
    ç”¨æˆ·åï¼š<input type="text" name="username"><br>
    å¯†ç ï¼š<input type="password" name="password"><br>
    <input type="submit" value="æäº¤">
</form>
```

+ åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½® `test_rest` çš„è§†å›¾ï¼š

```xml
<mvc:view-controller path="/test_restful" view-name="test_restful"/>
```



ä¿®æ”¹ã€åˆ é™¤éƒ¨åˆ†ï¼ˆå‘é€ `PUT`ã€`DELETE` è¯·æ±‚ï¼‰ï¼š

::: tip 

ç”±äºåœ¨ [SpringMVC è¯·æ±‚æ˜ å°„](/pages/4cd331/) ä»¥æåˆ°ï¼Œ**ç›®å‰æµè§ˆå™¨åªæ”¯æŒ `GET` å’Œ `POST` ä¸¤ç§è¯·æ±‚æ–¹å¼**ï¼Œè‹¥ä½¿ç”¨å…¶ä»–çš„è¯·æ±‚æ–¹å¼ï¼Œ**åˆ™æŒ‰ç…§é»˜è®¤çš„è¯·æ±‚æ–¹å¼ `GET` å¤„ç†**ã€‚ï¼ˆè‹¥è¦å‘é€ `PUT` æˆ–è€… `DELETE` è¯·æ±‚ï¼Œåˆ™éœ€è¦é€šè¿‡ Spring æä¾›çš„**è¿‡æ»¤å™¨** `HiddenHttpMethodFilter`ï¼‰

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `AJAX` å‘é€ `PUT` å’Œ `DELETE` è¯·æ±‚ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ `PUT` å’Œ `DELETE` **ä»…éƒ¨åˆ†æµè§ˆå™¨æ”¯æŒ**ã€‚

:::

+ åœ¨ `web.xml` é…ç½®æ–‡ä»¶ä¸­é…ç½® `HiddenHttpMethodFilter` è¿‡æ»¤å™¨ï¼š

```xml
<filter>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
```

+ ç¼–å†™æ§åˆ¶å™¨æ–¹æ³•ï¼š

```java
@RequestMapping(value = "/user", method = RequestMethod.PUT)
public String updateUser(String username, String password) {
    System.out.println("ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯" + username + password);
    return "success";
}

@RequestMapping(value = "/user", method = RequestMethod.DELETE)
public String deleteUser(String username, String password) {
    System.out.println("åˆ é™¤ç”¨æˆ·ä¿¡æ¯" + username + password);
    return "success";
}
```

+ æµ‹è¯•é¡µé¢ `test_restful.html`ï¼š

```html
ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯
<form th:action="@{/user}" method="post">
    <input type="hidden" name="_method" value="put">
    ç”¨æˆ·åï¼š<input type="text" name="username"><br>
    å¯†ç ï¼š<input type="password" name="password"><br>
    <input type="submit" value="ä¿®æ”¹">
</form>
åˆ é™¤ç”¨æˆ·ä¿¡æ¯
<form th:action="@{/user}" method="post">
    <input type="hidden" name="_method" value="delete">
    ç”¨æˆ·åï¼š<input type="text" name="username"><br>
    å¯†ç ï¼š<input type="password" name="password"><br>
    <input type="submit" value="ä¿®æ”¹">
</form>
```

> +  ä½¿ç”¨éšè—çš„ `input` ç±»å‹ `<input type="hidden" name="_method" value="put">` å‘åå°ä¼ è¾“è¯·æ±‚æ–¹å¼ã€‚
> + å®é™…ä¸Šï¼Œåœ¨åˆ é™¤æŸæ¡ç”¨æˆ·ä¿¡æ¯æ—¶åº”ä½¿ç”¨ä¸€ä¸ªè¶…é“¾æ¥åˆ é™¤æŸä¸€è¡Œæ•°æ®ï¼Œæˆ–æ˜¯é€šè¿‡é€‰ä¸­è¡¨å•çš„æ•°æ®æ‰¹é‡åˆ é™¤æ•°æ®ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯é€šè¿‡ `id` ä¿¡æ¯è¿›è¡Œåˆ é™¤ï¼Œè¿™é‡Œä»…ä½œæµ‹è¯•è¯·æ±‚æ–¹æ³•ä½¿ç”¨ã€‚



::: tip 

å…³äº `web.xml` ä¸­è¿‡æ»¤å™¨çš„é…ç½®é¡ºåºé—®é¢˜ï¼š

é€šè¿‡å¯¹ `HiddenHttpMethodFilter` æºç çš„å‰–æï¼Œå®ƒä¼šè·å¾— `_method` è¿™ä¸ªè¯·æ±‚å‚æ•°ï¼Œè¿™å°±å¯¼è‡´æ‰§è¡Œåˆ° `CharacterEncodingFilter` è¿‡æ»¤å™¨æ—¶ï¼Œå·²ç»æ˜¯è·å–è¯·æ±‚å‚æ•°ä¹‹åäº†ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ä¸­æ–‡ä¹±ç é—®é¢˜ã€‚

å› æ­¤ï¼Œå¿…é¡»è¦å°† `CharacterEncodingFilter`  ç¼–ç å¤„ç†è¿‡æ»¤å™¨å°½é‡é…ç½®åœ¨å…¶ä»–è¿‡æ»¤å™¨ä¹‹å‰ã€‚è¿™æ ·å°±èƒ½ä¿è¯åœ¨ä»»ä½•è¿‡æ»¤å™¨è·å–è¯·æ±‚ä¹‹å‰ï¼Œè·å¾—çš„å¤±å·²ç»å¤„ç†è¿‡ç¼–ç æ ¼å¼çš„è¯·æ±‚å‚æ•°äº†ã€‚

:::



## RESTful æ¡ˆä¾‹

è¦å®ç°ä¸€ä¸ªå‘˜å·¥åˆ—è¡¨çš„å¢åˆ æ”¹æŸ¥ï¼š

### åŠŸèƒ½æ¸…å•

| åŠŸèƒ½               | URLè·¯å¾„       | :star:è¯·æ±‚æ–¹å¼ |
| ------------------ | ------------- | -------------- |
| è®¿é—®é¦–é¡µ           | `/`           | `GET`          |
| æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥       | `/employee`   | `GET`          |
| åˆ é™¤å‘˜å·¥           | `/employee/1` | `DELETE`       |
| è·³è½¬åˆ°æ·»åŠ å‘˜å·¥é¡µé¢ | `/toAdd`      | `GET`          |
| æ·»åŠ å‘˜å·¥           | `/employee`   | `POST`         |
| è·³è½¬åˆ°ä¿®æ”¹å‘˜å·¥é¡µé¢ | `/employee/2` | `GET`          |
| ä¿®æ”¹å‘˜å·¥           | `/employee`   | `PUT`          |



### é¡¹ç›®é…ç½®

+ åˆ›å»º Maven é¡¹ç›®ï¼Œå¼•å…¥ç›¸å…³ä¾èµ–ï¼š

```xml
<packaging>war</packaging>

<dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>5.3.18</version>
    </dependency>
    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>1.2.11</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>4.0.1</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>org.thymeleaf</groupId>
        <artifactId>thymeleaf-spring5</artifactId>
        <version>3.0.15.RELEASE</version>
    </dependency>
</dependencies>
```

+ é…ç½® Web Modules ï¼ˆæ³¨æ„è·¯å¾„è®¾ç½®ä¸º `src/main/webapp` ï¼‰ï¼Œé…ç½® `web.xml` æ–‡ä»¶ï¼Œæ·»åŠ ä¸¤ä¸ªè¿‡æ»¤å™¨å’Œ Spring MVC å‰ç«¯æ§åˆ¶å™¨ï¼š

::: details 

```xml
<!--é…ç½®ç¼–ç è¿‡æ»¤å™¨-->
<filter>
    <filter-name>CharacterEncodingFilter</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
    <init-param>
        <param-name>forceResponseEncoding</param-name>
        <param-value>true</param-value>
    </init-param>
</filter>
<filter-mapping>
    <filter-name>CharacterEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!--é…ç½®å¤„ç† PUT å’Œ DELETE çš„è¯·æ±‚è¿‡æ»¤å™¨-->
<filter>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!--é…ç½® SpringMVC å‰ç«¯æ§åˆ¶å™¨-->
<servlet>
    <servlet-name>DispatcherServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:springMVC.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>DispatcherServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
```

:::

+ Spring MVC é…ç½®ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd">

    <!--æ‰«æç»„ä»¶-->
    <context:component-scan base-package="com.simon.rest"/>

    <!--é…ç½®Thymeleafè§†å›¾è§£æå™¨-->
    <bean id="viewResolver" class="org.thymeleaf.spring5.view.ThymeleafViewResolver">
        <property name="order" value="1"/>
        <property name="characterEncoding" value="UTF-8"/>
        <property name="templateEngine">
            <bean class="org.thymeleaf.spring5.SpringTemplateEngine">
                <property name="templateResolver">
                    <bean class="org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver">
                        <!--è§†å›¾å‰ç¼€-->
                        <property name="prefix" value="/WEB-INF/templates/"/>
                        <!--è§†å›¾åç¼€-->
                        <property name="suffix" value=".html"/>
                        <property name="templateMode" value="HTML5"/>
                        <property name="characterEncoding" value="UTF-8"/>
                    </bean>
                </property>
            </bean>
        </property>
    </bean>

    <!--é…ç½®è§†å›¾æ§åˆ¶å™¨-->
    <mvc:view-controller path="/" view-name="index"/>
    <mvc:view-controller path="/toAdd" view-name="employee_add"/>

    <!--å¼€æ”¾å¯¹é™æ€èµ„æºçš„è®¿é—®-->
    <mvc:default-servlet-handler/>

    <!--å¼€å¯SpringMVCæ³¨è§£é©±åŠ¨-->
    <mvc:annotation-driven/>
</beans>
```



### Bean / DAO / Controller

+ åˆ›å»ºå‘˜å·¥æŒä¹…åŒ–ç±» `Employee`ï¼š

::: details

```java
public class Employee {
    private Integer id;
    private String lastName;
    private String email;
    private Integer gender;

    public Employee() {
    }

    public Employee(Integer id, String lastName, String email, Integer gender) {
        this.id = id;
        this.lastName = lastName;
        this.email = email;
        this.gender = gender;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public Integer getGender() {
        return gender;
    }

    public void setGender(Integer gender) {
        this.gender = gender;
    }

    @Override
    public String toString() {
        return "Employee{" +
                "id=" + id +
                ", lastName='" + lastName + '\'' +
                ", email='" + email + '\'' +
                ", gender=" + gender +
                '}';
    }
}
```

:::

+ å¤„ç†æ“ä½œå‘˜å·¥å¢åˆ æ”¹æŸ¥çš„ DAOï¼š

```java
public interface EmployeeDAO {
    /**
     * å¢åŠ å‘˜å·¥ä¿¡æ¯
     * @param employee
     */
    void save(Employee employee);

    /**
     * åˆ é™¤å‘˜å·¥ä¿¡æ¯
     * @param id
     */
    void deleteById(Integer id);

    /**
     * è·å–æ‰€æœ‰å‘˜å·¥ä¿¡æ¯
     * @return
     */
    List<Employee> getAll();

    /**
     * æ ¹æ®å‘˜å·¥idè·å–å‘˜å·¥ä¿¡æ¯
     * @param id
     * @return
     */
    Employee getById(Integer id);
}
```

```java
@Repository
public class EmployeeDAOImpl implements EmployeeDAO {
    private static Map<Integer, Employee> employeeMap;
    private static Integer initId = 1000;

    static {
        employeeMap = new HashMap<>();
        employeeMap.put(++initId, new Employee(initId, "å¼ ä¸‰", "zhangsan@qq.com", 1));
        employeeMap.put(++initId, new Employee(initId, "æå››", "lisi@qq.com", 0));
        employeeMap.put(++initId, new Employee(initId, "ç‹äº”", "wangwu@qq.com", 0));
        employeeMap.put(++initId, new Employee(initId, "èµµå…­", "zhaoliu@qq.com", 1));
    }

    @Override
    public void save(Employee employee) {
        if (employee.getId() == null) {
            employee.setId(++initId);
        }
        employeeMap.put(employee.getId(), employee);
    }

    @Override
    public void deleteById(Integer id) {
        employeeMap.remove(id);
    }

    @Override
    public List<Employee> getAll() {
        return new ArrayList<>(employeeMap.values());
    }

    @Override
    public Employee getById(Integer id) {
        return employeeMap.get(id);
    }
}
```

+ åˆ›å»ºå¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨ç±» `EmployeeController` ï¼š

```java
@Controller
@RequestMapping("/employeeController")
public class EmployeeController {
    @Autowired
    private EmployeeDAO employeeDAO;
	
  // ... 
}
```





### å¢åˆ æ”¹æŸ¥

åˆ›å»ºé¦–é¡µé™æ€é¡µé¢ `templates/index.html`ï¼š

```html
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Index | SpringMVC RESTful Example</title>
</head>
<body>
<h1>INDEX</h1>
<a th:href="@{/employeeController/employee}">æŸ¥çœ‹å‘˜å·¥ä¿¡æ¯</a>
</body>
</html>
```



#### **å®ç°è·å–å‘˜å·¥åˆ—è¡¨**

+ åœ¨ `EmployeeController` ä¸­å¤„ç†è·å–å‘˜å·¥åˆ—è¡¨çš„è¯·æ±‚ï¼Œè¯·æ±‚æ–¹æ³•ä¸º `GET` ï¼š

```java
@RequestMapping(value = "/employee", method = RequestMethod.GET)
public String getAllEmployee(Model model) {
    List<Employee> employeeList = employeeDAO.getAll();
    model.addAttribute("employeeList", employeeList);
    return "employee_list";
}
```

+ åˆ›å»ºå±•ç¤ºå‘˜å·¥åˆ—è¡¨çš„é™æ€é¡µé¢ï¼š`templates/employee_list.html`ï¼š

```html
<h1>å‘˜å·¥ä¿¡æ¯</h1>
<table id="dataTable" border="1" cellpadding="0" cellspacing="0" style="text-align: center;">
    <tr>
        <th colspan="5">EmployeeInfo</th>
    </tr>
    <tr>
        <th>id</th>
        <th>å§“å</th>
        <th>é‚®ç®±</th>
        <th>æ€§åˆ«</th>
        <th>æ“ä½œ </th>
    </tr>
    <tr th:each="employee : ${employeeList}">
        <td th:text="${employee.id}"/>
        <td th:text="${employee.lastName}"/>
        <td th:text="${employee.email}"/>
        <td th:text="${employee.gender == 1 ? 'ç”·' : 'å¥³'}"/>
        <td>
					ä¿®æ”¹
          åˆ é™¤
        </td>
    </tr>
</table>
```



#### æ·»åŠ å‘˜å·¥ä¿¡æ¯åŠŸèƒ½

+ åœ¨å±•ç¤ºå‘˜å·¥ä¿¡æ¯åˆ—è¡¨é¡µé¢æ·»åŠ ä¸€ä¸ªè¶…é“¾æ¥ã€Œæ·»åŠ ã€è¯·æ±‚è·¯å¾„ä¸º `toAdd`ï¼š

```html
<th>æ“ä½œ <a th:href="@{/toAdd}">æ·»åŠ </a> </th>
```

+ åœ¨ SpringMVC é…ç½®æ–‡ä»¶ä¸­é…ç½®è¯¥è¯·æ±‚è·¯å¾„è·³è½¬åˆ°æ·»åŠ å‘˜å·¥ä¿¡æ¯é¡µé¢ï¼š

```xml
<mvc:view-controller path="/toAdd" view-name="employee_add"/>
```

é™æ€é¡µé¢ `employee_add.html`ï¼Œæ­¤æ—¶æäº¤è¡¨è¾¾çš„è¯·æ±‚æ–¹æ³•ä¸º `POST` ï¼š

```html
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Add Employee</title>
</head>
<body>
<form th:action="@{/employeeController/employee}" method="post">
    lastName: <input type="text" name="lastName"><br>
    email: <input type="text" name="email"><br>
    gender: <input type="radio" name="gender" value="1">male <input type="radio" name="gender" value="0">female <br>
    <input type="submit" value="add">
</form>
</body>
</html>
```

+ åœ¨ `EmployeeController` ä¸­å¤„ç†æ·»åŠ å‘˜å·¥ä¿¡æ¯çš„è¯·æ±‚ï¼Œè¯·æ±‚æ–¹æ³•ä¸º `POST`ï¼š

```java
@RequestMapping(value = "/employee", method = RequestMethod.POST)
public String addEmployee(Employee employee) {
    employeeDAO.save(employee);
    return "redirect:/employeeController/employee";
}
```



#### ä¿®æ”¹å‘˜å·¥ä¿¡æ¯åŠŸèƒ½

+ åœ¨æ“ä½œä¸€åˆ—ä¸‹æ·»åŠ è¶…é“¾æ¥ã€Œä¿®æ”¹ã€ï¼Œè·¯å¾„ä¸ºï¼š

```html
<a th:href="@{'/employeeController/employee/'+${employee.id}}">update</a>
```

è¯¥è¯·æ±‚è·¯å¾„æ„ä¸ºé€šè¿‡ `id` è·å–å‘˜å·¥ä¿¡æ¯ï¼Œç„¶åå†è·³è½¬åˆ°ä¿®æ”¹å‘˜å·¥ä¿¡æ¯çš„é¡µé¢ã€‚

+ åœ¨ `EmployeeController` ä¸­å¤„ç†é€šè¿‡ `id` è·å–å‘˜å·¥ä¿¡æ¯çš„è¯·æ±‚ï¼Œè¯·æ±‚æ–¹æ³•ä¸º `GET` ï¼š

```java
@RequestMapping(value = "/employee/{id}",method = RequestMethod.GET)
public String getEmployeeById(@PathVariable("id")Integer id,Model model){
    Employee employee = employeeDAO.getById(id);
    model.addAttribute("employee", employee);
    return "employee_update";
}
```

+ åˆ›å»ºæ›´æ–°å‘˜å·¥ä¿¡æ¯çš„é™æ€é¡µé¢ `employee_update.html` ï¼š
  + åœ¨è¡¨å•ä¸­æœ‰ä¸€ä¸ªéšè—åŸŸç”¨äºä¼ é€’è¯·æ±‚çš„æ–¹æ³•ã€‚
  + æ­¤å¤„æœ‰ä½¿ç”¨ `th:filed` å¤„ç†æ€§åˆ«çš„å±•ç¤ºåˆ°å•é€‰æ¡†çš„æ–¹æ³•ã€‚

```html
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Update Employee</title>
</head>
<body>
<form th:action="@{/employeeController/employee}" method="post">
    <input type="hidden" name="_method" value="put">
    <input type="hidden" name="id" th:value="${employee.id}">
    lastName: <input type="text" name="lastName" th:value="${employee.lastName}"><br>
    email: <input type="text" name="email" th:value="${employee.email}"><br>
    gender: <input type="radio" name="gender" value="1" th:field="${employee.gender}">male <input type="radio" name="gender" value="0" th:field="${employee.gender}">female <br>
    <input type="submit" value="update">
</form>
</body>
</html>
```

+ åœ¨ `EmployeeController` ä¸­å¤„ç†ä¿®æ”¹å‘˜å·¥ä¿¡æ¯è¯·æ±‚ï¼Œè¯·æ±‚æ–¹æ³•ä¸º `PUT` ï¼š

```java
@RequestMapping(value = "/employee", method = RequestMethod.PUT)
public String updateEmployee(Employee employee){
    employeeDAO.save(employee);
    return "redirect:/employeeController/employee";
}
```



#### åˆ é™¤å‘˜å·¥ä¿¡æ¯

åœ¨å±•ç¤ºå‘˜å·¥ä¿¡æ¯åˆ—è¡¨çš„é™æ€é¡µé¢ `employee_list` ä¸­æ·»åŠ ç³»åˆ—çš„æ“ä½œï¼š

+ é¦–å…ˆåˆ›å»ºä¸€ä¸ªè¡¨å•çš„éšè—åŸŸç”¨äºè¯·æ±‚æ–¹æ³• `DELETE` ï¼š

```html
<form method="post" id="deleteForm">
    <input type="hidden" name="_method" value="delete">
</form>
```

+ å¼•å…¥ `vue.js` å¤„ç†ç‚¹å‡»åˆ é™¤è¶…é“¾æ¥æ—¶ï¼Œè¯·æ±‚çš„è·¯å¾„å’Œè¯·æ±‚çš„æ–¹æ³•ï¼š

ï¼ˆè¦å¼•å…¥é™æ€èµ„æºéœ€è¦åœ¨ Spring MVC ä¸­é…ç½®å¼€æ”¾èµ„æºè®¿é—®ï¼Œå¹¶ä¸”åœ¨åˆ›å»º `static` ç›®å½•ï¼Œæ”¾å…¥ç›¸å…³çš„é™æ€èµ„æºåï¼Œéœ€è¦é‡æ–° Maven é¡¹ç›®çš„ç”Ÿå‘½å‘¨æœŸ `Lifecycle` ä¸­é‡æ–°æ‰“åŒ… `package`  ï¼Œå¦åˆ™æœåŠ¡å™¨æ‰¾ä¸åˆ°è¯¥é™æ€èµ„æºï¼‰

```html
<script type="text/javascript" th:src="@{/static/js/vue.js}"></script>
<script type="text/javascript">
    const vue = new Vue({
        el: '#dataTable',
        methods: {
            deleteEmployee(event) {
                if (confirm('ç¡®è®¤åˆ é™¤å—ï¼Ÿ')) {
                    var deleteForm = document.getElementById("deleteForm") // æ ¹æ®idè·å–è¡¨å•å…ƒç´ 
                    deleteForm.action = event.target.href // è·å–è§¦å‘ç‚¹å‡»äº‹ä»¶çš„è¶…é“¾æ¥
                    deleteForm.submit() // æäº¤è¡¨å•
                }
                event.preventDefault() // å–æ¶ˆè¶…é“¾æ¥é»˜è®¤è¡Œä¸º
            }
        }
    })
</script>
```

+ åœ¨è¡¨æ ¼æ“ä½œå¤„æ·»åŠ ã€Œåˆ é™¤ã€è¶…é“¾æ¥ï¼š

```html
<a @click="deleteEmployee" th:href="@{'/employeeController/employee/'+${employee.id}}">delete</a>
```

+ åœ¨ `EmployeeController` ä¸­å¤„ç†åˆ é™¤å‘˜å·¥ä¿¡æ¯ï¼Œè¯·æ±‚æ–¹æ³•ä¸º `DELETE` ï¼š

```java
@RequestMapping(value = "/employee/{id}", method = RequestMethod.DELETE)
public String deleteEmployee(@PathVariable("id") Integer id) {
    employeeDAO.deleteById(id);
    return "redirect:/employeeController/employee";
}
```



::: tip

+ å‡ å¤„å¤„ç†å‘˜å·¥ä¿¡æ¯åè·³è½¬å›å‘˜å·¥ä¿¡æ¯åˆ—è¡¨å±•ç¤ºé¡µé¢ï¼Œå‡ä½¿ç”¨äº† `redirect` é‡å®šå‘åˆ°åŸæ¥çš„é¡µé¢ã€‚

:::

### å¤„ç†é™æ€èµ„æºé—®é¢˜

åœ¨ä¸Šè¿°å¼•å…¥ `vue.js` é™æ€èµ„æºæ—¶ï¼Œåœ¨ SpringMVC é…ç½®æ–‡ä»¶ä¸­æ·»åŠ äº†å¼€æ”¾é™æ€èµ„æºè®¿é—®çš„é…ç½® `<mvc:default-servlet-handler/>`ã€‚

å†æ€»ç»“å…¶ä¸­ä¸‰ä¸ª `mvc` é…ç½®çš„ä½œç”¨ï¼š

```xml
<!--é…ç½®è§†å›¾æ§åˆ¶å™¨-->
<mvc:view-controller path="/" view-name="index"/>
<mvc:view-controller path="/toAdd" view-name="employee_add"/>


<!--å¼€æ”¾é™æ€èµ„æºè®¿é—®-->
<mvc:default-servlet-handler/>

<!--é…ç½®MVCæ³¨è§£é©±åŠ¨-->
<mvc:annotation-driven/>
```

+ `view-controller` ï¼šé…ç½®è§†å›¾æ§åˆ¶å™¨ï¼Œå®ç°ç®€åŒ–é¡µé¢è·³è½¬ã€‚
+ `default-servlet-handler` ï¼šå¼€æ”¾é™æ€èµ„æºçš„è®¿é—®ã€‚
+ `annotation-driven` ï¼šMVC æ³¨è§£é©±åŠ¨ï¼š
  + è§£å†³å› é…ç½®**è§†å›¾æ§åˆ¶å™¨** `view-controller` å¯¼è‡´å…¶ä»–è¯·æ±‚å¤±æ•ˆçš„é—®é¢˜ã€‚
  + è§£å†³å› é…ç½®é™æ€èµ„æºè®¿é—®å¯¼è‡´å…¶ä»–è¯·æ±‚å¤±æ•ˆçš„é—®é¢˜ã€‚



::: warning

+ `annotation-driven` éœ€è¦ä¸ `view-controller`ã€`default-servlet-handler` é…åˆä½¿ç”¨ã€‚
+ `annotation-driven` ä¸ `view-controller` çš„å…³ç³»ï¼š
  + é…ç½®äº† `view-controller` è§†å›¾æ§åˆ¶å™¨è€Œä¸é…ç½® `annotation-driven` æ³¨è§£é©±åŠ¨ï¼Œæ­¤æ—¶é™¤äº†è§†å›¾æ§åˆ¶å™¨é…ç½®è·¯å¾„çš„è¯·æ±‚ï¼Œå…¶ä»–æ§åˆ¶å™¨æ–¹æ³•ä¸­çš„è¯·æ±‚ä¼šå¤±æ•ˆï¼ˆå…¶ä»–è¯·æ±‚å¤±æ•ˆï¼‰ã€‚
  + ä¸¤è€…åŒæ—¶é…ç½®åˆ™å¯ä»¥å®ç°æ‰€æœ‰è¯·æ±‚èƒ½æ­£å¸¸è®¿é—®ã€‚
+ `annotation-driven` ä¸ `default-servlet-handler` çš„å…³ç³»ï¼š
  + é…ç½®äº† `default-servlet-handler` è€Œä¸é…ç½® `annotation-driven` ï¼Œé‚£ä¹ˆæ‰€æœ‰è¯·æ±‚éƒ½äº¤ç»™ `DefaultServlet` å¤„ç†ï¼Œ`DispatcherServlet ` å°†å¤±æ•ˆã€‚
  + ä¸¤è€…åŒæ—¶é…ç½®ï¼Œä¹ˆæ‰€æœ‰è¯·æ±‚å°†å…ˆäº¤ç»™ `DispatcherServlet` å¤„ç†ï¼Œå¤„ç†ä¸äº†å†äº¤ç»™ `DefaultServlet` å¤„ç†ï¼ˆé™æ€èµ„æºå¤„ç†ï¼‰ã€‚

:::

