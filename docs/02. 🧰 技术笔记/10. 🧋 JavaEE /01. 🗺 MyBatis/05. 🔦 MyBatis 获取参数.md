---
title: 🔦 MyBatis 获取参数
date: 2022-03-21 10:40:14
permalink: /pages/33f653/
categories: 
  - _pages
  - 🧋 JavaEE
  - 🗺 MyBatis
tags: 
  - null
author: 
  name: Simon
  link: https://github.com/simon1uo
---





两种方式：

+ `${}` 本质是使用**字符串拼接**的方式拼接 SQL 语句，若为字符串类型或者日期类型的字段进行赋值时，**需要手动添加单引号**。（带来 SQL 注入问题）
+ `#{}` 本质是使用占位符赋值的方式拼接 SQL 语句，若为字符串类型或者日期类型的字段进行赋值时，**可以自动添加单引号**。



### 单个字面量的参数

mapper 接口方法的参数为**单个**的字面量类型，此时可以使用 `${parameter}` 或者 `#{parameter}` 以任意的名称（最好与原来的参数名）获取参数的值。**注意使用 `${}` 时需要手动添加单引号。** 

🌰 例如：

`ParameterMapper.java` mapper 接口中通过用户名获取用户信息的方法：

```java
public interface ParameterMapper {
  User getUserByUsername(String username);
}
```

`ParameterMapper.xml` 中：

```xml
<!--User getUserByUsername(String username);-->
<select id="getUserByUsername" parameterType="String" resultType="User">
  select * from user where username = #{username}
  -- select * from user where username = '${username}' 
</select>
```

`ParameterMapperTest` 类中测试：

```java
@Test
public void testGetUserByUsername() {
  SqlSession sqlSession = SqlSessionUtils.getSqlSession();
  ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
  User admin = mapper.getUserByUsername("admin");
  System.out.println(admin.toString());
}
```



### 多个字面量的参数

若 mapper 接口中的方法参数为多个时，**此时 MyBatis 会自动将这些参数放在一个 `map` 集合中**，以 `arg0, arg1...`为键，以参数为值，或者以 `param1, param2...` 为键，以参数为值；因此只需要通过 `${}` 和 `#{}` 访问 `map` 集合的键就可以获取相对应的值。【注意顺序 `0...1...` 和 `1...2...`，但 `arg` 和 `param` 可混用】。

🌰 例子（两个字面量参数）：

`ParameterMapper.java` mapper 接口中登录验证的方法，参数为用户名和用户密码：

```java
public interface ParameterMapper {
    User checkLogin(String username, String password);
}
```

`ParameterMapper` 中：

```xml
<!--User checkLogin(String username, String password);-->
<select id="checkLogin" resultType="User">
    <!--select * from user where username = #{arg0} and password = #{arg1}-->
    <!-- select * from user where username = #{param1} and password = #{param2} -->
    select * from user where username = #{arg0} and password = #{param2}
</select>
```

`ParameterMapperTest` 类中测试：

```java
@Test
public void testCheckLogin() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
    User admin = mapper.checkLogin("admin", "123456");
    System.out.println(admin.toString());
}
```



### `map` 集合类型的参数

若 mapper 接口中的方法需要的参数为多个时，此时可以手动创建 `map` 集合，将这些数据放在 `map` 中，只需要通过 `${}` 和 `#{}` 访问 `map` **集合的键**就可以获取相对应的值。



🌰 例子：

`ParameterMapper.java` mapper 接口中登录验证方法，参数为 `Map` 集合：

```java
public interface ParameterMapper {
    User checkLoginByMap(Map<String, Object> map);
}
```

`ParameterMapper` 中：

```xml
<!--User checkLogin(String username, String password);-->
<select id="checkLogin" resultType="User">
  select * from user where username = #{username} and password = #{password}
</select>
```

`ParameterMapperTest` 类中测试：

```java
@Test
public void testCheckLoginByMap() {
  SqlSession sqlSession = SqlSessionUtils.getSqlSession();
  ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
  Map<String, Object> map = new HashMap<>();
  map.put("username", "admin");
  map.put("password", "123456");
  User admin = mapper.checkLoginByMap(map);
  System.out.println(admin.toString());
}
```



### :star: 实体类类型的参数

若 mapper 接口中的方法参数为实体类对象时，此时可以使用 `${}` 和 `#{}`，通过访问**实体类对象中的属性名**获取属性值。



🌰 添加用户信息：

`ParameterMapper.java` mapper 接口中登录验证方法，参数为 `Map` 集合：

```java
public interface ParameterMapper {
    void insertUser(User user);
}
```

`ParameterMapper` 中：

```xml
<!-- void insertUser(User user); -->
<insert id="insertUser">
  insert into user values(null, #{username}, #{password}, #{age}, #{sex}, #{email})
</insert>
```

`ParameterMapperTest` 类中测试：

```java
@Test
public void testInsert() {
  SqlSession sqlSession = SqlSessionUtils.getSqlSession();
  ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
  User user = new User(null, "李四", "123456", null, null, null);
  mapper.insertUser(user);
}
```



### 使用 `@Param` 标识参数

可以通过 `@Param` 注解标识 mapper 接口中的方法参数。此时，会将这些参数放在 `map` 集合中，**以 `@Param` 注解的 `value` 属性值为键**，以参数为值；以 `param1, param2...` 为键，以参数为值；只需要通过 `${}` 和 `#{}` 访问 `map` 集合的键就可以获取相对应的值。

> 🔗 相关链接：[从源码分析 `@Param` 实现原理 (尚硅谷 MyBatis 教程)](https://www.bilibili.com/video/BV1VP4y1c7j7?p=29&spm_id_from=pageDriver)

🌰 例子：

`ParameterMapper.java` mapper 接口中登录验证方法，参数使用 `@Param` 方法注解：

```java
public interface ParameterMapper {
    User checkLoginByParam(@Param("username") String username, @Param("password") String password);
}
```

`ParameterMapper` 中：

```xml
<!--User checkLoginByParam(@Param("username") String username, @Param("password") String password);-->
<select id="checkLoginByParam" resultType="User">
    select *
    from user
    where username = #{username}
      and password = #{password}
</select>
```

`ParameterMapperTest` 类中测试：

```java
@Test
public void testCheckLoginByParam() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    ParameterMapper mapper = sqlSession.getMapper(ParameterMapper.class);
    User admin = mapper.checkLoginByParam("admin", "123456");
    System.out.println(admin.toString());
}
```