---
title: ğŸª MyBatis æ˜ å°„æ–‡ä»¶
date: 2022-03-22 11:47:53
permalink: /pages/269652/
categories: 
  - _pages
  - ğŸ§‹ JavaEE
  - ğŸ—º MyBatis
tags: 
  - null
author: 
  name: Simon
  link: https://github.com/simon1uo
---
### MyBaits  æ˜ å°„å™¨
+ æ˜ å°„å™¨æ˜¯ MyBatis æœ€å¤æ‚ä¸”æœ€é‡è¦çš„ç»„ä»¶ã€‚å®ƒæ˜¯ç”±**ä¸€ä¸ªæ¥å£åŠ ä¸Š XML æ–‡ä»¶ï¼ˆæˆ–æ³¨è§£ï¼‰**ç»„æˆã€‚
+ åœ¨æ˜ å°„å™¨ä¸­å¯ä»¥é…ç½®å‚æ•°ã€å„ç±» SQL è¯­å¥ã€å­˜å‚¨è¿‡ç¨‹ã€ç¼“å­˜ã€çº§è”ç­‰å¤æ‚çš„å†…å®¹ï¼Œå¹¶ä¸”é€šè¿‡ç®€æ˜“çš„æ˜ å°„è§„åˆ™æ˜ å°„åˆ°æŒ‡å®šçš„ POJO æˆ–è€…å…¶ä»–å¯¹è±¡ä¸Šï¼Œæ˜ å°„å™¨æ¶ˆé™¤ JDBC åº•å±‚ä»£ç ã€‚
+ åœ¨ MyBatis å¼€å‘ä¸­ä¸»è¦å°±æ˜¯æ˜ å°„å™¨å¼€å‘ã€‚å…¶å®ä¸ Spring ç»„åˆä¹‹åå‰é¢çš„æ ¸å¿ƒç»„ä»¶è¿è¡Œã€å…¨å±€é…ç½®æ–‡ä»¶éƒ½ä¸éœ€è¦æˆ‘ä»¬äº²è‡ªå»åšï¼ŒMyBatis ä¸­æˆ‘ä»¬å”¯ä¸€ä¸»è¦åšçš„å°±æ˜¯å†™æ˜ å°„å™¨ã€‚



### XML æ˜ å°„æ–‡ä»¶ç»“æ„

åœ¨æ˜ å°„æ–‡ä»¶ä¸­ï¼Œ `<mapper>` å…ƒç´ æ˜¯æ˜ å°„æ–‡ä»¶çš„æ ¹å…ƒç´ ï¼Œå…¶ä»–å…ƒç´ éƒ½æ˜¯å®ƒçš„å­å…ƒç´ ï¼š

```xml
<mapper>
	<insert/>
  <upadte/>
  <delete/>
  <select/>
  <resultMap/>
  <sql/>
  <cache/>
  <cache-ref/>
</mapper>
```

ä½¿ç”¨XMLæ–‡ä»¶æ—¶ï¼Œæ˜ å°„æ–‡ä»¶å¸¸ç”¨çš„å…ƒç´ å¦‚ä¸‹ï¼š

+ `insert` å…ƒç´ ï¼šæ’å…¥è¯­å¥
+ `update` å…ƒç´ ï¼šæ›´æ–°è¯­å¥
+ `delete` å…ƒç´ ï¼šåˆ é™¤è¯å¥
+ `select` å…ƒç´ ï¼šæŸ¥è¯¢è¯­å¥
+ `resultMap` å…ƒç´ ï¼šç”¨æ¥æè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­åŠ è½½å¯¹è±¡
+ `sql` å…ƒç´ ï¼šå¯è¢«å…¶å®ƒè¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯å¥å—ï¼ˆäº†è§£ï¼‰
+ `cache` å’Œ `cache-ref` å…ƒç´ ï¼šå‘½åç©ºé—´çš„ç¼“å­˜é…ç½®çš„å¼•ç”¨ï¼ˆäº†è§£ï¼‰



### `insert` å…ƒç´ 

ç”¨äºå¢åŠ æ•°æ®è®°å½•ï¼Œåœ¨æ˜ å°„æ–‡ä»¶ä¸­ä½¿ç”¨ `insert` æ ‡ç­¾ï¼š

```xml
<mapper namespace="å¯¹åº”æ¥å£ä½ç½®">
  <insert id="æ¥å£å¯¹åº”æ–¹æ³•" parameterType="è¿›å‚ç±»å‹" />
  	<!--æ’å…¥çš„SQLè¯­å¥ å¦‚insert into user(age) values(#{age})-->
  </insert>
</mapper>
```

+ `namespace` å±æ€§æŒ‡æ˜å¯¹åº”æ¥å£çš„ä½ç½®ã€‚
+ `id` é…åˆ Mapper çš„å‘½åç©ºé—®ï¼Œæ„æˆå…¨é™å®šåï¼Œç”¨äºæ ‡ç¤ºè¿™æ¡ SQL è¯­å¥ä½œç”¨äºè°ã€‚
+ `parameterType` è¡¨ç¤ºè¿™æ¡ SQL è¯­å¥æ¥å—çš„å‚æ•°ç±»å‹ï¼Œå¯ä»¥æ˜¯ MyBatis ç³»ç»Ÿå®šä¹‰ï¼ˆ`int`ï¼Œ`string` ç­‰ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰çš„ï¼ˆä¾‹å¦‚ `User` ç­‰ï¼‰ã€‚
+ `#{userName}` æ˜¯è¢«ä¼ è¿›å»çš„å‚æ•°ã€‚

ï¼ˆè¯¦ç»†çš„å±æ€§ä¸è¯´æ˜å‚è€ƒæ–‡æ¡£ï¼‰



ğŸŒ° ä¾‹å­ï¼š`insert` æ–°å¢æ•°æ®ä¾‹å­ï¼š
::: details

+ åœ¨ `UserMapper.java` Mapper æ¥å£æ–°å¢ `addUser` æ–¹æ³•ï¼š

```java
int addUser(User user);
```

+ åœ¨ `UserMapper.xml` Mapper æ˜ å°„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```xml
<!--int addUser(User user);-->
<insert id="addUser" parameterType="User">
    insert into user(name, age, sex, address)
    values (#{name}, #{age}, #{sex}, #{address});
</insert>
```

+ è¿è¡Œæµ‹è¯•ï¼š

```java
@Test
public void addUserTest(){
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    int i = mapper.addUser(new User("å°ç½—", 18, "M", "ä½›å±±"));
}
```

:::



### `update` å…ƒç´ 

ç”¨äºä¿®æ”¹æ•°æ®è®°å½•ï¼Œåœ¨æ˜ å°„æ–‡ä»¶ä¸­ä½¿ç”¨ `update` æ ‡ç­¾ï¼š
```xml
<mapper namespace="å¯¹åº”æ¥å£ä½ç½®">
  <update id="æ¥å£å¯¹åº”æ–¹æ³•" parameterType="è¿›å‚ç¾å‹">
    <!--æ›´æ–°çš„SQLè¯­å¥-->
  </update>
</mapper>
```



ğŸŒ° ä¾‹å­ï¼š`update` ä¿®æ”¹æ•°æ®è®°å½•ä¾‹å­ï¼š
::: details

+ é¦–å…ˆåœ¨ `UserMapper.java` æ¥å£ä¸­æ–°å¢æ–¹æ³•ï¼š

```java
int updateUserById(@Param("id") int id,@Param("name") String name);
```

+ åœ¨ `UserMapper.xml` Mapper æ˜ å°„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```xml
<!--int updateUserById(@Param("id") int id,@Param("name") String name);-->
<update id="updateUserById">
    update user set name = #{name} where id = #{id}
</update>
```

+ è¿è¡Œæµ‹è¯•ï¼š

```java
@Test
public void testUpdateUserById() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    int i = mapper.updateUserById(2, "å°ç‹");
}
```

:::



### `delete` å…ƒç´ 

ç”¨äºåˆ é™¤æ•°æ®è®°å½•ï¼Œåœ¨æ˜ å°„æ–‡ä»¶ä¸­ä½¿ç”¨ `delete` æ ‡ç­¾ï¼š

```xml
<mapper namespace="å¯¹åº”æ¥å£ä½ç½®">
  <delete id="æ¥å£å¯¹åº”æ–¹æ³•"parameterType="è¿›å‚ç±»å‹">
    <!--æµ‹è¯•çš„SQLè¯­å¥ï¼Œå¦‚delete from user where id=#(id} -->
  </delete>
</mapper>
```



ğŸŒ° ä¾‹å­ï¼š`delete` åˆ é™¤æ•°æ®çš„ä¾‹å­

::: details

+ é¦–å…ˆåœ¨ `UserMapper.java` æ¥å£ä¸­æ–°å¢æ–¹æ³•ï¼š

```java
int deleteUserById(int id);
```

+ åœ¨ `UserMapper.xml` Mapper æ˜ å°„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```xml
<!--int deleteUserById(int id);-->
<delete id="deleteUserById" parameterType="int">
    delete from user where id = #{id}
</delete>
```

+ è¿è¡Œæµ‹è¯•:

```java
@Test
public void testDeleteUserById() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    int i = mapper.deleteUserById(6);
}
```


![image-20220322175810902](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/ZtS9Jw.png)

:::



### `sql` æ ‡ç­¾

`sql` ç‰‡æ®µï¼Œå¯ä»¥è®°å½•ä¸€æ®µ**å…¬å…± `sql` ç‰‡æ®µ**ï¼Œåœ¨ä½¿ç”¨çš„åœ°æ–¹é€šè¿‡ `include` æ ‡ç­¾è¿›è¡Œå¼•å…¥ï¼š

ğŸŒ° ä¾‹å­ï¼šå°†å¸¸ç”¨æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯çš„å­—æ®µååŒ…å«ä¸º `sql` ç‰‡æ®µï¼š

```xml
<sql id="empColumns">
    eid,emp_name,age,sex,email
</sql>
```

å¼•ç”¨æ–¹æ³•ï¼Œåœ¨è¦ä½¿ç”¨çš„åœ°æ–¹ `include` å¼•å…¥ï¼š

```xml
<include refid="empColumns"></include>
```



### `cache` å’Œ `cache-ref` å…ƒç´ 

+ åœ¨æ˜ å°„æ–‡ä»¶åŠ å…¥ `cache` å…ƒç´ ï¼Œå¯ä»¥å¼€å¯äºŒçº§ç¼“å­˜ã€‚
+ æƒ³è¦**åœ¨ä¸åŒçš„å‘½åç©ºé—´é‡Œå…±äº«åŒä¸€ä¸ªç¼“å­˜é…ç½®æˆ–è€…å®ä¾‹**ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å°±å¯ä»¥ä½¿ç”¨ `cache-ref` å…ƒç´ æ¥å¼•ç”¨å¦ä¸€ä¸ªç¼“å­˜ã€‚

ğŸ” è¯¦ç»†é“¾æ¥ [ğŸ’¾ MyBatis ç¼“å­˜ | notebook by simon (simon1uo.github.io)](https://simon1uo.github.io/notebook/pages/4341f6/)

ğŸŒ° ä¾‹å­ï¼š ä½¿ç”¨ `cache-ref` çš„ä¾‹å­ï¼š
```xml
<cache-ref namespace="com.simon.mapper.UserMapper"/>
```



## ä½¿ç”¨æ³¨è§£æ–¹å¼å®ç°æ˜ å°„


é™¤äº†ä½¿ç”¨æ˜ å°„æ–‡ä»¶å®ç°æ˜ å°„å™¨ï¼ŒMybatis ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£æ–¹å¼å®ç°æ˜ å°„å™¨ï¼š

+ `@Insert`ï¼šå®ç°æ–°å¢æ•°æ®
+ `@Update`ï¼šå®ç°æ›´æ–°æ•°æ®
+ `@Delete`ï¼šå®ç°åˆ é™¤æ•°æ®
+ `@Select`ï¼šå®ç°æŸ¥è¯¢æ•°æ®
+ `@Options`ï¼šæä¾›é…ç½®é€‰é¡¹çš„é™„åŠ å€¼
+ `@Param`ï¼šå½“æ˜ å°„æ–¹æ³•éœ€è¦å¤šä¸ªå‚æ•™æ—¶ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥è¢«åº”ç”¨
  äºæ˜ å°„å™¨æ–¹æ³•å‚æ•°æ¥ç»™æ¯ä¸ªå‚æ•°å–ä¸€ä¸ªåå­—æ¥å¯¹åº”
+ `@CacheNamespace`ï¼šåŒ `<cache>` æ ‡ç­¾æ³¨è§£äºŒçº§ç¼“å­˜ï¼ˆäº†è§£ï¼‰
+ `@CacheNamespaceRef`ï¼šåŒ `<cache-ref>` æ ‡ç­¾æ³¨è§£äºŒçº§ç¼“å­˜ï¼ˆäº†è§£ï¼‰
+ `@Result`ï¼šå®ç°ç»“æœé›†å°è£… 
+ `@Results`ï¼šå¯ä»¥ä¸ `@Result` ä¸€èµ·ä½¿ç”¨ï¼Œå°è£…å¤šä¸ªç»“æœé›†
+ `@ResultMap`ï¼šå®ç°**å¼•ç”¨** `@Results` å®šä¹‰çš„å°è£

***

ä»¥ä¸‹éƒ¨åˆ†å¯è·³è½¬è‡³ [ğŸš² MyBatis åŠ¨æ€SQL | notebook by simon (simon1uo.github.io)](/pages/a1647a/#æ˜ å°„æ–‡ä»¶å®ç°åŠ¨æ€-sql))

+ `@InsertProvider`ï¼šå®ç°åŠ¨æ€SQLæ˜ å°„-æ–°å¢æ•°æ®
+ `@UpdateProvider`ï¼šå®ç°åŠ¨æ€SQLæ˜ å°„-æ›´æ–°æ•°æ®
+ `@DeleteProvider`ï¼šå®ç°åŠ¨æ€SQLæ˜ å°„-åˆ é™¤æ•°æ®
+ `@SelectProvider`ï¼šå®ç°åŠ¨æ€SQLæ˜ å°„-æŸ¥è¯¢æ•°æ®
+ `@One`ï¼šå®ç°ä¸€å¯¹ä¸€ç»“æœé›†å°è£
+ `@Many`ï¼šå®ç°ä¸€å¯¹å¤šç»“æœé›†å°è£

::: warning

ä½¿ç”¨æ³¨è§£æ–¹æ³•æ—¶ï¼Œåº”è¯¥åœ¨ MyBatis å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¼•å…¥ Mapper æ¥å£ã€‚å»ºè®®ç›´æ¥å¯¼å…¥å­˜æ”¾ Mapper æ¥å£çš„åŒ…ã€‚

```xml
<mapper>
	<pakage name="com.simon.mapper"/>
</mapper>
```

:::



### `@insert` æ³¨è§£

ğŸŒ° ä¾‹å­ï¼š

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Insert("insert into user(name, age, sex, address) values(#{name}, #{age}, #{sex}, #{address})")
int newInsertUser(User user);
```

+ æµ‹è¯•ï¼š

```java
@Test
public void NewAddUserTest() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    int i = mapper.newInsertUser(new User("å°ç½—", 18, "M", "ä½›å±±"));
}
```

:::



### `@options` æ³¨è§£

é…åˆä¸»æ³¨è§£ï¼Œæ­¤å¤– `@Options` æ³¨è§£è¿˜å¯ä»¥ä½¿ç”¨ `useCache`ã€ `flushCache` ã€ `timeout` ç­‰å±æ€§ï¼Œä½œç”¨ä¸ XML æ–‡ä»¶ä¸­çš„ `useCache`ã€ `flushCache`ã€ `timeout` éå¸¸ç±»ä¼¼ã€‚


ğŸŒ° ï¼šä»¥é…ç½®ä¸»é”®å›å¡«çš„ `useGeneratedKeys` ä¸ºä¾‹ï¼š

::: details

- åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Insert("insert into user(name, age, sex, address) values(#{name}, #{age}, #{sex}, #{address})")
@Options(useGeneratedKeys = true, keyProperty = "id")
int newInsertUser(User user);
```

+ æµ‹è¯•ï¼š

```java
@Test
public void NewAddUserTest() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    User user = new User( "å°ç½—", 18, "M", "ä½›å±±");
    int i = mapper.newInsertUser(user);
    System.out.println(user);
}
```

![image-20220322201936559](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/apcQSB.png)

:::



### `@update` æ³¨è§£

ğŸŒ° ä¾‹å­ï¼š

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Update("update user set name = #{name} where id = #{id}")
int newUpdateUserById(@Param("id") int id, @Param("name") String name);
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testNewUpdateUserById() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    int i = mapper.newUpdateUserById(2, "å°ç‹");
}
```

:::



### `@Delete` æ³¨è§£



ğŸŒ° ä¾‹å­ï¼š
::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Delete("delete from user where id = #{id}")
int newDeleteUserById(int id);
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testNewDeleteUserById() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    int i = mapper.newDeleteUserById(8);
}
```

:::



### `@Select` æ³¨è§£

ğŸŒ° ä¾‹å­ï¼š
::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select * from user")
List<User> newGetAllUser();
```

+ æµ‹è¯•ï¼š

```java
@Test
public void newGetAllUserTest(){
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    List<User> allUser = mapper.newGetAllUser();
    allUser.forEach(user -> System.out.println(user));
}
```

:::



### è‡ªåŠ¨æ˜ å°„

MyBatis æä¾›äº†è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ `as  `åˆ«åå®ç°ï¼Œè€Œä¸”é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œå¯ä»¥å‡å°‘å·¥ä½œé‡ã€‚å¦å¤–è¿˜å¯ä»¥å¼€å¯é©¼å³°æ˜ å°„ã€‚

ğŸŒ° ä¾‹å­ï¼š
::: details

+ åˆ›å»ºæ–°çš„æŒä¹…åŒ–ç±» `UserResult` ï¼š

```java
public class UserResult {
    private int idResult;
    private String nameResult;
    private int ageResult;
    private String sexResult;
    private String addressResult;
    
}
```

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select name as nameResult from user")
List<UserResult> findNameWithAs();
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testFindNameWithAs() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    List<UserResult> users = mapper.findNameWithAs();
    users.forEach(userResult -> System.out.println(userResult.getNameResult()));
}
```

:::



æ¨¡ç³ŠæŸ¥è¯¢

ğŸŒ° ä¾‹å­ï¼š

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select * from user where name like '%${name}%'")
List<User> findByName(String name);
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testFindByName() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    List<User> users = mapper.findByName("å¼ ");
    users.forEach(user -> System.out.println(user));
}
```

:::

ï¼ˆæ¨¡ç³ŠæŸ¥è¯¢å…¶ä»–æ–¹æ³•å‚è€ƒ ğŸ”—[ğŸ” MyBatis è¿›é˜¶æŸ¥è¯¢ | notebook by simon (simon1uo.github.io)](/pages/991773/#æ¨¡ç³ŠæŸ¥è¯¢)ï¼‰



### èšåˆæŸ¥è¯¢

ğŸŒ° ä¾‹å­ :one:ï¼š ï¼ˆä½¿ç”¨ `count(*)` æ–¹æ³•ï¼‰

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select count(id) from user")
int findWithCount();
```

+  æµ‹è¯•ï¼š

```java
@Test
public void testFindWithCount() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    int count = mapper.findWithCount();
    System.out.println(count + "æ¡ç”¨æˆ·è®°å½•æ•°");
}
```

:::



ğŸŒ° ä¾‹å­ :two: ï¼šï¼ˆä½¿ç”¨ `group by ` æ–¹æ³•ï¼‰

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select count(id), address from user group by address")
List<Map> findWithAddressGroup();
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testFindWithAddressGroup() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    List<Map> maps = mapper.findWithAddressGroup();
    maps.forEach(map -> System.out.println(map));
}
```

:::



### åˆ†é¡µæŸ¥è¯¢

ğŸŒ° ä¾‹å­ï¼š

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select * from user where age > #{age}")
List<User> findByRowBounds(int age, RowBounds rowBounds);
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testFindByRowBounds() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    RowBounds rowBounds = new RowBounds(1, 3);
    List<User> users = mapper.findByRowBounds(20, rowBounds);
    users.forEach(user -> System.out.println(user));
}
```

:::



### `@Result` å’Œ `@Results` æ³¨è§£

å½“æŒä¹…åŒ–ç±»ä¸­å±æ€§åç§°ä¸æ•°æ®åº“å­—æ®µåç§°ä¸å¯¹åº”æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `@Result` ç›¸å…³æ³¨è§£è§£å†³ã€‚

ğŸŒ° ä¾‹å­ï¼šï¼ˆä»¥æŒä¹…åŒ–ç±» `UserResult` ä¸ºä¾‹å­ï¼‰

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select * from user")
@Results(id = "userResultMap", value = {
        @Result(id = true, column = "id", property = "idResult"),
        @Result(column = "name", property = "nameResult"),
        @Result(column = "age", property = "ageResult"),
        @Result(column = "sex", property = "sexResult"),
        @Result(column = "address", property = "addressResult"),
})
List<UserResult> findAllUserResult();
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testFindAllUserResult() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    List<UserResult> users = mapper.findAllUserResult();
    users.forEach(user -> System.out.println(user));
}
```

:::



ğŸŒ° ä¾‹å­ï¼ˆä½¿ç”¨ `ResultMap` é€šè¿‡ `id` å¼•ç”¨å…¶ä»–å·²å®šä¹‰çš„ `ResultMap`ï¼‰

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select * from user where id = #{id}")
@ResultMap("userResultMap")
UserResult findByIdResult(int id);
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testFindByIdResult() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    UserResult userResult = mapper.findByIdResult(2);
    System.out.println(userResult);
}
```

:::



ğŸŒ° ä¾‹å­ï¼ˆä½¿ç”¨ `group by` **èšåˆæŸ¥è¯¢**å½¢æˆç»“æœé›†ï¼‰

::: details

+ åœ¨ Mapper æ¥å£ `UserMapper` ä¸­ï¼š

```java
@Select("select count(id), address from user group by address")
@Results(id = "AddressMap", value = {
        @Result(column = "count(id)", property = "count"),
        @Result(column = "address", property = "addresds")
})
List<Map> findWithGroupMap();
```

+ æµ‹è¯•ï¼š

```java
@Test
public void testFindWithGroupMap() {
    SqlSession sqlSession = SqlSessionUtils.getSqlSession();
    UserMapper mapper = sqlSession.getMapper(UserMapper.class);
    List<Map> maps = mapper.findWithGroupMap();
    maps.forEach(map -> System.out.println(map));
}
```

:::



### `@CacheNamespace` ç›¸å…³æ³¨è§£



ğŸŒ° ä¾‹å­ï¼ˆå¼€å¯äºŒçº§ç¼“å­˜ï¼‰ï¼š

::: details

```java
@CacheNamespace(blocking = true)
public interface UserMapper{
   // ... 
}
```

:::



### `@Param` æ³¨è§£

ä¸»è¦ç”¨äºæ ‡è¯†å‚æ•°ï¼ŒğŸ” è¯¦ç»†ï¼š[ğŸ”¦ MyBatis è·å–å‚æ•° | notebook by simon (simon1uo.github.io)](/pages/33f653/#ä½¿ç”¨-param-æ ‡è¯†å‚æ•°)
