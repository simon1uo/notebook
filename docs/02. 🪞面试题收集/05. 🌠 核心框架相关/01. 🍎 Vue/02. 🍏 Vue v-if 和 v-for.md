> + ä¸ºä»€ä¹ˆ `v-if` å’Œ `v-for` ä¸å»ºè®®ä¸€èµ·ä½¿ç”¨ï¼Ÿ
> + `v-if` å’Œ `v-for` çš„ä¼˜å…ˆçº§ï¼Ÿ



## `v-if` / `v-for` åŒºåˆ«

ç”¨é€”åŒºåˆ«ï¼š

+ `v-if` ç”¨äº æ¡ä»¶æ€§æ¸²æŸ“ä¸€å—å†…å®¹ã€‚è¿™å—å†…å®¹åªæœ‰ `v-if` æŒ‡ä»¤çš„è¡¨è¾¾å¼ä¸º `true` æ—¶è¢«æ¸²æŸ“ã€‚

+ `v-for`ï¼šåŸºäºä¸€ä¸ªæ•°ç»„æ¥æ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨ã€‚éœ€è¦ä½¿ç”¨ `item in items`  å½¢å¼çš„ç‰¹æ®Šè¯­æ³•ï¼Œå…¶ä¸­ `items` æ˜¯åŸæ•°æ®æ•°ç»„æˆ–è€…å¯¹è±¡ï¼Œå…¶ä¸­ `item` æ˜¯è¢«è¿­ä»£çš„æ•°ç»„å…ƒç´ çš„åˆ«åï¼›

  éœ€è¦è®¾ç½® `key` ä¿è¯æ¯ä¸ª `key` å€¼ç‹¬ä¸€æ— äºŒï¼Œä¾¿äº `diff` ç®—æ³•çš„ä¼˜åŒ–ã€‚



ä¼˜å…ˆçº§åŒºåˆ«ï¼š

`v-if` å’Œ `v-for` éƒ½æ˜¯ Vue æ¨¡ç‰ˆæŒ‡ä»¤ï¼Œåœ¨ Vue æ¨¡ç‰ˆç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šå°†æŒ‡ä»¤ç³»ç»Ÿè½¬æ¢ä¸ºå¯æ‰§è¡Œçš„ `render` å‡½æ•°ã€‚

`v-for` çš„ä¼˜å…ˆçº§é«˜äº `v-if`ã€‚

::: details

ğŸŒ° ä¾‹å­ï¼š

```html
<div id="app">
    <p v-if="isShow" v-for="item in items">
        {{ item.title }}
    </p>
</div>
```

åˆ›å»º Vue å®ä¾‹ï¼š

```js
const app = new Vue({
  el: "#app",
  data() {
    return {
      items: [
        { title: 'foo'},
        { title: 'baz'}
      ]
    }
  },
  computed: {
    isShow() {
      return this.items && this.items.length > 0
    }
  }
})
```

æ¨¡ç‰ˆæŒ‡ä»¤çš„ä»£ç ä¼šç”Ÿæˆåˆ° `render` å‡½æ•°ä¸­ï¼Œé€šè¿‡ `app.$options.render` å°±èƒ½è·å¾— æ¸²æŸ“å‡½æ•°ï¼š

```js
Æ’ anonymous() {
  with (this) { return 
    _c('div', { attrs: { "id": "app" } }, 
    _l((items), function (item) 
    { return (isShow) ? _c('p', [_v("\n" + _s(item.title) + "\n")]) : _e() }), 0) }
}
```

> `_l` æ˜¯ `vue` çš„åˆ—è¡¨æ¸²æŸ“å‡½æ•°ï¼ˆè¾“å‡º `v-for` å¾ªç¯çš„ `items` åˆ—è¡¨ï¼‰ï¼Œå‡½æ•°å†…éƒ¨éƒ½ä¼šè¿›è¡Œä¸€æ¬¡`if`åˆ¤æ–­

**å¾—å‡ºç»“è®ºï¼š`v-for` çš„ä¼˜å…ˆçº§æ¯” `v-if` é«˜ã€‚ **



å¦‚æœå°† `v-for` ä¸ `v-if` ç½®äºä¸åŒçš„æ ‡ç­¾ï¼š

```html
<div id="app">
    <template v-if="isShow">
        <p v-for="item in items">{{item.title}}</p>
    </template>
</div>
```

å†è¾“å‡º `render` å‡½æ•°ï¼š

```js
Æ’ anonymous() {
  with(this){return 
    _c('div',{attrs:{"id":"app"}},
    [(isShow)?[_v("\n"),
    _l((items),function(item){return _c('p',[_v(_s(item.title))])})]:_e()],2)}
}
```

> å¯ä»¥çœ‹åˆ° `v-for` ä¸ `v-if` ä½œç”¨äºä¸åŒçš„æ ‡ç­¾ï¼Œå…ˆè¿›è¡Œåˆ¤æ–­ï¼Œåœ¨è¿›è¡Œåˆ—è¡¨æ¸²æŸ“ï¼Œ æ­¤æ—¶ `v-if` ä¼˜å…ˆé«˜äº `v-for`ã€‚



Vue æºç ä¸­ / ç”Ÿæˆå…ƒç´ æ—¶ï¼š

```js
export function genElement (el: ASTElement, state: CodegenState): string {
  if (el.parent) {
    el.pre = el.pre || el.parent.pre
  }
  if (el.staticRoot && !el.staticProcessed) {
    return genStatic(el, state)
  } else if (el.once && !el.onceProcessed) {
    return genOnce(el, state)
  } else if (el.for && !el.forProcessed) {
    return genFor(el, state)
  } else if (el.if && !el.ifProcessed) {
    return genIf(el, state)
  } else if (el.tag === 'template' && !el.slotTarget && !state.pre) {
    return genChildren(el, state) || 'void 0'
  } else if (el.tag === 'slot') {
    return genSlot(el, state)
  } else {
    // component or element
    ...
}
```

åœ¨è¿›è¡Œå…ƒç´ ç±»å‹ `if` åˆ¤æ–­çš„æ—¶å€™ï¼Œ`v-for` æ˜¯æ¯” `v-if` å…ˆè¿›è¡Œåˆ¤æ–­ã€‚

:::



## ä½¿ç”¨æ³¨æ„äº‹é¡¹

+ ä¸è¦æŠŠ `v-if` å’Œ `v-for` æ”¾åœ¨åŒä¸€ä¸ªå…ƒç´ ä¸Šï¼Œå¯èƒ½ä¼šå¸¦æ¥æ€§èƒ½æ–¹é¢çš„æµªè´¹ï¼ˆå› ä¸ºæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šå…ˆå¾ªç¯å†è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼‰ã€‚

  ä¸€å®šè¦ä½¿ç”¨æ—¶ï¼Œåˆ™åœ¨å¤–å±‚åµŒå¥— `template` æ¨¡ç‰ˆæ ‡ç­¾ä¸Šä½¿ç”¨ `v-if`ï¼ˆé¡µé¢æ¸²æŸ“æ—¶ä¸ä¼šç”Ÿæˆ DOM èŠ‚ç‚¹ï¼‰ï¼Œç„¶ååœ¨å†…éƒ¨è¿›è¡Œ `v-for` å¾ªç¯ã€‚

  ğŸŒ° ä¾‹å­ï¼š

  ```html
  <template v-if="isShow">
  	<p v-for="item in items" :key="item.id" /> 
  </template>
  ```

  

+ å¦‚æœæ¡ä»¶å‡ºç°åœ¨å¾ªç¯å†…éƒ¨ï¼Œå¯ä»¥é€šè¿‡ `computed` è®¡ç®—å±æ€§æå‰ç­›é€‰æ‰é‚£ä¸€éƒ¨åˆ†ä¸éœ€è¦æ˜¾ç¤ºçš„é¡¹ç›®ï¼Œè€Œä¸æ˜¯åœ¨æ¨¡ç‰ˆä¸­ä½¿ç”¨ `v-if`ï¼š

  ğŸŒ° ä¾‹å­ï¼š

  ï¼ˆOptions APIï¼‰

  ```js
  computed: {
    items: function() {
      return this.list.filter(function (item) {
        return item.isShow
      })
    }
  }
  ```

  ï¼ˆComposition APIï¼‰

  ```js
  const item = computed(() => {
    return list.filter((item) => {
      return item.isShow
    })
  })
  ```

  