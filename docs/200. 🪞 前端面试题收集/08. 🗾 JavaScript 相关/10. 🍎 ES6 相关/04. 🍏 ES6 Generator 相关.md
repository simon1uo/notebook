---
title:  ğŸ ES6 Generator ç›¸å…³
date: 2022-06-08 17:39:49
permalink: /pages/f1fa30/
categories:
  -  ğŸªå†²åˆº
  -  ğŸ—¾ JavaScript ç›¸å…³
  -  ğŸ ES6 ç›¸å…³
tags:
  - 
---

> + æ€ä¹ˆç†è§£ ES6 ä¸­çš„ `Generator`ï¼Ÿ
> + `Generator` çš„ä½¿ç”¨åœºæ™¯ï¼Ÿ



## ç†è§£

ES6 ä¸­çš„ Generator å‡½æ•°æ˜¯ä¸€ç§å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼Œè¯­æ³•è¡Œä¸ºä¸ä¼ ç»Ÿçš„å‡½æ•°ä¸ç›¸åŒã€‚

>  æ­¤å‰ï¼Œè§£å†³å¼‚æ­¥ç¼–ç¨‹çš„æ‰‹æ®µæœ‰ï¼šå›è°ƒå‡½æ•°å’Œ Promiseã€‚



æ‰§è¡Œ Generator å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚å½¢å¼ä¸Šï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹å¾ï¼š`function` å…³é”®è¯ä¸ Generator å‡½æ•°åç§°ä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå· `*`ï¼›å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨ `yield` è¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ã€‚

ğŸŒ° ä¾‹å­ï¼š
```js
function* myGenerator() {
  yield 'hello'
  yield 'world'
}
```



## ä½¿ç”¨åœºæ™¯

Generator å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå³å…·æœ‰ `Symbol.iterator` ï¼ˆå¯è¿­ä»£ï¼‰å±æ€§ï¼Œå¹¶ä¸”è¿”å›è‡ªèº«ã€‚

ğŸŒ° ä¾‹å­ï¼š

```js
function* gen {
  // ...
}

var g = gen()
g[Symol.iterator]() === g // true
```



é€šè¿‡ `yield` å…³é”®å­—å¯ä»¥æš‚åœ Generator å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡çš„çŠ¶æ€ã€‚

ğŸŒ° ä¾‹å­ï¼š
```js
function* myGenerator() {
  yield 'hello'
  yield 'world'
  yield 'generator'
}
```

> è¿™ä¸ªä¾‹å­ä¸­çš„ Generator å‡½æ•°å­˜åœ¨ä¸‰ä¸ªçŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ `hello`ã€`world`ã€`generator`ã€‚

é€šè¿‡ `next` æ–¹æ³•å¯ä»¥éå†åˆ°ä¸‹ä¸€ä¸ªå†…éƒ¨çŠ¶æ€ã€‚å…¶è¿è¡Œé€»è¾‘ä¸ºï¼š

+ é‡åˆ° `yield` è¡¨è¾¾å¼å°±ä¼šæš‚åœæ‰§è¡Œåé¢çš„æ“ä½œï¼Œå¹¶å°†ç´§è·Ÿ `yield` åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„ `value` å±æ€§å€¼ã€‚
+ ä¸‹ä¸€æ¬¡è°ƒç”¨ `next` æ–¹æ³•æ—¶ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼ŒçŸ¥é“é‡åˆ°ä¸‹ä¸€ä¸ª `yield` è¡¨è¾¾å¼ã€‚
+ å¦‚æœæ²¡æœ‰å†é‡åˆ°æ–°çš„ `yield` è¡¨è¾¾å¼ï¼Œå°±ä¸€ç›´è¿è¡Œåˆ°å‡½æ•°ç»“æŸï¼Œç›´åˆ° `return` è¯­å¥ä¸ºæ­¢ï¼Œå¹¶ä¸”å°† `return ` è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ä½œä¸ºè¿”å›çš„å¯¹è±¡çš„ `value` å±æ€§å€¼ã€‚
+ å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰ `return` è¡¨è¾¾å¼ï¼Œåˆ™è¿”å›çš„å¯¹è±¡çš„ `value` å±æ€§å€¼ä¸º `undefined`ã€‚

```js
var mg = myGenerator()

mg.next() // { value: 'hello', done: false }
mg.next() // { value: 'world', done: false }
mg.next() // { value: 'generator', done: true }
mg.next() // { value: undefined, done: true }
```

> `value` å¯¹åº”çŠ¶æ€å€¼ï¼Œ`done` è¡¨ç¤ºä¸‹ä¸ªçŠ¶æ€æ˜¯å¦å­˜åœ¨ï¼ˆå­˜åœ¨ä¸º `false`ï¼Œ`true` ä¸ºä¸å­˜åœ¨ï¼‰ã€‚`yield` è¡¨è¾¾å¼æœ¬èº«æ²¡æœ‰è¿”å›å€¼ï¼Œæ€»æ˜¯è¿”å› `undefined`ã€‚



ğŸŒ° å®Œæ•´ä¾‹å­ï¼š

```js
function* foo(x) {
 	let y = 2 * (yield (x + 1))
  let z = yield (y / 3)
  return (x + y + z)
}

let a = foo(5)
a.next() // Object{value:6, done:false}
a.next() // Object{null, done:false}
a.next() // Object{null, done:true}

var b = foo(5);
b.next() // { value:6, done:false }
b.next(12) // { value:8, done:false }
b.next(13) // { value:42, done:true }
```





