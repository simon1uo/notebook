---
title:  ğŸ¥— JavaScript DOM æ ·å¼å’Œç±»
date: 2022-05-27 15:05:24
permalink: /pages/9992c4/
categories:
  -  ğŸš¶ğŸ» å‰ç«¯å·©å›ºåŸºç¡€
  -  ğŸ““ JavaScript DOM
tags:
  - 
---
JavaScript ä¿®æ”¹æ ·å¼ä¸€èˆ¬é€šè¿‡ ä¿®æ”¹ DOM å…ƒç´ çš„ `style` å±æ€§ã€‚

ğŸŒ° ä¾‹å­ / åŠ¨æ€è®¡ç®—å…ƒç´ çš„åæ ‡ï¼š 

```js
let top = /* å¤æ‚çš„è®¡ç®— */;
let left = /* å¤æ‚çš„è®¡ç®— */;

elem.style.left = left; // ä¾‹å¦‚ '123px'ï¼Œåœ¨è¿è¡Œæ—¶è®¡ç®—å‡ºçš„
elem.style.top = top; // ä¾‹å¦‚ '456px'
```



## `class...`

`elem.className` å¯¹åº”äº `class` ç‰¹æ€§ï¼ˆattributeï¼‰ï¼Œ å­—ç¬¦ä¸²å€¼ï¼Œå¯ä»¥å¾ˆå¥½åœ°ç®¡ç†æ•´ä¸ªç±»çš„é›†åˆã€‚ã€‚



ğŸŒ° ä¾‹å­ï¼š

```html
<body class="main page">
  <script>
    console.log(document.body.className); // main page
  </script>
</body>
```



ç‰¹æ®Šå¯¹è±¡ `classList` ï¼ˆ**ç±»åˆ—è¡¨**ï¼‰ï¼Œæä¾› `add/remove/toggle` å•ä¸ªç±»çš„æ–¹æ³•ï¼š

+ `elem.classList.add/remove(class)` ï¼šæ·»åŠ /ç§»é™¤ç±»ã€‚
+ `elem.classList.toggle(class)` ï¼šå¦‚æœç±»ä¸å­˜åœ¨å°±æ·»åŠ ç±»ï¼Œå­˜åœ¨å°±ç§»é™¤å®ƒã€‚
+ `elem.classList.contains(class)` ï¼šæ£€æŸ¥ç»™å®šç±»ï¼Œè¿”å› `true/false`ã€‚

ğŸŒ° ä¾‹å­ï¼š

```html
<body class="main page">
  <script>
    // æ·»åŠ ä¸€ä¸ª class
    document.body.classList.add('article');

    alert(document.body.className); // main page article
  </script>
</body>
```



## å…ƒç´ æ ·å¼ `style`

`element.style` å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¯¹åº”äº `style` ç‰¹æ€§ä¸­æ‰€å†™çš„å†…å®¹ã€‚



éµå¾ª é©¼å³°å¼å‘½åï¼Œæ„å‘³ç€åœ¨ç‰¹æ€§ä¸­ä½¿ç”¨ `-` çš„å¤šè¯å‘½åï¼Œ`-` æ„å‘³ç€å¤§å†™å­—æ¯ï¼Œåœ¨å±æ€§ä¸­ä½¿ç”¨é©¼å³°å¼å‘½åï¼Œä¾‹å¦‚ `background-color` å¯¹åº” `element.style.backgroundColor`ã€‚

ğŸŒ° ä¾‹å­ï¼š

```js
document.body.style.backgroundColor = 'green'
```

> åƒ `-moz-border-radius` å’Œ `-webkit-border-radius` è¿™æ ·çš„æµè§ˆå™¨å‰ç¼€å±æ€§ï¼Œä¹ŸåŒæ ·éµå¾ªè¿™ä¸ªè§„åˆ™ã€‚



### é‡ç½®æ ·å¼

+ éšè—ä¸€ä¸ª å…ƒç´ ï¼Œå¯ä»¥è®¾ç½® `element.style.display = 'none'`ã€‚
+ ç§»é™¤è¿™ä¸ªæ ·å¼ï¼Œå°†è¿™ä¸ªæ ·å¼çš„å±æ€§å€¼è®¾ç½®ä¸ºç©ºï¼š`element.style.display = ''`ã€‚è¿™æ—¶å…ƒç´ é‡æ–°å‡ºç°ã€‚

ï¼ˆç©ºå­—ç¬¦ä¸²çš„æ ·å¼å±æ€§ï¼Œæµè§ˆå™¨ä¼šåº”ç”¨ CSS ç±»ä»¥åŠå†…å»ºæ ·å¼ï¼Œå°±åƒè¿™ä¸ªå±æ€§æ²¡æœ‰å‡ºç°è¿‡ï¼‰



### å®Œæ•´é‡å†™æ ·å¼

é€šå¸¸ä½¿ç”¨ `element.style.*` å¯¹å„ä¸ªæ ·å¼èµ‹å€¼ï¼Œä½†æ˜¯ä¸èƒ½è®¾ç½®å®Œæ•´çš„æ ·å¼ `style`ï¼Œå› ä¸ºæ•´ä¸ª `div.style` æ˜¯ä¸€ä¸ªåªè¯»å¯¹è±¡ã€‚

æƒ³è¦ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è®¾ç½®å®Œæ•´çš„æ ·å¼ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå±æ€§ `style.cssText`ï¼š

ğŸŒ° ä¾‹å­ï¼š

```html
<div id="div">Button</div>
```

```js
div.style.cssText = `color: red !important 
		background-color: yellow;
    width: 100px;
    text-align: center;`;

console.log(div.css.cssText)
```

> è¿™æ ·çš„æ–¹å¼å¯¹å…ƒç´ çš„æ ·å¼èµ‹å€¼ï¼Œä¼šåˆ é™¤ç°æœ‰çš„å…ƒç´ æ ·å¼ï¼›å› ä¸ºå®ƒä¸æ˜¯æ·»åŠ è€Œæ˜¯æ›¿æ¢ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸å®‰å…¨ã€‚

è¦æƒ³åœ¨åŸæ¥çš„åŸºç¡€ä¸Šæ·»åŠ ï¼Œè®¾ç½®ä¸€ä¸ªæ–°çš„ç‰¹æ€§å®ç°åŒæ ·çš„æ•ˆæœï¼š

```js
div.setAttribute('style', 'color: red; ... ')
```



### æ³¨æ„æ ·å¼å•ä½

ğŸŒ° ä¾‹å­ / è®¾ç½® `top` æ ·å¼ï¼š

```html
<body>
  <script>
    // æ— æ•ˆï¼
    document.body.style.margin = 20;
    alert(document.body.style.margin); // ''ï¼ˆç©ºå­—ç¬¦ä¸²ï¼Œèµ‹å€¼è¢«å¿½ç•¥äº†ï¼‰

    // ç°åœ¨æ·»åŠ äº† CSS å•ä½ï¼ˆpxï¼‰â€” ç”Ÿæ•ˆäº†
    document.body.style.margin = '20px';
    console.log(document.body.style.margin); // 20px

    console.log(document.body.style.marginTop); // 20px
    console.log(document.body.style.marginLeft); // 20px
  </script>
</body>
```



### è®¡ç®—æ ·å¼ `getComputedStyle`

ä¿®æ”¹æ ·å¼å¯ä»¥ç›´æ¥å¯¹æ ·å¼å¯¹åº”çš„å±æ€§èµ‹å€¼ï¼›ä¾‹å¦‚ç›´æ¥ `element.body.style.color` ä¸èƒ½è·å–åˆ°æ ·å¼å±æ€§çš„å€¼ã€‚



è¦è·å–æ ·å¼å±æ€§çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```js
let computedStyle = getComputedStyle(element, [presudo])
```

+ `element`ï¼šè¦è¢«è¯»å–æ ·å¼å€¼çš„å…ƒç´ ï¼›
+ `[presudo]`ï¼šä¼ªå…ƒç´ ï¼›ä¾‹å¦‚ `::before`ã€‚ç©ºå­—ç¬¦ä¸²æˆ–è€…æ— å‚æ•°æ„å‘³ç€ **å…ƒç´ æœ¬èº«**ã€‚

è·å–åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªå…·æœ‰ **æ ·å¼å±æ€§çš„åªè¯»å¯¹è±¡**ã€‚ç±»ä¼¼ `element.style`ã€‚

ğŸŒ° ä¾‹å­ï¼š

```html
<head>
  <style> body { color: red; margin: 5px } </style>
</head>
<body>

  <script>
    let computedStyle = getComputedStyle(document.body);

    // ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯»å–å®ƒçš„ margin å’Œ color äº†

    alert( computedStyle.marginTop ); // 5px
    alert( computedStyle.color ); // rgb(255, 0, 0)
  </script>

</body>
```

> å¯¹äº `margin`ã€`padding` ç±»å‹çš„æ ·å¼ï¼Œæœ€å¥½ä½¿ç”¨ç²¾å‡†çš„å®Œæ•´å±æ€§åï¼Œä¾‹å¦‚ `paddingLeft`ã€`marginTop` æˆ– `borderTopWidth`ã€‚å¦åˆ™ï¼Œå°±ä¸èƒ½ä¿è¯æ­£ç¡®çš„ç»“æœã€‚



> `getComputedStyle` å®é™…ä¸Šè¿”å›çš„äº‹å±æ€§çš„ **è§£æå€¼**ã€‚
>
> + **è®¡ç®— (computed)** æ ·å¼å€¼æ˜¯æ‰€æœ‰ CSS è§„åˆ™å’Œ CSS ç»§æ‰¿éƒ½åº”ç”¨åçš„å€¼ï¼Œè¿™æ˜¯ CSS çº§è”ï¼ˆcascadeï¼‰çš„ç»“æœã€‚ä¾‹å¦‚ `height:1em` æˆ– `font-size:125%`ã€‚
> + **è§£æ (resolved)** æ ·å¼å€¼æ˜¯æœ€ç»ˆåº”ç”¨äºå…ƒç´ çš„æ ·å¼å€¼å€¼ã€‚è¯¸å¦‚ `1em` æˆ– `125%` è¿™æ ·çš„å€¼æ˜¯ç›¸å¯¹çš„ã€‚æµè§ˆå™¨å°†ä½¿ç”¨è®¡ç®—ï¼ˆcomputedï¼‰å€¼ï¼Œå¹¶ä½¿æ‰€æœ‰å•ä½å‡ä¸ºå›ºå®šçš„ï¼Œä¸”ä¸ºç»å¯¹å•ä½ï¼Œä¾‹å¦‚ï¼š`height:20px` æˆ– `font-size:16px`ã€‚å¯¹äºå‡ ä½•å±æ€§ï¼Œè§£æï¼ˆresolvedï¼‰å€¼å¯èƒ½å…·æœ‰æµ®ç‚¹ï¼Œä¾‹å¦‚ï¼š`width:50.5px`ã€‚





## å…ƒç´ å¤§å°

åœ¨ JavaScript ä¸­æœ‰è®¸å¤šå±æ€§å¯è®©æˆ‘ä»¬è¯»å–æœ‰å…³å…ƒç´ å®½åº¦ã€é«˜åº¦å’Œå…¶ä»–å‡ ä½•ç‰¹å¾çš„ä¿¡æ¯ã€‚

ğŸŒ° ä¾‹å­ï¼š

`.example` å…ƒç´ ä¸­æœ‰ä»¥ä¸‹çš„æ ·å¼ï¼š

```html
<div id="example">
  ...Text...
</div>
<style>
  #example {
    width: 300px;
    height: 200px;
    border: 25px solid #E8C48F;
    padding: 20px;
    overflow: auto;
  }
</style>
```



::: demo [vanilla]

```html
<html>
  <div id="example">
  Introduction This Ecma Standard is based on several originating technologies, the most well known being JavaScript (Netscape) and JScript (Microsoft). The language was invented by Brendan Eich at Netscape and first appeared in that companyâ€™s Navigator 2.0 browser. It has appeared in all subsequent browsers from Netscape and in all browsers from Microsoft starting with ... 
  </div>
</html>
<style>
  #example {
    width: 300px;
    height: 200px;
    border: 25px solid #E8C48F;
    padding: 20px;
    overflow: auto;
  }
</style>
```

:::

> ~~æ³¨æ„ **æ»šåŠ¨æ¡çš„å ç”¨å®½åº¦ç©ºé—´**ï¼šä¸€äº›æµè§ˆå™¨ï¼ˆå¹¶éå…¨éƒ¨ï¼‰é€šè¿‡ä» **å†…å®¹**ï¼ˆcontent widthï¼‰ è·å–ç©ºé—´ä¸º **æ»šåŠ¨æ¡ä¿ç•™ç©ºé—´**ã€‚å¦‚æœæ²¡æœ‰æ»šåŠ¨æ¡ï¼Œå†…å®¹å®½åº¦å°†æ˜¯ `300 px`ï¼Œä½†æ˜¯å¦‚æœæ»šåŠ¨æ¡å®½åº¦æ˜¯ `16px`ï¼ˆä¸åŒçš„è®¾å¤‡å’Œæµè§ˆå™¨ï¼Œæ»šåŠ¨æ¡çš„å®½åº¦å¯èƒ½æœ‰æ‰€ä¸åŒï¼‰ï¼Œé‚£ä¹ˆæœ€åçš„å†…å®¹å®½åº¦è¿˜å‰©ä¸‹ `300 - 16 ï¼ 284px`ã€‚~~
>
> **æœ€è¿‘çš„æµè§ˆå™¨ç‰ˆæœ¬å·²ç»å°† æ»šåŠ¨æ¡çš„å®½åº¦ ä¸å†å ç”¨ å†…å®¹çš„å®½åº¦äº†ã€‚**



### å‡ ä½•å±æ€§

#### `offsetParent`

å…ƒç´ æœ€å¤–é¢çš„å‡ ä½•å±æ€§ï¼š

+ `offsetParent`ï¼šæ˜¯æœ€æ¥è¿‘çš„ç¥–å…ˆå…ƒç´ ï¼Œåœ¨æµè§ˆå™¨æ¸²æŸ“æœŸé—´ï¼Œ**å®ƒè¢«ç”¨äºè®¡ç®—åæ ‡**ã€‚
  + æœ€è¿‘çš„ç¥–å…ˆä¸ºï¼šCSS ä¸­å®šä½ä¸º `position: absolute / relative / fixed`ï¼›æˆ–è€… `<td> / <th> / <table>` ï¼›æˆ–è€… `<body>`

+ `offsetLeft / offsetTop` æä¾›ç›¸å¯¹äº `offsetParent` å·¦ä¸Šè§’çš„ `x / y` **åæ ‡**ã€‚

ğŸŒ° ä¾‹å­ï¼š

```html
<main style="position: relative" id="main">
  <article>
    <div id="example" style="position: absolute; left: 180px; top: 180px">...</div>
  </article>
</main>

<script>
  alert(example.offsetParent.id); // main
  alert(example.offsetLeft); // 180
  alert(example.offsetTop); // 180
</script>
```

> æ³¨æ„è·å–åˆ°çš„æ˜¯ä¸å¸¦å•ä½çš„ **æ•°å­—**ï¼ˆä¸æ˜¯å­—ç¬¦ä¸² `180px`ï¼‰ã€‚

å¯¹äºå‡ ç§æƒ…å†µï¼Œ`offsetParent` å¯èƒ½ä¸º `null`:

+ æœªæ˜¾ç¤ºçš„å…ƒç´ ï¼ˆ`display:none` æˆ–è€…ä¸åœ¨æ–‡æ¡£ä¸­ï¼‰ã€‚
+ å¯¹äº `<body>` ä¸ `<html>`ã€‚ï¼ˆæ— ç¥–å…ˆå…ƒç´ ï¼‰
+ å¯¹äºå¸¦æœ‰ `position:fixed` çš„å…ƒç´ ã€‚



#### `offsetWidth/Height`

åœ¨å…ƒç´ å†…éƒ¨ï¼ˆæœ¬èº«ä¸­ï¼‰ï¼Œè¿™ä¸¤ä¸ªå±æ€§æä¾›äº† å…ƒç´ ã€Œå¤–éƒ¨ã€çš„å®½åº¦å’Œé«˜åº¦ï¼ˆåŒ…æ‹¬è¾¹æ¡†çš„å®Œæ•´å¤§å°ï¼‰

ğŸŒ° ä¾‹å­ï¼š

::: demo [vanilla]

```html
<html>
  <div id="example">
  Introduction This Ecma Standard is based on several originating technologies, the most well known being JavaScript (Netscape) and JScript (Microsoft). The language was invented by Brendan Eich at Netscape and first appeared in that companyâ€™s Navigator 2.0 browser. It has appeared in all subsequent browsers from Netscape and in all browsers from Microsoft starting with ... 
  </div>
</html>
<style>
  #example {
    width: 300px;
    height: 200px;
    border: 25px solid #E8C48F;
    padding: 20px;
    overflow: auto;
  }
</style>
```

:::

> è¿™ä¸ªä¾‹å­ä¸­ï¼š
>
> + `offsetWidth` ä¸º `390` ï¼ˆå¤–éƒ¨å®½åº¦ï¼‰ï¼š
>
>   `25px + 20px + 300px + 20px + 25px`ï¼ˆä¸åŒ…å«æ»šåŠ¨æ¡å®½åº¦ï¼‰
>
> + `offsetHeight` ä¸º `290` ï¼ˆå¤–éƒ¨é«˜åº¦ï¼‰ï¼š
>
>   åŒç†ã€‚



#### `client*`

å…ƒç´ å†…éƒ¨ä¸­æœ‰ è¾¹æ¡† æ—¶ï¼Œä¸ºäº†æµ‹é‡ä»–ä»¬ï¼ˆè¾¹æ¡†çš„å®½åº¦ï¼‰å¯ä»¥ä½¿ç”¨ `client*`ï¼ˆç›¸å¯¹æ¥è¯´ï¼Œ**æ˜¯å†…éƒ¨å’Œå¤–éƒ¨çš„ç›¸å¯¹åæ ‡**ï¼‰ï¼š

åŒä¸Šä¾‹å­ï¼š

+ `clientTop = 25`ï¼šä¸Šè¾¹æ¡†å®½åº¦ 
+ `clientLeft = 25`ï¼šå·¦è¾¹æ¡†å®½åº¦ 



#### `clientWidth/Height`

è®¡ç®—å…ƒç´ è¾¹æ¡†å†…åŒºåŸŸçš„å¤§å°ã€‚åŒ…æ‹¬ å†…å®¹å®½åº¦ï¼ˆcontent widthï¼‰å’Œ `padding` ã€‚ï¼ˆä¸åŒ…æ‹¬æ»šåŠ¨æ¡å®½åº¦ï¼‰

åŒä¸Šä¾‹å­ï¼š

+ `clientHeight = 200`ï¼šä¸ºå†…éƒ¨çš„å…ƒç´ é«˜åº¦ï¼ˆ`200px`ï¼‰åŠ ä¸Š `padding` çš„å®½åº¦ï¼ˆ`2 * 20px`ï¼‰
+ `clientWidth = 340` å†…éƒ¨å…ƒç´ å®½åº¦ï¼ˆ`300px`ï¼‰ åŠ ä¸Š `padding` çš„å®½åº¦(`2 * 20px`) ã€‚



#### `scrollWidth/Height`

è¿™ä¸ªå±æ€§æ˜¯ å®Œæ•´çš„ `clientWidth/Height`ï¼šå®ƒä»¬åŒ…æ‹¬æ»šåŠ¨å‡ºçš„éšè—éƒ¨åˆ†ã€‚

+ `scrollWidth = 340`
+ `scroll = *`



åˆ©ç”¨è¿™ä¸ªå±æ€§å¯ä»¥å°†å±æ€§å±•å¼€åˆ°æ•´ä¸ª å®½åº¦æˆ–è€…é«˜åº¦ã€‚

ğŸŒ° ä¾‹å­ï¼š
::: demo [vanilla]

```html
<html>
  <div id="example2">
    text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text
  </div>
	<button id="example2button">
    å±•å¼€
  </button>
</html>
<style>
  #example2 {
    width: 200px;
    height: 200px;
    border: 1px solid #000;
    overflow: auto;
  }
</style>
<script>
  let button = document.querySelector("#example2button")
  button.addEventListener('click', function() {
    example2.style.height = `${example2.scrollHeight}px`;
  })
</script>
```



:::



#### `scrollLeft/scrollTop`

è¿™ä¸¤ä¸ªå±æ€§æ˜¯å…ƒç´ çš„ éšè— / æ»šåŠ¨éƒ¨åˆ†çš„ `width / Height`ï¼Œæ¢å¥è¯è¯´ï¼Œ`scrollTop` å°±æ˜¯â€œå·²ç»æ»šåŠ¨äº†å¤šå°‘â€ã€‚

å¤§å¤šæ•°å‡ ä½•å±æ€§æ˜¯åªè¯»çš„ï¼Œä½†æ˜¯ `scrollLeft/scrollTop` æ˜¯å¯ä¿®æ”¹çš„ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¼šæ»šåŠ¨è¯¥å…ƒç´ ã€‚

ğŸŒ° ä¾‹å­ï¼šç‚¹å‡»ä¸‹é¢çš„å…ƒç´ ï¼Œåˆ™ä¼šæ‰§è¡Œä»£ç  `elem.scrollTop += 10`ã€‚è¿™ä½¿å¾—å…ƒç´ å†…å®¹å‘ä¸‹æ»šåŠ¨ `10px`ã€‚

::: demo [vanilla]

```html
<html>
  <ul id="example3">
  	<li>click</li>
    <li>me</li>
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
  </ul>
</html>
<style>
  #example3 {
    width: 100px;
    height: 50px;
    overflow: scroll;
  }
  #example3 li {
    cursor: pointer;
  }
</style>
<script>
  let ul = document.querySelector("#example3")
  ul.addEventListener('click', function() {
    this.scrollTop += 10
  })
</script>
```

:::



ğŸŒ° ä¾‹å­ / å°†å…ƒç´ æ»šåŠ¨åˆ°é¡¶éƒ¨æˆ–è€…åº•éƒ¨ï¼š

```js
element.scrollTop = 0 // é¡¶éƒ¨
element.scrollTop = 1e9 // åº•éƒ¨
```



### CSS æ ·å¼å±æ€§ä¸é›†åˆå±æ€§æ¯”è¾ƒ

+ `getComputedStyle` å¯ä»¥è·å– CSS æ ·å¼ä¸­ å…ƒç´ çš„ `width` å’Œ `height`ã€‚

  ```js
  let element = document.body
  console.log(getComputedStyle(element).width)
  ```

  

+ ä½†æ˜¯åº”è¯¥ä½¿ç”¨ **å‡ ä½•å±æ€§** è·å¾—å®½åº¦ã€é«˜åº¦å’Œè®¡ç®—è·ç¦»ï¼š

  + CSS `width` / `height` å–å†³äºå¦ä¸€ä¸ªå±æ€§ï¼š`box-sizing`ï¼Œå®ƒå®šä¹‰äº† CSS å®½åº¦å’Œé«˜åº¦ã€‚å‡ºäº CSS çš„ç›®çš„è€Œå¯¹ `box-sizing` è¿›è¡Œçš„æ›´æ”¹å¯èƒ½ä¼šç ´åæ­¤ç±» JavaScript æ“ä½œã€‚

  + CSS çš„ `width/height` å¯èƒ½æ˜¯ `auto`ï¼Œä¾‹å¦‚å†…è”ï¼ˆinlineï¼‰å…ƒç´ ï¼š

    ```html
    <span id="elem">Hello!</span>
    
    <script>
      console.log( getComputedStyle(elem).width ); // auto
    </script>
    ```

    > ä» CSS çš„è§‚ç‚¹æ¥çœ‹ï¼Œ`width:auto` æ˜¯å®Œå…¨æ­£å¸¸çš„ï¼Œä½†åœ¨ JavaScript ä¸­ï¼Œéœ€è¦ä¸€ä¸ªç¡®åˆ‡çš„ `px` å¤§å°ï¼Œä»¥ä¾¿åœ¨è®¡ç®—ä¸­ä½¿ç”¨å®ƒã€‚

  + ~~æ»šåŠ¨æ¡å ç”¨å…ƒç´ å®½åº¦çš„åŸå› ï¼Œå¯¼è‡´å†…å®¹çš„å®é™…å®½åº¦å°äº CSS å®½åº¦ã€‚~~
  + ä½¿ç”¨ `getComputedStyle(element).width` è·å–çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è€Œå‡ ä½•å…ƒç´ æ˜¯ æ•°å€¼ã€‚



## çª—å£å¤§å°

### è·å–çª—å£çš„ `width` / `height`

åˆ©ç”¨å‡ ä½•å…ƒç´ ï¼šä½¿ç”¨ `document.documentElement` çš„ `clientWidth` / `clientHeight`ï¼š

::: demo [vanilla]

```html
<html>
  è·å–çª—å£çš„é«˜åº¦å’Œå®½åº¦ï¼š
  <button onclick="alert(document.documentElement.clientHeight)">
    document.documentElement.clientHeight
  </button>
  <button onclick="alert(document.documentElement.clientWidth)">
    document.documentElement.clientWidth
  </button>
</html>
```

:::



å…³äº `window.innerWidth` / `window.innerHeight`ï¼š

::: demo [vanilla]

```html
<html>
  è·å–çª—å£çš„é«˜åº¦å’Œå®½åº¦ï¼š
  <button onclick="alert(window.innerHeight)">
    window.innerHeight
  </button>
  <button onclick="alert(window.innerWidth)">
    window.innerWidth
  </button>
</html>
```

:::

::: warning

å¯¹æ¯”ä½¿ç”¨ `client*`ï¼Œçª—å£çš„å®½åº¦æœ‰æ‰€ä¸åŒã€‚å› ä¸ºæ­¤æ—¶ æ»šåŠ¨æ¡å ç”¨äº†å®½åº¦çš„ä¸€äº›ç©ºé—´ã€‚è€Œ `client*` ä¼šå‡å»æ»šåŠ¨æ¡çš„å®½åº¦ã€‚æ‰€ä»¥ä½¿ç”¨ `client*` è¿”å›çš„æ˜¯å¯è§æ–‡æ¡£å†…å®¹çš„ `width` / `heiught`ã€‚

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéœ€è¦é€šè¿‡ **å¯è§çª—å£çš„å®½åº¦** ç»˜åˆ¶æˆ–è€…æ”¾ç½®å…ƒç´ ï¼Œæ‰€ä»¥åº”è¯¥ä½¿ç”¨æ›´åŠ åˆé€‚çš„ `client*`ã€‚

:::



## æ–‡æ¡£å¤§å°

### è·å–æ–‡æ¡£çš„ `width` / `height`

æ ¹æ–‡æ¡£å…ƒç´ æ˜¯ `document.documentElement`ï¼Œå¹¶ä¸”å®ƒåŒ…å›´äº†æ‰€æœ‰å†…å®¹ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ä½¿ç”¨ `documentElement.scrollWidth`/ `scrollHeight` æ¥æµ‹é‡æ–‡æ¡£çš„å®Œæ•´å¤§å°ã€‚

ç”±äºæœªæ˜å†å²åŸå› ï¼Œ`body` / `document.Element`ï¼ˆ`html` æ ¹å…ƒç´ ï¼‰è·å–å‡ºæ¥çš„ é«˜åº¦å’Œå®½åº¦å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥è¦è·å–å¯é çš„æ•°å€¼ï¼Œè¦å–æœ€å¤§å€¼ï¼š

::: demo [vanilla]

```html
<html>
  <button onclick="alert(Math.max(
  document.body.scrollHeight, document.documentElement.scrollHeight,
  document.body.offsetHeight, document.documentElement.offsetHeight,
  document.body.clientHeight, document.documentElement.clientHeight
))">
    scrollHeight
  </button>
  <button onclick="alert(Math.max(
  document.body.scrollWidth, document.documentElement.scrollWidth,
  document.body.offsetWidth, document.documentElement.offsetWidth,
  document.body.clientWidth, document.documentElement.clientWidth
))">
    scrollWidth
  </button>
</html>
```

:::



## æ»šåŠ¨çŠ¶æ€

### è·å¾—å½“å‰æ»šåŠ¨ä½ç½®

ç›¸å¯¹äºå½“å‰é¡µé¢ï¼š

::: demo[vanilla]

```html
<html>
  <button onclick="alert('å½“å‰å·²ä»é¡¶éƒ¨æ»šåŠ¨ï¼š' + window.pageYOffset)">å½“å‰å·²ä»é¡¶éƒ¨æ»šåŠ¨</button>
  <button onclick="alert('å½“å‰å·²ä»å·¦ä¾§æ»šåŠ¨ï¼š' + window.pageXOffset)">å½“å‰å·²ä»å·¦ä¾§æ»šåŠ¨</button>
</html>
```

:::

> ä¹Ÿå¯ä»¥ä» `window.scrollX` / `window.scrollY` ä¸­è·å–ç›¸åŒçš„ä¿¡æ¯ï¼ˆä¸¤ç§å±æ€§ç›¸åŒï¼‰ã€‚



### æ§åˆ¶æ»šåŠ¨ä½ç½®

::: warning

æ³¨æ„è¦åœ¨ é¡µé¢ DOM **å®Œå…¨æ„å»ºå** æ‰èƒ½é€šè¿‡ JavaScript æ»šåŠ¨é¡µé¢ã€‚æ‰€ä»¥è„šæœ¬ä¸èƒ½æ”¾åœ¨ `<head>` æ ‡ç­¾å½“ä¸­ã€‚

:::



é€šè¿‡æ›´æ”¹ `scrollTop` / `scrollLeft` æ»šåŠ¨å…ƒç´ ï¼›

ä½¿ç”¨ `document.documentElement.scrollTop/scrollLeft` å¯¹é¡µé¢è¿›è¡Œç›¸åŒçš„æ“ä½œï¼ˆSafari é™¤å¤–ï¼Œè€Œåº”è¯¥ä½¿ç”¨ `document.body.scrollTop/Left` ä»£æ›¿ï¼‰ã€‚



æˆ–è€…ä½¿ç”¨æ›´åŠ ç®€å•çš„ç‰¹æ®Šæ–¹æ³•ï¼š

+ `window.scrollBy(x, y)`ï¼šå°†é¡µé¢æ»šåŠ¨è‡³ **ç›¸å¯¹äºå½“å‰ä½ç½®çš„ `(x, y)` ä½ç½®**ã€‚å¦‚ï¼Œ`scrollBy(0,10)` ä¼šå°†é¡µé¢å‘ä¸‹æ»šåŠ¨ `10px`ã€‚

ğŸŒ° ä¾‹å­ï¼š

::: demo [vanilla]

```html
<html>
  <button onclick="window.scrollBy(0,10)">
    window.scrollBy(0,10)
  </button>
</html>
```

:::

+ `window.scrollTo(pageX, pageY)`ï¼šå°†é¡µé¢æ»šåŠ¨è‡³ **ç»å¯¹åæ ‡**ï¼Œä½¿å¾—å¯è§éƒ¨åˆ†çš„å·¦ä¸Šè§’å…·æœ‰ç›¸å¯¹äºæ–‡æ¡£å·¦ä¸Šè§’çš„åæ ‡ã€‚`(pageX, pageY)`ã€‚å°±åƒç»™ `scrollLeft` / `scrollTop` è®¾å€¼ä¸€æ ·ã€‚

ğŸŒ° ä¾‹å­ï¼š

::: demo [vanilla]

```html
<html>
  <button onclick="window.scrollTo(0,0)">
    window.scrollTo(0,0) æ»šåŠ¨åˆ°é¡¶éƒ¨
  </button>
</html>
```

:::

ï¼ˆè¿™äº›æ–¹æ³•é€‚ç”¨äºæ‰€æœ‰æµè§ˆå™¨ï¼‰



+ `element.scrollIntoView(top)`ï¼šå°†æ»šåŠ¨é¡µé¢ä»¥ä½¿ `element` å¯è§ã€‚å®ƒæœ‰ä¸€ä¸ªå‚æ•°ï¼š
  + å¦‚æœ `top = true`ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œé¡µé¢æ»šåŠ¨ï¼Œä½¿ `element` å‡ºç°åœ¨çª—å£é¡¶éƒ¨ã€‚**å…ƒç´ çš„ä¸Šè¾¹ç¼˜å°†ä¸çª—å£é¡¶éƒ¨å¯¹é½**ã€‚
  + å¦‚æœ `top = false`ï¼Œé¡µé¢æ»šåŠ¨ï¼Œä½¿ `element` å‡ºç°åœ¨çª—å£åº•éƒ¨ã€‚**å…ƒç´ çš„åº•éƒ¨è¾¹ç¼˜å°†ä¸çª—å£åº•éƒ¨å¯¹é½**ã€‚

::: demo [vanilla]

```html
<html>
  æ»šåŠ¨é¡µé¢ï¼Œä»¥ä½¿å…¶è‡ªèº«å®šä½åœ¨çª—å£é¡¶éƒ¨ï¼š
  <button onclick="this.scrollIntoView()">
    this.scrollIntoView
  </button><br>
  ä¼šæ»šåŠ¨é¡µé¢ï¼Œä»¥ä½¿å…¶è‡ªèº«å®šä½åœ¨çª—å£åº•éƒ¨ï¼š
	<button onclick="this.scrollIntoView(false)">
    this.scrollIntoView(false)
  </button>
</html>
```

:::



### ç¦æ­¢æ»šåŠ¨

è¦ä½¿æ–‡æ¡£ä¸å¯æ»šåŠ¨ï¼Œåªéœ€è¦è®¾ç½® `document.body.style.overflow = "hidden"`ã€‚è¯¥é¡µé¢å°†â€œå†»ç»“â€åœ¨å…¶å½“å‰æ»šåŠ¨ä½ç½®ä¸Šã€‚

å–æ¶ˆåªè¦é‡ç½®è¯¥å±æ€§çš„å€¼å³å¯ã€‚

::: demo [vanilla]

```html
<html>
  <button onclick="document.body.style.overflow = 'hidden'">document.body.style.overflow = â€˜hiddenâ€™</button>
  <button onclick="document.body.style.overflow = ''">document.body.style.overflow = â€˜â€™</button>
</html>
```

:::



## åæ ‡

JavaScript ä¸¤ä¸ªåæ ‡ç³»ï¼š

+ ç›¸å¯¹äº **çª—å£**ï¼šç±»ä¼¼äº `position:fixed`ï¼Œä»çª—å£çš„é¡¶éƒ¨/å·¦ä¾§è¾¹ç¼˜è®¡ç®—å¾—å‡ºã€‚**è¡¨ç¤ºä¸º `clientX` / `clientY` ** ;

+ ç›¸å¯¹äº **æ–‡æ¡£**ï¼šä¸æ–‡æ¡£æ ¹ä¸­çš„ `position:absolute` ç±»ä¼¼ï¼Œä»æ–‡æ¡£çš„é¡¶éƒ¨/å·¦ä¾§è¾¹ç¼˜è®¡ç®—å¾—å‡ºã€‚**è¡¨ç¤ºä¸º `pageX/pageY`ã€‚**

   

### è·å–å…ƒç´ åæ ‡

ä½¿ç”¨æ–¹æ³• `element.getBoundingClientRect()` è¿”å› **æœ€å°çŸ©å½¢** çš„çª—å£åæ ‡ï¼Œè¯¥çŸ©å½¢å°† `element` ä½œä¸ºå†…å»ºçš„ DOMRect ç±»çš„å¯¹è±¡ã€‚

 DOMRect ç±»çš„å¯¹è±¡åŒ…å«ä¸»è¦çš„å±æ€§æœ‰ï¼š

+ `x/y`ï¼šçŸ©å½¢åŸç‚¹ç›¸å¯¹äºçª—å£çš„ X/Y åæ ‡ï¼›
+ `width/height`ï¼šçŸ©å½¢çš„ width/heightï¼ˆå¯ä»¥ä¸ºè´Ÿï¼‰ï¼›
+ `top/bottom`ï¼šé¡¶éƒ¨/åº•éƒ¨çŸ©å½¢è¾¹ç¼˜çš„ Y åæ ‡ï¼›
+ `left/right`ï¼š å·¦/å³çŸ©å½¢è¾¹ç¼˜çš„ X åæ ‡ã€‚



ğŸŒ° ä¾‹å­ / è·å–æŒ‰é’®å…ƒç´ çš„ çª—å£åæ ‡ï¼š
```html
<html>
  <input id="brTest" type="button" value="Get coordinates using button.getBoundingClientRect() for this button" onclick="showRect(this)">
</html>
<script>
function showRect(elem) {
  let r = elem.getBoundingClientRect();
  alert(`x:${r.x}
         y:${r.y}
         width:${r.width}
         height:${r.height}
         top:${r.top}
         bottom:${r.bottom}
         left:${r.left}
         right:${r.right}
        `);
}
</script>
```

> éšç€çª—å£ç›¸å¯¹æŒ‰é’®ä½ç½®çš„æ”¹å˜ï¼Œå…¶çª—å£åæ ‡ï¼ˆå¦‚æœä½ å‚ç›´æ»šåŠ¨é¡µé¢ï¼Œåˆ™ä¸º `y/top/bottom`ï¼‰ä¹Ÿéšä¹‹æ”¹å˜ã€‚



å¯ä»¥å¾—å‡ºï¼š

+ `left = x`
+ `top = y`
+ `right = x + width`
+ `bottom = y + height`

::: tip

æ³¨æ„ï¼š

+ åæ ‡å¯èƒ½æ˜¯å°æ•°ï¼›æµè§ˆå™¨å†…éƒ¨ä½¿ç”¨å°æ•°è¿›è¡Œè®¡ç®—ï¼Œæ‰€ä»¥è®¾ç½®å…ƒç´ çš„æ•°å€¼ä¸ä¸€å®šå¿…é¡»èˆå…¥ã€‚
+ åæ ‡å¯èƒ½æ˜¯è´Ÿæ•°ã€‚ä¾‹å¦‚æ»šåŠ¨é¡µé¢ï¼Œå…ƒç´ åœ¨é¡µé¢ä¸Šæ–¹æ—¶ã€‚

:::



> ä»æ•°å­¦ä¸Šè®²ï¼Œä¸€ä¸ªçŸ©å½¢æ˜¯ä½¿ç”¨å…¶èµ·ç‚¹ `(x,y)` å’Œæ–¹å‘å‘é‡ `(width,height)` å”¯ä¸€å®šä¹‰çš„ã€‚å› æ­¤ï¼Œå…¶å®ƒæ´¾ç”Ÿå±æ€§æ˜¯ä¸ºäº†æ–¹ä¾¿èµ·è§ã€‚
>
> `width/height` å¯èƒ½ä¸ºè´Ÿæ•°ï¼Œè´Ÿæ•°æ—¶ä»å·¦ä¸Šæ–¹æ„å»º çŸ©å½¢ã€‚æ­¤æ—¶ `left` / `right` ä¸ç­‰äº `x` / `y` ï¼ˆæ­¤æ—¶ `x/y` åœ¨å³ä¸‹è§’ï¼‰
>
> ä½†æ˜¯å®é™…ä¸Šï¼Œ`elem.getBoundingClientRect()` æ€»æ˜¯è¿”å›æ­£æ•°çš„ `width/height`ã€‚çœ‹èµ·æ¥é‡å¤äº†çš„å±æ€§ï¼Œå…¶å®ä¸é‡å¤çš„ã€‚

::: warning

æ­¤å¤„çš„ `right` / `bottom` è¦ä¸ CSS ä¸­çš„å®šä½åŒºåˆ†ï¼š

+ åœ¨ CSS å®šä½ä¸­ï¼Œ`right` å±æ€§è¡¨ç¤ºè·å³è¾¹ç¼˜çš„è·ç¦»ï¼Œè€Œ `bottom` å±æ€§è¡¨ç¤ºè·ä¸‹è¾¹ç¼˜çš„è·ç¦»ã€‚

:::



### `elementFromPoint(x,y)`

å¯¹ `document.elementFromPoint(x, y)` çš„è°ƒç”¨ä¼šè¿”å›åœ¨çª—å£åæ ‡ `(x, y)` å¤„åµŒå¥—æœ€å¤šçš„å…ƒç´ ã€‚

```js
let element = document.elementFromPoint(x, y)
```



ğŸŒ° ä¾‹å­ / é«˜äº®æ˜¾ç¤ºå¹¶è¾“å‡ºç°åœ¨ä½äºçª—å£ä¸­é—´çš„å…ƒç´ çš„æ ‡ç­¾ï¼š

```js
let centerX = document.documentElement.clientWidth / 2;
let centerY = document.documentElement.clientHeight / 2;

let elem = document.elementFromPoint(centerX, centerY);
elem.style.background = "red";
console.log(element.tagName)
```



::: warning

**å¯¹äºåœ¨çª—å£ä¹‹å¤–çš„åæ ‡ï¼Œ**`elementFromPoint` **è¿”å›** `null`ã€‚æ‰€ä»¥åªå¯¹åœ¨å¯è§åŒºåŸŸå†…çš„åæ ‡ `(x,y)` èµ·ä½œç”¨ã€‚

:::



### ç»“åˆ CSS å®šä½

ä½¿ç”¨ `getBoundingClientRect` æ¥è·å–å…¶åæ ‡ï¼Œç„¶åä½¿ç”¨ CSS `position` ä»¥åŠ `left/top`ï¼ˆæˆ– `right/bottom`ï¼‰ã€‚

ğŸŒ° ä¾‹å­ / å‡½æ•° `createMessageUnder(elem, html)` åœ¨ `elem` ä¸‹æ˜¾ç¤ºäº†æ¶ˆæ¯ï¼š

```js
let elem = document.getElementById("coords-show-mark");

function createMessageUnder(elem, html) {
  // åˆ›å»º message å…ƒç´ 
  let message = document.createElement('div');
  // åœ¨è¿™é‡Œæœ€å¥½ä½¿ç”¨ CSS class æ¥å®šä¹‰æ ·å¼
  message.style.cssText = "position:fixed; color: red";

  // åˆ†é…åæ ‡ï¼Œä¸è¦å¿˜è®° "px"ï¼
  let coords = elem.getBoundingClientRect();

  message.style.left = coords.left + "px";
  message.style.top = coords.bottom + "px";

  message.innerHTML = html;

  return message;
}

let message = createMessageUnder(elem, 'Hello, world!');
document.body.append(message);
setTimeout(() => message.remove(), 5000);
```

> ä¸Šé¢çš„ä¾‹å­ message å…ƒç´ ä¾èµ–äº `position:fixed`ï¼Œå› æ­¤å½“é¡µé¢æ»šåŠ¨æ—¶ï¼Œå®ƒä»ä½äºçª—å£çš„åŒä¸€ä½ç½®ã€‚
>
> å¦‚æœè¦ä½¿è·Ÿéšå…ƒç´ ç§»åŠ¨ï¼Œè¦ä½¿ç”¨ `position: relative` ä»¥åŠä½¿ç”¨åŸºäºæ–‡æ¡£çš„åæ ‡ã€‚



### æ–‡æ¡£åæ ‡

æ–‡æ¡£ç›¸å¯¹åæ ‡ä»æ–‡æ¡£çš„å·¦ä¸Šè§’å¼€å§‹è®¡ç®—ã€‚ï¼ˆä¸é¡¶éƒ¨çš„ `position:absolute` ç±»ä¼¼ï¼‰

è·å–æ­£ç¡®çš„æ–‡æ¡£åæ ‡ï¼Œåˆ©ç”¨ `client*`:

- `pageY` = `clientY` + æ–‡æ¡£çš„å‚ç›´æ»šåŠ¨å‡ºçš„éƒ¨åˆ†çš„é«˜åº¦ã€‚
- `pageX` = `clientX` + æ–‡æ¡£çš„æ°´å¹³æ»šåŠ¨å‡ºçš„éƒ¨åˆ†çš„å®½åº¦ã€‚



ğŸŒ° ä¾‹å­ / å°†ä» `elem.getBoundingClientRect()` è·å–å…ƒç´ ç›¸å¯¹äºçª—å£åæ ‡ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å½“å‰æ»šåŠ¨ï¼š

```js
function getCoords(elem) {
  let box = elem.getBoundingClientRect();

  return {
    top: box.top + window.pageYOffset,
    right: box.right + window.pageXOffset,
    bottom: box.bottom + window.pageYOffset,
    left: box.left + window.pageXOffset
  };
}
```

ç»“åˆä¸Šé¢çš„æ¶ˆæ¯ä¾‹å­ï¼š

```js
function createMessageUnder(elem, html) {
  let message = document.createElement('div');
  message.style.cssText = "position:absolute; color: red";

  let coords = getCoords(elem);

  message.style.left = coords.left + "px";
  message.style.top = coords.bottom + "px";

  message.innerHTML = html;

  return message;
}
```

> æ­¤æ—¶é¡µé¢æ»šåŠ¨æ—¶ï¼Œæ¶ˆæ¯ä»åœç•™åœ¨å…ƒç´ é™„è¿‘ã€‚
