---
title: 🔑 ES6 语法
date: 2021-09-09 22:40:14
permalink: /pages/e93cf2/
categories: 
  - 前端笔记
tags: 
  - JavaScript
  - ES6
author: 
  name: Simon
  link: https://github.com/simon1uo
---

## ES6

ECMAScript 是前端 JavaScript 的语法规范，用于应用各种 JavaScript 环境（浏览器、node.js）；拓展 JavaScript 的用法。

## :one: 定义变量和常量

ES6 新增两个重要的关键字 `let` 和 `const` ；

### `let`

区别 `let` 与 `var` ：

+ `let` 在代码块内有效，`var` 在全局范围内有效；
+ `let` 只能声明一次，`var` 可以声明多次；

```js
{
  let a = 0;
  a
  var b = 1;
}
a // error: a is not defined
b // 1
```

```js
let a = 1;
let a = 1;
a // Identifier 'a' has already been declared
```



🧮 在 `for` 循环计数中：

```js
for (var i = 0; i < 10; i++) {
  setTimeout(function(){
    console.log(i);
  })
}
// 输出十个 10

for (let j = 0; j < 10; j++) {
  setTimeout(function(){
    console.log(j);
  })
}
// 输出 0123456789
```

+ 当使用 `var` 进行声明时，`i` 在全局范围有效，所以只有一个变量 `i` ，循环里的十个 `setTimeout` 是在循环结束之后才执行，所以 `i` 都为 10；
+ 当使用 `let` 进行声明时，`j` 只在本轮循环中有效，所以每次循环的 `j` 都是新的变量，所以` setTimeout`定时器里面的 j 其实是不同的变量。（**JavaScript 引擎内部会记住前一个循环的值**）



相比于 `var` ，  `let` **不存在变量提升**：

```js
console.log(a);  //ReferenceError: a is not defined
let a = "apple";
 
console.log(b);  //undefined
var b = "banana";
```

变量 a 用 let 声明不存在变量提升，在声明变量 a 之前，a 不存在，所以会报错。变量 b 用 var 声明存在变量提升，所以当脚本开始运行的时候，b 已经存在了，但是还没有赋值，所以会输出 `undefined`。	

`var` 造成变量穿透：

```js
// let 定义的 i 只在循环内有效
for(let i = 0;i < 5;i++){
  console.log(i);
};

// var 定义的 i 全区有效：
for(var i = 0;i < 5;i++){
    console.log(i);
};
console.log("这里就是变量穿透：" + i)
```



### `const`

用 `const` 定义一个只读变量（常量），声明之后不能修改，否则报错。

```js
const PI = Math.PI;
```

暂时性死区：

```js
var PI = "a";
if(true){
  console.log(PI);  // ReferenceError: PI is not defined
  const PI = "3.1415926";
}
```

ES6 中规定，代码块内如果存在 let 或者 const，代码块会对这些命令声明的变量从块的开始就形成一个封闭作用域。代码块内，在声明变量 PI 之前使用它会报错。



## :two: 模版字符串

ES6中可以使用模版字符串，使用反引号` `` `；

当字符串涉及动态更新的部分，ES5 语法与 ES6 语法的对比：

```js
var info = {
    name: 'name',
    address: 'address'
  }
  
var string1 = "Name is " + info.name + ", address is " + info.address;
  console.log(string1);

var string2 = `Name is ${info.name}, address is ${info.address}`;
  console.log(string2);
```





## :three: 函数默认参数和箭头函数

给函数设定默认参数：

```js
// 默认参数 给参数列表设定初始值
function add(a = 100, b = 100) {
    console.log(a, b);
}
// 执行方法，会用默认值填充，打印出来100,200
add();
// 覆盖默认值打印  结果是1，2      
add(1, 2);
```

***

1. ES5中的函数定义：

```js
function fun1() {
    console.log("第一种写法");
};
```

```js
var fun2 = function () {
    console.log("第二种写法");
};
```



2. 🔑 **ES6中的箭头函数**：

> 箭头函数最直观的三个特点：
>
> 1. 不需要 `function` 关键字来创建函数
> 2. 可以省略 `return` 关键字
> 3. 继承当前上下文的` this` 关键字

```js
// 没有参数时：
let fun3 = () => {
    console.log('箭头函数');
};
```

```js
// 有一个参数时，小括号可以省略
let fun4 = v => {
    console.log(v);
}

fun4("一个参数时")
```

```js
// 两个或以上的参数时
let fun5 = (a, b) => {
    console.log(a*b);
}
fun5(4,5);
```

```js
// 省略return
let fun6 = (a,b) => (a + b)
let res = fun6(4,5)
```



## :four: 对象初始化简写

**如果一个对象中的key和value的名字一样的情况下可以定义成一个。**

在 ES5 语法中，对象的定义：

```js
let info = {
    title: "title",
    link: "link",
    go: function () {
        console.log(" logging ");
    }
}
```



ES6 中进行简写：

> 因为对象 `key:value` 存在：
>
> 1. key 和变量的名字一致时， 可以只指定一次；
> 2. 函数可以省略 `function` ；

```js
var title = "title-text";
var link = "link-text";
let info2 = {
    title: title,
    link: link,
    go(){
        console.log(" logging ");
    }
}

console.log(info2);
console.log(info2.title);
console.log(info2.link);
info2.go();
```

```
{ title: 'title-text', link: 'link-text', go: [Function: go] }
title-text
link-text
logging 
```



**🌰例子**：登录

```js
$("#loginbtn").on("click", function () {
    var username = $("#username").val();
    var password = $("#password").val();

    // 传入参数的对象简写
    var params = {
        account,
        password
    };
    // 执行异步请求
    $.ajax({
        type: "post",
        url: "test",
        data: params,
        success() {
            // 简写函数
        }
    })
})
```



## :five: 对象解构

ES 6 **提供一些获取快捷获取对象属性和行为方式**；

```js
var title = "title-text";
var link = "link-text";
let info2 = {
    title: title,
    link: link,
    go(){
        console.log(" logging ");
    }
}

// 调用第一种方法：.
console.log(info2);
console.log(info2.title);
console.log(info2.link);
info2.go();

// 调用第二种方法： []
console.log(info2);
console.log(info2["title"]);
console.log(info2["link"]);
info2["go"]();

// ES6 中对象解构：快速获取属性和方法
var {title, link, go} = info2;
console.log(title);
console.log(link);
go();
```



? 对象取值 `.` 或 `[]`



## :six: 传播操作符

`…`

```js
// 对象传播操作符
var person = {
    name: "name-text",
    address: "address-text",
    link: "link-text",
    phone: 123456,
    go(){
        console.log("logging");
    }
}

// 传播操作符... 解构，剩下的部分赋予给person2
var {name, address, ... person2} = person;

console.log(name);
console.log(address);
console.log(person2);
```



**🌰例子**：模拟后台：异步查询返回用户数据

```js
function findUsers(){
    $.get("xxxxx",function(res){
        var res = {
            pages:11,
            pageSize:10,
            pageNo:1,
            firstFlag:true,
            lastFlag:false,
            total:123,
            data:[{},{},{},{}],
        };
        // ==========================对象 ... 取值===============
        var {data:users,...pagesjon} = res;
        
        //等价于
        /*  var users = res.data;
           var pagesjon = {
            res = {
                pages:11,
                pageSize:10,
                pageNo:1,
                firstFlag:true,
                lastFlag:false,
                total:123,
            }; */
    })
}
```
