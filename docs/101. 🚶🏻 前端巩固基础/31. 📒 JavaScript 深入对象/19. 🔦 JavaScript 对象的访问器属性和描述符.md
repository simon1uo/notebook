---
title:  ğŸ”¦ JavaScript å¯¹è±¡çš„è®¿é—®å™¨å±æ€§å’Œæè¿°ç¬¦
date: 2022-05-13 22:55:10
permalink: /pages/726b7b/
categories:
  -  ğŸ“’ JavaScript æ·±å…¥å¯¹è±¡
tags:
  - JavaScript æ·±å…¥éƒ¨åˆ†
---
å¯¹è±¡æœ‰ä¸¤ç§ å¯¹è±¡å±æ€§ï¼š

+ **æ•°æ®å±æ€§**ã€‚å¸¸ç”¨å­˜å‚¨äºå¯¹è±¡çš„æ•°æ®çš„å±æ€§ã€‚
+ **è®¿é—®å™¨å±æ€§**ï¼ˆaccessor propertyï¼‰ã€‚æœ¬è´¨ä¸Šæ˜¯ç”¨ä½œ **è·å–å’Œè®¾ç½®å€¼çš„å‡½æ•°**ï¼Œä½†æ˜¯ä»å¤–éƒ¨çœ‹åƒå¸¸è§„å±æ€§ã€‚



##  `getter` / `setter`

åœ¨ **å¯¹è±¡å­—é¢é‡** ä¸­ï¼Œä½¿ç”¨ `get` å’Œ `set` è¡¨ç¤ºï¼š

```js
let obj = {
  get propName() {
    // ... å½“è¯»å– obj.propName æ—¶èµ·ä½œç”¨
  },
  set propName() {
    // ... è®¾ç½® obj.propName çš„å€¼æ—¶èµ·ä½œç”¨
  }
}
```



ğŸŒ° ä¾‹å­ï¼š

```js
let user = {
  name: "John",
  surname: "Smith",

  get fullName() {
    return `${this.name} ${this.surname}`;
  }
};

console.log(user.fullName) // John Smith 
```



ä»å¤–éƒ¨çœ‹è®¿é—®å±æ€§å°±åƒä¸€ä¸ªæ™®é€šçš„å±æ€§ï¼Œè¿™å°±æ˜¯ è®¿é—®å±æ€§çš„è®¾è®¡æ€æƒ³ã€‚ä¸åº”è¯¥ä½¿ç”¨ **å‡½æ•°å½¢å¼** è®¿é—®ã€‚åªè¦æ­£å¸¸è¯»å– è®¿é—®å±æ€§ï¼Œè€Œ `getter` åœ¨å¹•åè¿è¡Œã€‚

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœä¸è®¾ç½® `setter` ï¼Œæ­¤æ—¶å¯¹ `fullName` è®¾å€¼ï¼ˆèµ‹å€¼ï¼‰ï¼Œå°±ä¼šå‡ºé”™ã€‚æ‰€ä»¥å°±è¦ç»™ `fullName` æ·»åŠ ä¸€ä¸ª `setter`:

```js
let user = {
  name: "John",
  surname: "Smith",

  get fullName() {
    return `${this.name} ${this.surname}`;
  },

  set fullName(value) {
    [this.name, this.surname] = value.split(" ");
  }
};

// æ­¤æ—¶èµ‹å€¼
user.fullName = "Alice Cooper" 
console.log(user.name)    // Alice
console.log(user.surname) // Cooper
```



è‡³æ­¤ï¼Œ`fullName` è®¿é—®å±æ€§å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ª ã€Œè™šæ‹Ÿå±æ€§ã€ï¼Œå¯è¯»ä¸”å¯å†™ã€‚



## è®¿é—®å™¨æè¿°ç¬¦

è®¿é—®å™¨å±æ€§çš„æè¿°ç¬¦ä¸æ•°æ®å±æ€§çš„ä¸åŒã€‚å¯¹äºè®¿é—®å™¨å±æ€§ï¼Œæ²¡æœ‰ `value` å’Œ `writable`ï¼Œä½†æ˜¯æœ‰ `get` å’Œ `set` å‡½æ•°ã€‚

è®¿é—®å™¨æè¿°ç¬¦æœ‰ï¼š

+ **`get`**ï¼šä¸€ä¸ª **æ²¡æœ‰å‚æ•°** çš„ **å‡½æ•°**ï¼Œåœ¨è¯»å–å±æ€§æ—¶å·¥ä½œã€‚
+ **`set`** ï¼šå¸¦æœ‰ **ä¸€ä¸ªå‚æ•°** çš„ **å‡½æ•°**ï¼Œå½“å±æ€§è¢«è®¾ç½®æ—¶è°ƒç”¨ã€‚
+ **`enumerable`** ï¼šä¸æ•°æ®å±æ€§çš„ç›¸åŒã€‚
+ **`configurable`**ï¼šä¸æ•°æ®å±æ€§çš„ç›¸åŒã€‚



ğŸŒ° ä¾‹å­ / ä½¿ç”¨ `defineProperty` åˆ›å»ºä¸€ä¸ª `fullName` çš„è®¿é—®å™¨ã€‚å¯ä»¥ä½¿ç”¨ `get` å’Œ `set` ä¼ é€’æè¿°ç¬¦ã€‚

```js
let user = {
  name: "John",
  surname: "Smith"
};

Object.defineProperty(user, 'fullName', {
  get() {
    return `${this.name} ${this.surname}`;
  },

  set(value) {
    [this.name, this.surname] = value.split(" ");
  }
});

console.log(user.fullName) // John Smith
for(let key in user) alert(key); // name, surname
```

::: warning 

ä¸€ä¸ªå±æ€§è¦ä¹ˆæ˜¯è®¿é—®å™¨ï¼ˆå…·æœ‰ `get/set` æ–¹æ³•ï¼‰ï¼Œè¦ä¹ˆæ˜¯æ•°æ®å±æ€§ï¼ˆå…·æœ‰ `value`ï¼‰ï¼Œä½†ä¸èƒ½ä¸¤è€…éƒ½æ˜¯ã€‚å¦‚æœè¯•å›¾åœ¨åŒä¸€ä¸ªæè¿°ç¬¦ä¸­åŒæ—¶æä¾› `get` å’Œ `value`ï¼Œå°±ä¼šæŠ¥é”™ã€‚

:::



`getter` å’Œ `setter` å¯ä»¥ç”¨äºåŒ…è£… **çœŸå®** å±æ€§å€¼ï¼ˆåŒ…è£…å™¨ï¼‰ï¼Œå¯ä»¥å¯¹å®ƒä»¬å®ç°æ›´å¤šçš„æ§åˆ¶ã€‚ 

ğŸŒ° ä¾‹å­ï¼š
```js
let user = {
  get name() {
    return this._name
  }
  
  set name(value) {
    if(value.length < 4) {
      console.log("")
    }
    this._name = value
  }
}

user.name = "Pete"
console.log(user.name)

user.name = "A" // å¤ªçŸ­
```

> `name` è¢«å­˜å‚¨åœ¨ `_name` å±æ€§ä¸­ï¼Œå¹¶é€šè¿‡ `getter` å’Œ `setter` è¿›è¡Œè®¿é—®ã€‚
>
> ä»æŠ€æœ¯ä¸Šè®²ï¼Œå¤–éƒ¨ä»£ç å¯ä»¥ä½¿ç”¨ `user._name` ç›´æ¥è®¿é—® nameã€‚ä½†æ˜¯ï¼Œè¿™å„¿æœ‰ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„çº¦å®šï¼Œå³ä»¥ä¸‹åˆ’çº¿ `"_"` å¼€å¤´çš„å±æ€§æ˜¯å†…éƒ¨å±æ€§ï¼Œä¸åº”è¯¥ä»å¯¹è±¡å¤–éƒ¨è¿›è¡Œè®¿é—®ã€‚



## è®¿é—®å™¨çš„å…¼å®¹æ€§

è®¿é—®å™¨çš„ä¸€å¤§ç”¨é€”æ˜¯ï¼Œå®ƒä»¬å…è®¸éšæ—¶é€šè¿‡ä½¿ç”¨ `getter` å’Œ `setter` æ›¿æ¢ã€Œæ­£å¸¸çš„ã€æ•°æ®å±æ€§ï¼Œæ¥æ§åˆ¶å’Œè°ƒæ•´è¿™äº›å±æ€§çš„è¡Œä¸ºã€‚



ğŸŒ° ä¾‹å­ï¼š
```js
function User(name, age) {
  this.name = name;
  this.age = age;
}

let john = new User("John", 25);
```

ä½†æ˜¯ï¼Œä¹‹åå¯èƒ½ä¼šé€‰æ‹© å­˜å‚¨ `birthday` è€Œä¸æ˜¯ `age`ï¼Œé€‰æ‹©æ—¥æœŸç±»å‹çš„ `birthday` å¯ä»¥æ›´åŠ ç²¾å‡†ï¼Œä½†æ˜¯ `age` åˆæƒ³è¦ä¿ç•™ï¼š
```js
function User(name, birthday) {
  this.name = name;
  this.birthday = birthday;

  // å¹´é¾„æ˜¯æ ¹æ®å½“å‰æ—¥æœŸå’Œç”Ÿæ—¥è®¡ç®—å¾—å‡ºçš„
  Object.defineProperty(this, "age", {
    get() {
      let todayYear = new Date().getFullYear();
      return todayYear - this.birthday.getFullYear();
    }
  });
}

let john = new User("John", new Date(1992, 6, 1));
```

