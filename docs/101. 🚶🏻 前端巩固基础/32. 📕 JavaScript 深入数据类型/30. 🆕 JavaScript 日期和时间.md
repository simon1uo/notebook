---
title:  ğŸ†• JavaScript æ—¥æœŸå’Œæ—¶é—´
date: 2022-05-05 17:42:01
permalink: /pages/3ef40f/
categories:
  -  ğŸ“• JavaScript æ·±å…¥æ•°æ®ç±»å‹
tags:
  -  JavaScript æ·±å…¥éƒ¨åˆ†
---



JavaScript ä¸­å†…ç½®å¯¹è±¡ä¸­ ï¼Œæä¾›äº†å­˜å‚¨æ—¥æœŸæ—¶é—´ã€ç®¡ç†æ—¥æœŸæ—¶é—´çš„å¯¹è±¡ `Date`ï¼Œå¯ä»¥å­˜å‚¨åˆ›å»º/ä¿®æ”¹æ—¶é—´ï¼Œæˆ–è€…ç”¨æ¥æµ‹é‡æ—¶é—´ï¼Œå†æˆ–è€…ä»…ç”¨æ¥æ‰“å°å½“å‰æ—¶é—´ã€‚



## åˆ›å»º `Date` å¯¹è±¡

+ **ä¸å¸¦å‚æ•°åˆ›å»º**ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨ç¤º **å½“å‰æ—¥æœŸå’Œæ—¶é—´** çš„ `Date` å¯¹è±¡ï¼š

  ```js
  let now = new Date();
  ```



+ `new Date(milliseconds)`ï¼šä¼ å…¥çš„ **æ•´æ•°å‚æ•°** ï¼ˆæ—¶é—´æˆ³ï¼‰ä¸ºåŸºäº  1970 å¹´ 1 æœˆ 1 æ—¥ UTC+0 ä¹‹åç»è¿‡çš„ **æ¯«ç§’æ•°**ï¼š

  ```js
  let Jan01_1970 = new Date(0);
  ```

  > æ—¶é—´æˆ³ï¼šæ˜¯ä¸€ç§æ—¥æœŸçš„è½»é‡çº§æ•°å­—è¡¨ç¤ºå½¢å¼ã€‚é€šå¸¸ä½¿ç”¨ `new Date(timestamp)` é€šè¿‡æ—¶é—´æˆ³æ¥åˆ›å»ºæ—¥æœŸï¼Œå¹¶å¯ä»¥ä½¿ç”¨ `date.getTime()` å°†ç°æœ‰çš„ `Date` å¯¹è±¡è½¬åŒ–ä¸ºæ—¶é—´æˆ³ã€‚

  æ—¶é—´æˆ³å¯ä»¥ä¸ºè´Ÿæ•°ï¼ŒåŒæ ·åŸºäº 1970 å¹´ 1 æœˆ 1 æ—¥ UTC+0ï¼Œå‘åæ¨çš„æ—¶é—´ï¼š

  ```js
  let Dec31_1969 = new Date(-24 * 3600 * 1000); 
  ```

+ `new Date(datestring)`ï¼šä¼ å…¥å­—ç¬¦ä¸²ï¼Œä¼šè¢«è‡ªåŠ¨è§£æã€‚è¯¥ç®—æ³•ä¸ `Date.parse` æ‰€ä½¿ç”¨çš„ç®—æ³•ç›¸åŒã€‚

  ```js
  let date = new Date("2022-01-01");
  console.log(date)
  ```



+ `new Date(year, month, date, hours, minutes, seconds, ms)` ï¼šä½¿ç”¨å½“å‰æ—¶åŒºä¸­çš„ç»™å®šç»„ä»¶åˆ›å»ºæ—¥æœŸã€‚åªæœ‰ **å‰ä¸¤ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„**ã€‚

  + `year` å¿…é¡»æ˜¯å››ä½æ•°ã€‚
  + `month` èŒƒå›´æ˜¯ `0` ï¼ˆä¸€æœˆï¼‰ï½`11` ï¼ˆåäºŒæœˆ ï¼‰ã€‚
  + `date` æ˜¯å½“æœˆçš„å…·ä½“æŸä¸€å¤©ï¼Œå¦‚æœç¼ºå¤±ï¼Œåˆ™ä¸ºé»˜è®¤å€¼ `1`ã€‚
  + å¦‚æœ `hours` / `minutes` / `seconds` / `ms` ç¼ºå¤±ï¼Œåˆ™å‡ä¸ºé»˜è®¤å€¼ `0`ã€‚

  ```js
  new Date(2011, 0, 1, 0, 0, 0, 0); // 1 Jan 2011, 00:00:00
  new Date(2011, 0, 1); // åŒæ ·ï¼Œæ—¶åˆ†ç§’ç­‰å‡ä¸ºé»˜è®¤å€¼ 0
  ```

   

  æ—¶åˆ†ç§’çš„ç²¾åº¦æœ€å¤§ç²¾ç¡®åˆ° **æ¯«ç§’**ï¼ˆ1 / 1000 ç§’ï¼‰ï¼š
  ```js
  let date = new Date(2011, 0, 1, 2, 3, 4, 567);
  ```

  

## è®¿é—®æ—¥æœŸ / æ—¶é—´ç»„ä»¶ï¼ˆæ–¹æ³•ï¼‰

`Date()` å¯¹è±¡ä¸­æä¾›è·å–æ—¥æœŸçš„å¤šç§æ–¹æ³•ï¼š

+ `getFullYear()` ï¼šè·å– 4 ä½æ•°çš„å¹´ä»½ã€‚
+ `getMonth`ï¼šè·å–æœˆä»½ï¼ˆåŒæ ·èŒƒå›´ä¸º `0` ï½ `11`ã€‚
+ `getDate()`ï¼šè·å–å½“æœˆçš„å…·ä½“æ—¥æœŸã€‚ï¼ˆèŒƒå›´ä¸º `1` ï½ `31`ï¼‰ã€‚ğŸ ä¸è¦ä¸ `Date` å¯¹è±¡æ··æ·†ã€‚
+ `getDay()`ï¼šè·å–ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼ˆèŒƒå›´ä¸º `0` ï¼ˆæ˜ŸæœŸæ—¥ï¼‰ï½ `6`ï¼ˆæ˜ŸæœŸå…­ï¼‰ æ¯”æœˆä»½å¥½ç†è§£ï¼‰
+ `getHours()`/ `getMinutes()` / `getSeconds()` / `getMilliseconds()`ï¼šè·å–æ—¶é—´çš„ç»„ä»¶ã€‚

::: warning

è¦è·å–å¹´ä»½å°±ä½¿ç”¨ `getFullYear()`ã€‚ä¸è¦ä½¿ç”¨ä¸è§„èŒƒçš„ `getYear()`ã€‚

:::

::: tip

**ä»¥ä¸Šçš„æ‰€æœ‰æ–¹æ³•è¿”å›çš„ç»„ä»¶éƒ½æ˜¯åŸºäºå½“åœ°æ—¶åŒºçš„ã€‚**

åŸºäº UTC+0 æ—¶åŒºçš„æ—¥ã€æœˆã€å¹´ç­‰ï¼š[getUTCFullYear()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCFullYear)ï¼Œ[getUTCMonth()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCMonth)ï¼Œ[getUTCDay()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCDay)ã€‚åªéœ€è¦åœ¨ `"get"` ä¹‹åæ’å…¥ `"UTC"` å³å¯ã€‚

ä½†æ˜¯ `getTime()`ã€`getTimezoneOffset` æ²¡æœ‰ UTC å˜ä½“ã€‚

:::



+ `getTime()`ï¼šè¿”å›æ—¥æœŸçš„æ—¶é—´æˆ³ â€”â€” ä» 1970-1-1 00:00:00 UTC+0 å¼€å§‹åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ã€‚

+ `getTimezoneOffset()`ï¼šè¿”å› UTC ä¸æœ¬åœ°æ—¶åŒºä¹‹é—´çš„æ—¶å·®ï¼Œä»¥åˆ†é’Ÿä¸ºå•ä½ï¼š`new Date().getTimezoneOffset() `ã€‚

  åŒ—äº¬æ—¶é—´ ï¼ˆUTC + 8ï¼‰ è¿”å› `-480`ã€‚



## è®¾ç½®æ—¶é—´ç»„ä»¶

è®¾ç½®æ—¥æœŸ/æ—¶é—´ç»„ä»¶ï¼š

+ `setFullYear(year, [month], [date])`
+ `setMonth(month, [date])`
+ `setDate(date)`
+ `setHours(hour, [min], [sec], [ms])`
+ `setMinutes(min, [sec], [ms])`
+ `setSeconds(sec, [ms])`
+ `setMilliseconds(ms)`
+ `setTime(milliseconds)` ï¼šåŸºäº 1970-01-01 00:00:00 UTC+0 ä»¥æ¥çš„æ¯«ç§’æ•°æ¥è®¾ç½®æ•´ä¸ªæ—¥æœŸã€‚

ä»¥ä¸Šæ–¹æ³•é™¤äº† `setTime()` éƒ½æœ‰ UTC å˜ä½“ï¼Œä¾‹å¦‚ï¼š`setUTCHours()`ã€‚



ğŸŒ° ä¾‹å­ / ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªç»„ä»¶ï¼š

```js
let today = new Date();

today.setHours(0); // å°æ—¶æ•°ä¸º 0
today.setHours(0, 0, 0, 0); // åŒæ—¶è®¾ç½®æ—¶åˆ†ç§’ 00:00:00
```



## æ—¥æœŸçš„è‡ªåŠ¨æ ¡å‡†ç‰¹æ€§

è®¾ç½®äº†è¶…å‡ºå¸¸ç†çš„æ—¥æœŸèŒƒå›´ï¼Œ`Date` å¯¹è±¡ä¼šè‡ªåŠ¨æ ¡å‡†ï¼Œè¶…å‡ºèŒƒå›´çš„æ—¥æœŸç»„ä»¶å°†ä¼šè¢«è‡ªåŠ¨åˆ†é…å“åº”çš„æ—¥æœŸã€‚



ğŸŒ° ä¾‹å­ï¼š

```js
let date = new Date(2013, 0, 32); // 2013-01-32? 2013-2-1
console.log(date) // çŸ«æ­£ä¸º 1st Feb 2013
```



ğŸŒ° ä¾‹å­ / `Date` å¯¹è±¡å¤„ç†é—°å¹´ï¼š
```js
let date = new Date(2016, 1, 28); // 2æœˆ28æ—¥
date.setDate(date.getDate() + 2); 
```



ğŸŒ° ä¾‹å­ / å¸¸ç”¨ä¸è®¡ç®— â€¦ ä¹‹å / ä¹‹å‰çš„æ—¥æœŸï¼š
```js
let date = new Date();
date.setYear(date.getFullYear() + 700); // 
```



### è®¡ç®—å·®å€¼

å½“ `Date` å¯¹è±¡è¢«è½¬åŒ–ä¸ºæ•°å­—æ—¶ï¼Œå¾—åˆ°çš„æ˜¯å¯¹åº”çš„ **æ—¶é—´æˆ³**ï¼Œä¸ä½¿ç”¨ `date.getTime()` çš„ç»“æœç›¸åŒï¼š

```js
let date = new Date();
alert(+date);
```

å¾—åˆ°çš„æ—¶é—´æˆ³å¯ä»¥ç”¨æ¥è®¡ç®—æ—¥æœŸçš„å·®å€¼ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½æ—¶é—´å·®ï¼š

ğŸŒ° ä¾‹å­ / æµ‹é‡ç®—æ³•ç”¨æ—¶ ï¼š

```js
let start = new Date(); 

for (let i = 0; i < 100000; i++) {
  let doSomething = i * i * i;
}

let end = new Date(); 

console.log(`The loop took ${end - start} ms`)
```

> ä½¿ç”¨ `new Date()` æµ‹é‡å¹¶ä¸ç²¾å‡†ã€‚

## `Date.now()`

å¦‚æœä»…ä»…æƒ³è¦æµ‹é‡æ—¶é—´é—´éš”ï¼Œä¸éœ€è¦ `Date` å¯¹è±¡ã€‚ç‰¹æ®Šçš„æ–¹æ³• `Date.now()`ï¼Œå®ƒä¼š **è¿”å›å½“å‰çš„æ—¶é—´æˆ³**ã€‚ç›¸å½“äº `new Date().getTime()`ï¼Œä½†å®ƒ **ä¸ä¼šåˆ›å»ºä¸­é—´çš„ `Date` å¯¹è±¡**ã€‚å› æ­¤å®ƒæ›´å¿«ï¼Œè€Œä¸”ä¸ä¼šå¯¹åƒåœ¾å¤„ç†é€ æˆé¢å¤–çš„å‹åŠ›ã€‚

è¿™ç§æ–¹æ³•å¾ˆå¤šæ—¶å€™å› ä¸ºæ–¹ä¾¿ï¼Œåˆæˆ–æ˜¯å› æ€§èƒ½æ–¹é¢çš„è€ƒè™‘è€Œè¢«é‡‡ç”¨ï¼Œä¾‹å¦‚ä½¿ç”¨ JavaScript ç¼–å†™æ¸¸æˆæˆ–å…¶ä»–çš„ç‰¹æ®Šåº”ç”¨åœºæ™¯ã€‚



## åº¦é‡



ğŸŒ° ä¾‹å­ / åˆ¤æ–­ä¸¤ä¸ªè®¡ç®—æ—¥æœŸå·®å€¼çš„å‡½æ•°ï¼š

```js
function diffSubtract(date1, date2) {
  return date2 - date1;
}

function diffGetTime(date1, date2) {
  return date2.getTime() - date1.getTime();
}
```

> ä¸¤ç§æ–¹æ³•çš„ç»“æœä¸€æ ·ï¼Œåšçš„äº‹æƒ…å®Œå…¨ç›¸åŒã€‚ä½†æ˜¯å…¶ä¸­ä¸€ä¸ªå‡½æ•°ä½¿ç”¨æ˜¾æ€§çš„ `date.getTime()` æ¥è·å– **æ¯«ç§’å½¢å¼** çš„æ—¥æœŸï¼Œå¦ä¸€ä¸ªåˆ™ä¾èµ–äºã€Œæ—¥æœŸ â€” æ•°å­—ã€çš„è½¬æ¢ã€‚

æµ‹è¯•åå‘ç°ï¼Œ`getTime()` ä¼šæ¯” éœ€è¦æ—¥æœŸè½¬æ¢çš„æ–¹æ³•å¿«ï¼Œå› ä¸ºç±»å‹è½¬æ¢å¸¦æ¥äº†æ—¶é—´å¼€é”€ã€‚



ğŸŒ° ä¾‹å­ / ä½¿ç”¨å¤šè¿›ç¨‹æµ‹è¯•åº¦é‡ï¼š**ä¸ºäº†å¾—åˆ°æ›´åŠ å¯é çš„åº¦é‡ï¼Œæ•´ä¸ªåº¦é‡æµ‹è¯•åŒ…åº”è¯¥é‡æ–°è¿è¡Œå¤šæ¬¡ã€‚**

```js
function diffSubtract(date1, date2) {
  return date2 - date1;
}

function diffGetTime(date1, date2) {
  return date2.getTime() - date1.getTime();
}

function bench(f) {
  let date1 = new Date(0);
  let date2 = new Date();

  let start = Date.now();
  for (let i = 0; i < 100000; i++) f(date1, date2);
  return Date.now() - start;
}

let time1 = 0;
let time2 = 0;

// äº¤æ›¿è¿è¡Œ bench(diffSubtract) å’Œ bench(diffGetTime) å„ 10 æ¬¡
for (let i = 0; i < 10; i++) {
  time1 += bench(diffSubtract);
  time2 += bench(diffGetTime);
}

console.log( 'Total time for diffSubtract: ' + time1 );
console.log( 'Total time for diffGetTime: ' + time2 );
```

> å½“è¿è¡Œ `bench(diffSubtract)` çš„åŒæ—¶ï¼ŒCPU è¿˜åœ¨å¹¶è¡Œå¤„ç†å…¶ä»–äº‹åŠ¡ï¼Œå¹¶ä¸”è¿™ä¹Ÿä¼šå ç”¨èµ„æºã€‚ç„¶è€Œï¼Œè¿è¡Œ `bench(diffGetTime)` çš„æ—¶å€™ï¼Œå¹¶è¡Œå¤„ç†çš„äº‹åŠ¡å®Œæˆäº†ã€‚

ç°ä»£çš„ JavaScript å¼•æ“çš„å…ˆè¿›ä¼˜åŒ–ç­–ç•¥åªå¯¹æ‰§è¡Œå¾ˆå¤šæ¬¡çš„ ã€Œhot codeã€ æœ‰æ•ˆï¼ˆå¯¹äºæ‰§è¡Œå¾ˆå°‘æ¬¡æ•°çš„ä»£ç æ²¡æœ‰å¿…è¦ä¼˜åŒ–ï¼‰ã€‚å› æ­¤åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œçš„ä¼˜åŒ–ç¨‹åº¦ä¸é«˜ã€‚å¯èƒ½éœ€è¦å¢åŠ ä¸€ä¸ªå‡æ¸©æ­¥éª¤ï¼š

```js
// åœ¨ä¸»å¾ªç¯ä¸­å¢åŠ â€œå‡æ¸©â€ç¯èŠ‚
bench(diffSubtract);
bench(diffGetTime);

// å¼€å§‹åº¦é‡
for (let i = 0; i < 10; i++) {
  time1 += bench(diffSubtract);
  time2 += bench(diffGetTime);
}
```



::: tip

**è¿›è¡Œå¾®åº¦é‡æµ‹è¯•æ—¶è¦å°å¿ƒ**ï¼šç°ä»£çš„ JavaScript å¼•æ“æ‰§è¡Œäº†å¾ˆå¤šä¼˜åŒ–ã€‚ä¸ã€Œæ­£å¸¸ä½¿ç”¨ã€ç›¸æ¯”ï¼Œå®ƒä»¬å¯èƒ½ä¼šæ”¹å˜ã€Œäººä¸ºæµ‹è¯•ã€çš„ç»“æœï¼Œç‰¹åˆ«æ˜¯åœ¨å¯¹å¾ˆç»†å¾®çš„ä¸œè¥¿è¿›è¡Œåº¦é‡æµ‹è¯•æ—¶ï¼Œä¾‹å¦‚ operator çš„å·¥ä½œæ–¹å¼æˆ–å†…å»ºå‡½æ•°ã€‚

:::



## `Date.parse`

è½¬æ¢å­—ç¬¦ä¸²ä¸º `Date` å¯¹è±¡å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ã€‚å­—ç¬¦ä¸²çš„æ ¼å¼åº”è¯¥ä¸ºï¼š`YYYY-MM-DDTHH:mm:ss.sssZ`ï¼Œå…¶ä¸­ï¼š

+ `YYYY-MM-DD` â€”â€” æ—¥æœŸï¼š`å¹´-æœˆ-æ—¥`ã€‚
+ å­—ç¬¦ `"T"` æ˜¯ä¸€ä¸ªåˆ†éš”ç¬¦ã€‚
+ `HH:mm:ss.sss` â€”â€” æ—¶é—´ï¼šå°æ—¶ï¼Œåˆ†é’Ÿï¼Œç§’ï¼Œæ¯«ç§’ã€‚
+ å¯é€‰å­—ç¬¦ `'Z'` ä¸º `+-hh:mm` æ ¼å¼çš„æ—¶åŒºã€‚å•ä¸ªå­—ç¬¦ `Z` ä»£è¡¨ UTC+0 æ—¶åŒºã€‚

 ä¸€èˆ¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç®€çŸ­å½¢å¼ï¼š`YYYY-MM-DD` æˆ– `YYYY-MM`ã€`YYYY`ã€‚

`Date.parse(str)` è°ƒç”¨ä¼šè§£æç»™å®šæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å› **æ—¶é—´æˆ³**ã€‚å¦‚æœç»™å®šå­—ç¬¦ä¸²çš„ **æ ¼å¼ä¸æ­£ç¡®**ï¼Œåˆ™è¿”å› `NaN`ã€‚



ğŸŒ° ä¾‹å­ï¼š

```js
let ms = Date.parse('2022-01-01');
console.log(ms) // 1640995200000
```



ğŸŒ° ä¾‹å­ / é€šè¿‡æ—¶é—´æˆ³åˆ›å»º `Date` å¯¹è±¡ï¼š

```js
let date = new Date(Date.parse('2022-01-01'))
```



## æ—¥æœŸå’Œæ—¶é—´æ€»ç»“

+ JavaScript ä¸­ä½¿ç”¨ `Date` å¯¹è±¡è¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´ï¼ŒåŒ…æ‹¬ä¸¤è€…ä¿¡æ¯ã€‚
+ ä½¿ç”¨ `Date.now()` å¯ä»¥æ›´å¿«åœ°è·å–å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ã€‚



### å®ä¾‹

#### è½¬æ¢ä¸ºæ˜ŸæœŸ

> ç¼–å†™ä¸€ä¸ªå‡½æ•°å°†æ—¥æœŸè½¬æ¢ä¸º ã€Œæ˜ŸæœŸ X ã€ç±»å‹çš„æ—¥æœŸç±»å‹ã€‚

::: details

```js
function getWeekdays(date) {
  let weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­', ]
  return weekdays[date.getDay()]
}

console.log(getWeekdays(new Date()))
```

:::



#### è®¡ç®— X å¤©ä¹‹å‰çš„æ—¥æœŸ

> å†™ä¸€ä¸ªå‡½æ•° `getDateAgo(date, days)`ï¼Œè¿”å›ç‰¹å®šæ—¥æœŸ `date` å¾€å‰ `days` å¤©æ˜¯å“ªä¸ªæœˆçš„å“ªä¸€å¤©ã€‚
>
> å‡è®¾ä»Šå¤©æ˜¯ 20 å·ï¼Œé‚£ä¹ˆ `getDateAgo(new Date(), 1)` çš„ç»“æœåº”è¯¥æ˜¯ 19 å·ï¼Œ`getDateAgo(new Date(), 2)` çš„ç»“æœåº”è¯¥æ˜¯ 18 å·ã€‚èƒ½å®ç°è·¨æœˆã€è·¨å¹´ã€‚

::: details

```js
function getDateAgo(date, days) {
	let dateCopy = new Date(date)
  
  dateCopy.setDate(date.getDate() - days)
  return dateCopy.getDate()
}

let date = new Date()
console.log(getDateAgo(date, 2))
```

:::





#### ä»Šå¹´è¿‡å»äº†å¤šä¹…ï¼ˆè¿›åº¦ï¼‰

::: details

```js
function getYearProgress() {
	let now = new Date()
  let yearFirstDay = new Date(now.getFullYear().toString())
  let progress = (((now - yearFirstDay) / (1000 * 60 * 60 * 24 * 365)) * 100).toFixed(2) + '% / 100%'
  return progress
}
```

:::