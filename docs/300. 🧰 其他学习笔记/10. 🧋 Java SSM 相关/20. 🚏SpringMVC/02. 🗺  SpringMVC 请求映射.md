---
title: 🗺  SpringMVC 请求映射
date: 2022-03-17 19:49:58
permalink: /pages/4cd331/
categories: 
  - _pages
  - 🧋 JavaEE
  - 🚏SpringMVC
tags: 
  - SpringMVC
author: 
  name: Simon
  link: https://github.com/simon1uo
---


（ **`@RequestingMapping` 注解**）

### 功能和使用

+ 功能：`@RequestingMapping` 作用：从名称上可以看出，将请求和处理的**控制器** Controller 方法关联起来，建立映射关系。

+ `@RequestingMapping` 使用位置：
  + 标识一个类：设置映射请求的请求路径的初始信息
  + 标识一个方法：设置映射要求路径的具体信息

🌰 例子：

```java
@Controller
@RequestMapping("/test")
public class RequestMappingController {
    @RequestMapping("/testRequestMapping")
    public String success(){
        return "success";
    }
}
```

::: warning 

如上例子，请求映射所映射的请求路径为 `/test/testRequestMapping` 。

:::

注解类为请求路径加了一层，避免出现相同的请求路径的情况。



> 当控制器中有**多个方法对应同一个请求**：这是一种特殊的情况，要至少定义两个控制类，其中定义的控制器方法上`@ReqeustMapping`指定同一请求路径：
>
> 🌰 例子：
> ```java
> @Controller
> public class HelloController {
>     @RequestMapping("/")
>     public String index() {
>         return "index";
>     }
> }
> @Controller
> public class RequestMappingController {
>     @RequestMapping("/")
>     public String index() {
>         return "target";
>     }
> }
> ```
>
> 如果存在两个或者多个控制器，其中控制器的方法注解的 `@RequestMapping `一致，即多个控制器方法视图都想要处理同一个请求，此时 Tomcat 会抛出 `BeanCreationException` 表明已有重复的控制器方法处理同一个请求。所以要通过在控制类中添加 `@RequestMapping` 注解。

### 分析请求映射中的属性

#### :star: `value` 属性

+ 通过请求的请求地址匹配映射。
+ 当`value` 属性是一个字符串类型的数组，表示该请求映射能匹配多个请求地址所对应的请求。
+ :warning: **`value` 属性值必须设置，至少通过请求地址匹配请求**。



🌰 例子：匹配多个请求地址的 `value` 属性：

```java
@Controller
public class RequestMappingController {
    @RequestMapping(value = {"/testRequestMapping", "/test"})
    public String success() {
        return "success";
    }
}
```



#### `method` 属性

+ 表示通过请求的请求方式（例如，`GET` 、`POST` ）匹配请求映射。
+ `method` 属性值类型时是一个 `RequestMethod` 类型值的数组，表示该请求映射能够匹配**多种请求方式**的请求。
+ 若当前请求的请求地址满足请求映射的 `value` 属性，但是请求方式不满足 `method ` 属性，则浏览器报错代码 `405`（Request method '…' not supported）。 

（不设置 `method`  属性默认请求方式为 `GET`）

🌰 例子： 

```java
@RequestMapping(
        value = {"/testRequestMapping", "/test"},
        method = {RequestMethod.GET, RequestMethod.POST}
)
public String success() {
    return "success";
}
```



::: tip

1. 对于**指定请求方式**的控制器方式，SpringMVC 提供了 `@RequestMapping` 派生注解：
   + `@GetMapping`：处理 `GET` 请求的映射； 
   + `@PostMapping`：处理 `POST` 请求的映射； 
   + `@PutMapping`：处理 `PUT` 请求的映射； 
   + `@DeleteMapping`：处理 `DELETE` 请求的映射； 
2. 常见的请求方式有上述，:warning: 但是**目前浏览器只支持 `GET` 和 `POST` 两种请求方式**，若使用其他的请求方式，**则按照默认的请求方式 `GET` 处理**。（若要发送 `PUT` 或者 `DELETE` 请求，则需要通过 Spring 提供的**过滤器** `HiddenHttpMethodFilter`，指路相关阅读 /Restful） 

:::

🌰 例子：使用 `@GetMapping` 注解：

```java a
@GetMapping("/testGetMapping")
public String testGetMapping(){
    return "success";
}
```



#### `params` 属性（*了解）

+ 通过请求的请求参数匹配请求映射。

+ 属性值是一个字符串类型的数组，可以通过四种表达式设置请求参数和请求映射匹配关系：
  + `param` ：要求请求映射所匹配的请求必须携带  `param` 请求参数；
  + `!param` ：要求请求映射所匹配的请求必须不能携带  `param` 请求参数；
  + `param=value` ：要求映射所匹配的请求必须携带  `param` 请求参数且 `param=value` ；
  + `param!=value` ：要求映射所匹配的请求必须携带  `param` 请求参数但是  `param!=value` 。

+ 若当前请求满足 `@RequestingMapping` 注解的 `value` 和 `method` 属性，但是不满足 `params` 属性，此时页面报错代码为 `400` ：

🌰 例子： `params` 属性的使用：

```java
@RequestMapping(
        value = "/testParamsAndHeaders",
        params = {"username=admin"}
)
public String testParamsAndHeaders(){
    return "success";
}
```

```html
<a th:href="@{/testParamsAndHeaders(username='admin', password='123456')}">
    测试RequestMapping注解的params属性
</a>
```

::: tip

thymeleaf 在请求路径中添加参数可以使用 `()` 包含。

:::



### `headers` 属性（*了解）

+ 通过请求的**请求头信息**匹配请求映射。
+ 属性值是一个字符串类型的数组，可以通过四种表达式设置头信息和请求映射的匹配关系。
  + `header` ：要求请求映射所匹配的请求必须携带 `header` 请求头信息。
  + `!header` ：要求请求映射所匹配的请求必须不能携带 `header` 请求头信息。
  + `header=value` ：要求请求映射所匹配的请求必须携带 `header` 请求头信息并且 `header=value`。
  + `header!=value` ：要求请求映射所匹配的请求必须携带 `header` 请求头信息但是 `header！=value`。

+ 若当前请求满足 `@RequestingMapping` 注解的 `value` 和 `method` 属性，但是不满足 `headers` 属性，此时页面报错代码为 `404` 资源未找到 。

🌰 例子：

```java
@RequestMapping(
            value = "/testParamsAndHeaders",
            headers = {"Host=localhost:8081"}
    )
    public String testParamsAndHeaders(){
        return "success";
    }
```



## 路径相关

+ SpringMVC 支持 ant 风格的路径，包含以下规则：

  + `?`： 表示任意的单个字符。
  + `*`：表示任意的**0个或者多个**字符。
  + `**`：表示任意的一层或多层目录。（只能使用如 `/**/xxx` 的方式添加，不能在字符之间，否则会被当作单个 `*` 的使用）

  :warning: 注意：不能使用特殊字符 `?` 以及 `/` 到实际路径。

🌰 例子：

```java
//    @RequestMapping("/a?a/testAnt")
//    @RequestMapping("/a?a/testAnt")
@RequestMapping("/**/testAnt")
public String testAnt(){
  return "success";
}
```





+ SpringMVC **支持路径中的占位符获取数据**（:star: 重点）：SpringMVC 路径中的占位符常用于 restful 的风格中，当请求路径中将某些数据通过路径的方式传输到服务器中，就可以在相应的 `@RequestMapping` 注解的 `value` 属性中通过占位符 `(xxx)` 表示传输的数据，再通过 `@PathVariable` 注解，将占位符表示的数据赋值给**控制器方法的形参**。

> + 原始方式：`/deleteUser?id=1` 
> + rest 方式：`/deleteUser/1`

🌰 例子：

```java
@RequestMapping("/testPath/{id}/{username}")
public String testPath(@PathVariable("id") String id, @PathVariable("username") String username) {
    System.out.println("id: " + id + ", username: " + username);
    return "success";
}
```

```html
<a th:href="@{/testPath/1/admin}">
    测试RequestMapping路径传参
</a>
```