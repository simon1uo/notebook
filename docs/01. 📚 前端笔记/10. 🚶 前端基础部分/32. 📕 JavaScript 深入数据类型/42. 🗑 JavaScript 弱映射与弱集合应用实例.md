---
title:  ğŸ—‘ JavaScript å¼±æ˜ å°„ä¸å¼±é›†åˆåº”ç”¨å®ä¾‹
date: 2022-05-07 15:16:11
permalink: /pages/49386e/
categories:
  -  ğŸ“š å‰ç«¯ç¬”è®°
  -  ğŸš¶ åŸºç¡€éƒ¨åˆ†
  -  ğŸ“• JavaScript æ·±å…¥æ•°æ®ç±»å‹
tags:
  - 
---
## `WeakSet`

### ä¿¡æ¯å·²è¯»

> æœ‰ä¸€ä¸ª messages æ•°ç»„ï¼š
>
> ```js
> let messages = [
>   {text: "Hello", from: "John"},
>   {text: "How goes?", from: "John"},
>   {text: "See you soon", from: "Alice"}
> ];
> ```
>
> å¯ä»¥è®¿é—®å®ƒï¼Œä½†æ˜¯ message æ˜¯ç”±å…¶ä»–äººçš„ä»£ç ç®¡ç†çš„ã€‚è¯¥ä»£ç ä¼šå®šæœŸæ·»åŠ æ–°æ¶ˆæ¯ï¼Œåˆ é™¤æ—§æ¶ˆæ¯ï¼Œä½†æ˜¯ä½ ä¸çŸ¥é“è¿™äº›æ“ä½œç¡®åˆ‡çš„å‘ç”Ÿæ—¶é—´ã€‚
>
> åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„æ¥ä¿å­˜å…³äºæ¶ˆæ¯ã€Œæ˜¯å¦å·²è¯»ã€çš„ä¿¡æ¯ï¼Ÿè¯¥ç»“æ„å¿…é¡»å¾ˆé€‚åˆå¯¹ç»™å®šçš„ message å¯¹è±¡ç»™å‡ºã€Œå®ƒè¯»äº†å—ï¼Ÿã€çš„ç­”æ¡ˆã€‚
>
> + å½“ä¸€ä¸ªæ¶ˆæ¯è¢«ä» `messages` ä¸­åˆ é™¤åï¼Œå®ƒåº”è¯¥ä¹Ÿä»ä½ çš„æ•°æ®ç»“æ„ä¸­æ¶ˆå¤±ã€‚
> + ä¸èƒ½ä¿®æ”¹ `message` å¯¹è±¡ï¼Œä¾‹å¦‚å‘å…¶æ·»åŠ å±æ€§ã€‚å› ä¸ºå®ƒä»¬æ˜¯ç”±å…¶ä»–äººçš„ä»£ç ç®¡ç†çš„ï¼Œä¿®æ”¹è¯¥æ•°æ®å¯èƒ½ä¼šå¯¼è‡´ä¸å¥½çš„åæœã€‚



::: details

```js
let readMessages = new WeakSet()

readMessages.add(message[0]) // è¯»ä¿¡æ¯
readMessages.add(message[1]) // è¯»ä¿¡æ¯

// å†æ¬¡è¯»ä¿¡æ¯
readMessages.add(message[0]) // ä¸å†æ·»åŠ å·²è¯»

// æ£€æŸ¥æ˜¯å¦å·²è¯»
readMessages.has(message[0]) // true æ„å‘³ç€ä¿¡æ¯å·²è¯»

messages.shift(); // ä¿¡æ¯è¢«æ¸…ç†
// readMessages ä¼šè·Ÿéšæ¸…ç†
```

> ä½¿ç”¨ `WeakSet` çš„ä»£ä»·ï¼šä¸èƒ½å¯¹å®ƒè¿›è¡Œè¿­ä»£ï¼Œä¹Ÿä¸èƒ½ç›´æ¥ä»ä¸­è·å–ã€Œæ‰€æœ‰å·²è¯»æ¶ˆæ¯ã€ã€‚ä½†æ˜¯ï¼Œå¯ä»¥é€šè¿‡éå†æ‰€æœ‰æ¶ˆæ¯ï¼Œç„¶åæ‰¾å‡ºå­˜åœ¨äº `set` çš„é‚£äº›æ¶ˆæ¯æ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ã€‚



å¦ä¸€ä¸ªè§£å†³æ–¹æ³•ï¼šåœ¨è¯»å–æ¶ˆæ¯åå‘æ¶ˆæ¯æ·»åŠ è¯¸å¦‚ `message.isRead=true` ä¹‹ç±»çš„å±æ€§ã€‚ç”±äº `messages` å¯¹è±¡æ˜¯ç”±å¦ä¸€ä¸ªä»£ç ç®¡ç†çš„ï¼Œå› æ­¤é€šå¸¸ä¸å»ºè®®è¿™æ ·åšï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ symbol å±æ€§æ¥é¿å…å†²çªã€‚

```js
let isRead = Symbol("isRead");
messages[0][isRead] = true;
```

ç°åœ¨ï¼Œç¬¬ä¸‰æ–¹ä»£ç å¯èƒ½çœ‹ä¸åˆ°è¿™ä¸ªé¢å¤–å±æ€§ã€‚å°½ç®¡ symbol å¯ä»¥é™ä½å‡ºç°é—®é¢˜çš„å¯èƒ½æ€§ï¼Œä½†ä»æ¶æ„çš„è§’åº¦æ¥çœ‹ï¼Œè¿˜æ˜¯ä½¿ç”¨ `WeakSet` æ›´å¥½ã€‚

:::



### ä¿å­˜é˜…è¯»æ—¥æœŸ

> ä¸ä¸Šé¢˜ç±»ä¼¼ï¼Œä½†æ˜¯ä¿å­˜é˜…è¯»è®°å½•ä»¥å¤–ï¼Œè¿˜éœ€è¦ä¿å­˜æ—¥æœŸã€‚å¹¶ä¸”å®ƒåº”è¯¥åœ¨æ¶ˆæ¯è¢«åƒåœ¾å›æ”¶æ—¶ä¹Ÿè¢«ä»å†…å­˜ä¸­æ¸…é™¤ã€‚

::: details

```js
let messages = [
  {text: "Hello", from: "John"},
  {text: "How goes?", from: "John"},
  {text: "See you soon", from: "Alice"}
];

let readMap = new WeakMap();

readMap.set(messages[0], new Date());
```

:::