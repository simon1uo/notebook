---
title: 💥 JavaScript 事件
date: 2022-03-10 11:17:11
permalink: /pages/1dcfd7/
categories: 
  - ☕️ 前端
  - 🚶 基础部分
  - 👣 JavaScript
  - 🚶‍♀️ JavaScript 基础
tags: 
  - null
author: 
  name: Simon
  link: https://github.com/simon1uo
---
### 事件对象

当响应函数被调用时，浏览器每次都会将一个事件对象作为实参传递进响应函数中，这个事件对象中封装了**当前事件的相关信息**，比如：鼠标的坐标，键盘的按键，鼠标的按键，滚轮的方向；

可以在响应函数中定义一个形参，来使用事件对象（IE8 以下浏览器中事件对象没有做完实参传递，而是作为window对象的属性保存）：

🌰：

```js
元素.事件 = function(event){  
    event = event || window.event;  
};  
  
元素.事件 = function(e){  
	e = e || event;  
};  
```



### 事件冒泡

事件的冒泡指的是事件向上传导，当后代元素上的事件被触发时，将会导致其祖先元素上的**同类事件** (如：`onclick`)也会触发。

```js
window.onload = function (){
    var s1 = document.getElementById("s1");

    s1.onclick = function (){
        alert("s1");
    }

    var box1 = document.getElementById("box1");

    box1.onclick = function (){
        alert("box1");
    }


    document.body.onclick = function (){
        alert("body");
    }
    
}
```

```html
<body>
    <div id="box1">
        box1!
        <span id="s1">span!</span>
    </div>
</body>
```



事件的冒泡大部分情况下都是有益的。 如果需要取消冒泡，则需要使用事件对象来取消。
**可以将事件对象的 `cancelBubble` 设置为 `true`，即可取消冒泡**；

```js
元素.事件 = function(event){  
    event = event || window.event;  
    event.cancelBubble = true;  
};  
```



### 事件委派

指将事件**统一绑定给元素的共同的祖先元素**（如 `<li>` 对应于 `<ul>`），这样当后代元素上的事件触发时，会一直冒泡到祖先元素，从而通过祖先元素的响应函数来处理事件。

事件委派是利用了冒泡，通过委派可以减少事件绑定的次数，提高程序的性能。只绑定一次事件，即可应用到多个的元素上，即使元素是后添加的。

利用 `target`获取触发事件的对象：

```js
ul.onclick = function (){
  // 如果出发事件的对象是期望的元素，则执行，否则不执行
  if(event.target.className == "link"){
    alert("我是ul的单击响应函数");
  }
}
```



### DOM 事件

事件：可以被`JS`侦测到的行为；

+   例： 触发 `...操作`  `点击某个按钮`的响应机制；

网页上的每个元素都可以发生触发`JS`事件；



**事件三要素**：

+   事件源 / 什么元素
+   事件类型 / 什么时间
+   事件处理程序 / 触发后的操作

**执行事件的步骤**：

1.  获取事件源；
2.  注册事件 / 绑定事件；
3.  添加事件处理程序 （函数的赋值方式）：



**常见的事件** `on...`

| 事件          | 描述                         |
| :------------ | :--------------------------- |
| `onchange`    | HTML 元素改变                |
| `onclick`     | 用户点击 HTML 元素           |
| `onmouseover` | 用户在一个HTML元素上移动鼠标 |
| `onmouseout`  | 用户从一个HTML元素上移开鼠标 |
| `onkeydown`   | 用户按下键盘按键             |
| `onload`      | 浏览器已完成页面的加载       |

[JavaScript HTML DOM 事件 | 菜鸟教程 (runoob.com)](https://www.runoob.com/js/js-htmldom-events.html)



### 注册事件

给元素添加事件，称为**注册事件或者绑定事件**。
注册事件有两种方式：传统方式和方法监听注册方式：

+ 传统注册方式：利用on 开头的事件`onclick` 

  ```html
  <button onclick=“alert('hi~')”></button> 
  ```

  

  ```html
  <button id="btn">按钮</button>  
  
  <script>  
      var btn = document.getElementById("btn");  
      btn.onclick = function(){  
    
      };  
  </script>  
  ```

  特点：**注册事件的唯一性**：

  ​	同一个元素、同一个事件只能设置一个处理函数，最后注册的处理函数将会覆盖前面注册的处理函数。



+ **方法监听注册方式**：

  特点：同一个元素同一个事件**可以注册多个监听器**，**按注册顺序依次执行**；

  + 使用 `addEventListener()`：

    第一个参数是事件的**字符串**，没有 `on` ；第二个参数是回调函数，当事件触发时该函数会被调用；

  ```js
  document.getElementById("myBtn").addEventListener("click", displayDate);
  
  btn01.addEventListener("click",function(){  
  	alert(1);  
  },false);  // false 代表是否在捕获阶段触发事件
  ```

  + `attachEvent()`

    第一个参数是事件的字符串，有`on`；第二个参数是回调函数；

    这个方法也可以同时为一个事件绑定**多个处理函数**，不同的是它是后绑定先执行，执行顺序和 `addEventListener()` 相反；

    ```js
    btn01.attachEvent("onclick",function(){  
    alert(1);  
    });  
    ```

    

**注意文档的加载问题**：浏览器在加载一个页面时，是按照自上向下的顺序加载的，加载一行执行一行。如果将 JavaScript 代码编写到页面的上边，当代码执行时，页面中的 DOM 对象还没有加载，此时将会无法正常获取到 DOM 对象，导致 DOM 操作失败。解决：

+ 将 `<script>` 标签写到 `<body>` 标签以下的位置；

+ 使用 `： =  function() {}` ：

  `window.onload` 对应的**回调函数**会在整个页面加载完毕以后才执行，所以可以确保代码执行时，DOM对象已经加载完毕了。

  ```html
  <script>  
      window.onload = function(){  
          var btn = document.getElementById("btn");  
          btn.onclick = function(){  
          };  
      };  
  </script>
  ```

  