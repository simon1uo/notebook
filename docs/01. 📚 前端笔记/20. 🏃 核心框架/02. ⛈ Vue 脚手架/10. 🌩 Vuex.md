---
title: ğŸŒ© Vuex
date: 2022-04-06 14:17:24
permalink: /pages/def0ac/
categories: 
  - ğŸ“š å‰ç«¯ç¬”è®°
  - ğŸƒ æ ¸å¿ƒéƒ¨åˆ†
  - â›ˆ Vue è„šæ‰‹æ¶
tags: 
  - null
author: 
  name: Simon
  link: https://github.com/simon1uo
---
## Vuex çš„ç†è§£

+ Vuex çš„æ¦‚å¿µï¼š ä¸“é—¨åœ¨ Vue ä¸­å®ç°é›†ä¸­å¼çŠ¶æ€ï¼ˆæ•°æ®ï¼‰ç®¡ç†çš„ä¸€ä¸ª **Vue æ’ä»¶**ï¼Œå¯¹ Vue åº”ç”¨ä¸­çš„å¤šä¸ªç»„ä»¶çš„å…±äº«çŠ¶æ€è¿›è¡Œé›†ä¸­å¼çš„ç®¡ç†ï¼ˆè¯» / å†™æ“ä½œï¼‰ï¼Œä¹Ÿæ˜¯ç»„ä»¶ä¹‹é—´é€šä¿¡çš„ä¸€ç§æ–¹å¼ï¼Œå¹¶ä¸”é€‚ç”¨äº**ä»»æ„ç»„ä»¶é—´**çš„é€šä¿¡ã€‚

> ğŸ”— ç›¸å…³é“¾æ¥ï¼š
>
> + GitHubï¼š[vuejs/vuex: ğŸ—ƒï¸ Centralized State Management for Vue.js. (github.com)](https://github.com/vuejs/vuex)
> + å®˜æ–¹æ–‡æ¡£ï¼š[What is Vuex? | Vuex (vuejs.org)](https://vuex.vuejs.org/)



***

> + ä½¿ç”¨**å…¨å±€äº‹ä»¶æ€»çº¿**å®ç°å¤šç»„ä»¶å…±äº«æ•°æ®ï¼šä¸åªæ˜¯è¯»ã€è¿˜è¦å†™çš„æ“ä½œæ—¶ï¼Œå°±æ˜¾å¾—æœ‰ç‚¹ç¹æ‚ã€‚
>
> <img src="https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/hH49t0.png" alt="image-20220407112423289" style="zoom:50%;" />
>
> + ä½¿ç”¨ Vuex å¤šç»„ä»¶å…±äº«æ•°æ®ï¼šè¯»å†™å¯ä»¥åœ¨åŒå‘æ“ä½œã€‚
>
> ![image-20220407112832380](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/cToJKj.png)

+ **ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ Vuex** ï¼šå…±äº«ä¸€ä¸ªçŠ¶æ€ã€‚
  + å¤šä¸ªç»„ä»¶ä¾èµ–ä¸åŒä¸€ä¸ªçŠ¶æ€ã€‚
  + æ¥è‡ªä¸åŒçš„ç»„ä»¶çš„è¡Œä¸ºéœ€è¦å˜æ›´åŒä¸€ä¸ªçŠ¶æ€ã€‚



## Vuex åŸç†

![vuex](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/0beUlz.png)

+ **Vuex** ä¸‰ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼š
  + **Actions**ï¼šåŠ¨ä½œè¡Œä¸ºã€‚
  + **Mutations**ï¼šåŠ å·¥ç»´æŠ¤ã€‚
  + **State**ï¼šçŠ¶æ€ï¼ˆæ•°æ®ï¼‰ ï¼Œæ•°æ®äº¤ç»™ State ä¿ç®¡ï¼Œå¯ä»¥åŒ…å«è®¸å¤šæ•°æ®å…³é”®è¯ã€‚

+ å¯ä»¥åœ¨å›¾ä¸­äº†è§£ Vuex çš„å·¥ä½œæµç¨‹ã€‚

  + ä¸‰ä¸ªç»„æˆéƒ¨åˆ†å¯ä»¥çœ‹æˆæ˜¯ä¸‰ä¸ªå¯¹è±¡ä¸­å­˜å‚¨æ•°æ®ã€‚
  + Actions ä¸åç«¯æ¥å£ç›¸å…³ï¼Œå½“ç»„ä»¶è¿›è¡Œçš„åŠ¨ä½œçš„æ•°æ®éœ€è¦é€šè¿‡ AJAX è¯·æ±‚è·å–ï¼Œå³ä¸çŸ¥é“åŠ¨ä½œçš„æ•°æ®ã€‚å®é™…ä¸Šï¼Œå½“ç»„ä»¶çŸ¥é“è¿›è¡Œçš„åŠ¨ä½œå’Œæ•°æ®ï¼ŒVue ä¼šç›´æ¥ Commit åˆ° Mutationsï¼Œå³ Actions å¯ä»¥çœç•¥ã€‚

  + Mutations æ˜¯å®é™…åŠ å·¥çŠ¶æ€çš„åœ°æ–¹ã€‚
  + Vuex åŸºäº store å·¥ä½œã€‚ä¾‹å¦‚ï¼Œ`store.dispatch` ã€`store.commit`ã€`store.mutate`ï¼Œåœ¨ä»»æ„ç»„ä»¶ä¸­éƒ½èƒ½è°ƒç”¨ã€‚



## Vuex çš„ä½¿ç”¨

### Vuex çš„å¼€å‘ç¯å¢ƒ

+ å®‰è£… Vuex 3ï¼š

```
$ npm i vuex@3
```

::: tip

åœ¨ 2022 å¹´ 2 æœˆ 7 æ—¥ï¼ŒVue 3 æˆä¸ºäº†é»˜è®¤çš„ç‰ˆæœ¬ï¼ˆå³æ‰§è¡Œ `npm i vue` å®‰è£…çš„ç‰ˆæœ¬æ˜¯ Vue 3ï¼‰ï¼ŒVuex ä¹Ÿæ›´æ–°åˆ°äº† Vuex 4 ç‰ˆæœ¬ï¼Œè€Œ Vue 4 åªèƒ½åœ¨ Vue 3 ä¸­è¿è¡Œï¼ˆæ‰€ä»¥æ‰§è¡Œ `npm i vuex` å®‰è£…çš„æ˜¯ Vuex 4ï¼‰ã€‚æ‰€ä»¥ï¼Œåœ¨ç›®å‰åŸºäº Vue 2 ç‰ˆæœ¬çš„å­¦ä¹ ï¼Œæˆ‘ä»¬è¦å®‰è£…å¯ä»¥åŸºäº Vue 2 è¿è¡Œçš„ Vuex 3ã€‚

:::

+ åˆ›å»º Vuex çš„æ“ä½œæ–‡ä»¶ `src/store/index.js` ï¼š

```js
//å¼•å…¥Vueæ ¸å¿ƒåº“
import Vue from 'vue'
//å¼•å…¥Vuex
import Vuex from 'vuex'
//åº”ç”¨Vuexæ’ä»¶
Vue.use(Vuex)

//å‡†å¤‡actionså¯¹è±¡â€”â€”å“åº”ç»„ä»¶ä¸­ç”¨æˆ·çš„åŠ¨ä½œ
const actions = {}
//å‡†å¤‡mutationså¯¹è±¡â€”â€”ä¿®æ”¹stateä¸­çš„æ•°æ®
const mutations = {}
//å‡†å¤‡stateå¯¹è±¡â€”â€”ä¿å­˜å…·ä½“çš„æ•°æ®
const state = {}

//åˆ›å»ºå¹¶æš´éœ²store
export default new Vuex.Store({
	actions,
	mutations,
	state
})
```

::: tip

æ³¨æ„ï¼šç”±äº `store` çš„å¼•å…¥ä¸èƒ½æ™šäºå¼•å…¥æ’ä»¶ `Vuex` ï¼Œæ‰€ä»¥ç°åœ¨æ“ä½œæ–‡ä»¶ä¸­å¼•å…¥ `Vue` å¹¶ä¸”å¼•å…¥æ’ä»¶ `Vuex` ï¼Œç„¶ååœ¨å…¥å£æ–‡ä»¶å°±ç›´æ¥å¼•å…¥ `store` é…ç½®é¡¹å³å¯ã€‚

:::

+ åœ¨å…¥å£æ–‡ä»¶ `main.js` ä¸­åˆ›å»º `vm` å®ä¾‹æ—¶ä¼ å…¥ `store` é…ç½®é¡¹ï¼š

```js
......
//å¼•å…¥store
import store from './store'
......

//åˆ›å»ºvm
new Vue({
	el:'#app',
	render: h => h(App),
	store
})
```



### Vuex çš„åŸºæœ¬ä½¿ç”¨

+ åœ¨ `store` æ“ä½œæ–‡ä»¶ `index.js` ä¸­åˆå§‹åŒ–æ•°æ®ï¼Œé…ç½® `actions` å’Œ `mutations` çš„æ–¹æ³•ï¼š

```js
// å“åº”ç»„ä»¶ä¸­çš„åŠ¨ä½œ
const actions = {
	add(context,value){
		context.commit('ADD',value)
	},
}

// æ‰§è¡ŒåŠ¨ä½œçš„å®é™…æ“ä½œ
const mutations = {
	ADD(state,value){
		state.sum += value
	}
}

//åˆå§‹åŒ–æ•°æ®
const state = {
   sum:0
}
```

::: tip

+ `actions` ä¸­å®šä¹‰çš„æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼š

  + `context` ï¼šä¸Šä¸‹æ–‡ç›¸å…³çš„å†…å®¹ï¼Œä¸€èˆ¬æä¾›ç»™åŠ¨ä½œä¸­çš„æ–¹æ³•ä¸­æ‰€ç”¨åˆ°çš„å†…å®¹ã€‚ï¼ˆå¯ä»¥çœ‹ä½œæ˜¯ `store` çš„éƒ¨åˆ†å†…å®¹ï¼‰

    æ³¨æ„ï¼šåŒ…æ‹¬ `dispatch` ï¼šå¯ä»¥ç”¨æ¥åœ¨æ–¹æ³•ä¸­è°ƒå–åœ¨ `actions` ä¸­çš„å…¶ä»–æ–¹æ³•ã€‚å®é™…å¼€å‘ä¸­æ²¡æœ‰åƒä¾‹å­é‚£ä¹ˆç®€å•çš„ä¸šåŠ¡é€»è¾‘ï¼Œç”šè‡³å¦‚æ­¤ç®€å•çš„ä¸šåŠ¡é€»è¾‘å¯ä»¥åœ¨ç»„ä»¶ä¸­ç›´æ¥å®Œæˆï¼Œä½†æ˜¯ä¸€æ—¦æœ‰ç¹æ‚çš„ä¸šåŠ¡é€»è¾‘æ­¤æ—¶ `actions` çš„ä½œç”¨å°±æ˜¾ç°å‡ºæ¥ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ `actions` ä¸­å®šä¹‰å¤šä¸ªæ–¹æ³•åŒ…å«å¤šç§ä¸šåŠ¡é€»è¾‘æä¾›å…¶ä¸­ä¸€ä¸ªæ–¹æ³•ä½¿ç”¨ `dispatch` è°ƒå–ã€‚

  + `value` ï¼šç»„ä»¶ä¼ é€’ç»™ Vuex è¦è¿›è¡Œæ“ä½œçš„æ•°æ®ã€‚åœ¨ `actions` ä¸­å¯å¯¹æ­¤è¿›è¡Œåˆ¤æ–­ç­‰ä¸šåŠ¡é€»è¾‘ã€‚



+ `mutations` ä¸­å®šä¹‰çš„æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼š
  + `state` ï¼šæä¾›ç”¨æ¥è¯»å– `state` ä¸­çš„æ•°æ®ï¼ˆçŠ¶æ€ï¼‰ã€‚
  + `value`ï¼šç»„ä»¶ä¼ é€’ç»™ Vuex è¦è¿›è¡Œæ“ä½œçš„æ•°æ®ã€‚

+ åœ¨ `mutations` ä¸­çš„æ–¹æ³•å**å‘½åä¸€èˆ¬ä¸ºå¤§å†™**ä¸ `actions` ä¸­çš„æ–¹æ³•è¿›è¡ŒåŒºåˆ†ã€‚å¹¶ä¸”åœ¨ `mutations` ä¸­ä¸€èˆ¬ç›´æ¥æ“ä½œæ•°æ®ï¼Œè€Œä¸å†è¿‡å¤šè¿›è¡Œåˆ¤æ–­ç­‰ä¸šåŠ¡é€»è¾‘ï¼ˆä¸€èˆ¬æ”¾åœ¨ `actions` ä¸­è¿›è¡Œï¼‰ã€‚

:::

+ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ Vuex ï¼š

  + **ç»„ä»¶ä¸­è¯»å– Vuex ä¸­çš„æ•°æ®**ï¼š`$store.state.sum` ï¼ˆåœ¨æ¨¡ç‰ˆä¸­ï¼‰

  + **ç»„ä»¶ä¸­æ“ä½œ Vuex ä¸­çš„æ•°æ®**ï¼šé€šè¿‡ `dispatch`ï¼š`$store.dispatch('method', value)` æˆ–è€… `commit` ï¼š`$store.commit(â€˜methodâ€™, value)`ã€‚

    **æ³¨æ„ï¼šè‹¥åœ¨è¯¥æ“ä½œæ²¡æœ‰ç½‘ç»œè¯·æ±‚æˆ–è€…å…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œç»„ä»¶å¯ä»¥è¶Šè¿‡ `actions` çš„ `dispatch`ï¼Œç›´æ¥ä½¿ç”¨ `mutations` ä¸­ `commit`**ã€‚



### `getters` çš„ä½¿ç”¨

+ æ¦‚å¿µï¼šå½“åœ¨ `state` ä¸­çš„æ•°æ®**éœ€è¦ç»è¿‡ï¼ˆå¤æ‚ï¼‰åŠ å·¥ä¹‹åä½¿ç”¨**ï¼Œå¯ä»¥ä½¿ç”¨ `getters` åŠ å·¥ã€‚ï¼ˆåœ¨ç»„ä»¶ä¸­çš„è®¡ç®—å±æ€§ `computed` åªèƒ½æä¾›åœ¨ç›®å‰ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œä¸èƒ½å…±äº«ç»™å…¶ä»–ç»„ä»¶å¤ç”¨ï¼‰

+ åœ¨ `store` æ“ä½œæ–‡ä»¶ `index.js` ä¸­è¿½åŠ é…ç½® `getters`ï¼Œæ³¨æ„è¦è¿½åŠ åˆ°æš´éœ²é¡¹ä¸­ï¼š

```js
const getters = {
	bigSum(state){
		return state.sum * 10
	}
}

//åˆ›å»ºå¹¶æš´éœ²store
export default new Vuex.Store({
	......
	getters
})
```

+ åœ¨ç»„ä»¶ä¸­è¯»å–åŠ å·¥åçš„æ•°æ®ï¼š`$store.getters.bigSum`ã€‚



### å››ä¸ª `map` æ–¹æ³•çš„ä½¿ç”¨

å½“åˆå§‹åŒ–çš„æ•°æ®è¾ƒå¤šï¼Œåœ¨ç»„ä»¶ä¸­çš„æ¨¡ç‰ˆè¯­æ³•ä½¿ç”¨è¿‡é•¿çš„ä»£ç è¯­å¥è·å–åœ¨ Vuex çš„æ•°æ®ä¸å¤ªå¥½ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§ `computed` è·å–ã€‚

ğŸŒ° ä¾‹å­ï¼šä½¿ç”¨è®¡ç®—å±æ€§è·å– Vuex ä¸­çš„æ•°æ®ï¼š

::: details

```js
computed: {
  sum() {
    return this.$store.state.sum
  },
  school() {
    return this.$store.state.school
  },
  subject() {
    return this.$store.state.subject
  },
  bigSum() {
    return this.$store.getters.bigSum
  }
}
```

:::

å¯ä»¥çœ‹å‡ºåœ¨è®¡ç®—å±æ€§ä¸­æœ‰ç›¸åŒéƒ¨åˆ†çš„ä»£ç ï¼Œéƒ½æ˜¯ä» `state` æˆ–è€… `getter` ä¸­è·å–æ•°æ®ï¼Œæ‰€ä»¥ Vuex æä¾›äº†ç”Ÿæˆ `state` æˆ–è€… `getters` è®¡ç®—å±æ€§çš„æ–¹æ³• `mapState` å’Œ `mapGetters` ã€‚ 

+ `mapState` æ–¹æ³•ï¼šå¯ä»¥æ˜ å°„ `state` çš„æ•°æ®ä¸ºè®¡ç®—å±æ€§ï¼š

```js
computed: {
    //å€ŸåŠ©mapStateç”Ÿæˆè®¡ç®—å±æ€§ï¼šsumã€schoolã€subjectï¼ˆå¯¹è±¡å†™æ³•ï¼‰
     ...mapState({sum:'sum',school:'school',subject:'subject'}),
         
    //å€ŸåŠ©mapStateç”Ÿæˆè®¡ç®—å±æ€§ï¼šsumã€schoolã€subjectï¼ˆæ•°ç»„å†™æ³•ï¼‰
    ...mapState(['sum','school','subject']),
},
```



+ `mapGetters` æ–¹æ³•ï¼šå¯ä»¥æ˜ å°„ `getters` çš„æ•°æ®ä¸ºè®¡ç®—å±æ€§ï¼š

```js
computed: {
    //å€ŸåŠ©mapGettersç”Ÿæˆè®¡ç®—å±æ€§ï¼šbigSumï¼ˆå¯¹è±¡å†™æ³•ï¼‰
    ...mapGetters({bigSum:'bigSum'}),

    //å€ŸåŠ©mapGettersç”Ÿæˆè®¡ç®—å±æ€§ï¼šbigSumï¼ˆæ•°ç»„å†™æ³•ï¼‰
    ...mapGetters(['bigSum'])
},
```



ğŸŒ° ä½¿ç”¨åŸå§‹æ–¹æ³•ä¸ Vuex ä¸­çš„ `actions ` å¯¹è¯ï¼š

::: details

```js
methods: {
  increment() {
    this.$store.commit('ADD', this.n)
  },
  decrement() {
    this.$store.commit('SUB', this.n)
  },
  incrementOdd() {
    this.$store.dispatch('addOdd', this.n)
  },
  incrementWait() {
    this.$store.dispatch('addWait', this.n)
  }
},
```

:::

ä¸ä¸Šé¢ä¸¤ä¸ª `map` æ–¹æ³•ç±»ä¼¼ï¼ŒVuex æä¾›äº†å¸®åŠ©ç”Ÿæˆ `actions` å’Œ `mutations` å¯¹è¯çš„æ–¹æ³• `mapActions` å’Œ `mapMutations`ã€‚

+ `mapActions` æ–¹æ³•ï¼šç”¨äºå¸®åŠ©**ç”Ÿæˆä¸ `actions` å¯¹è¯**çš„æ–¹æ³•ï¼ŒåŒ…å« `$store.dispatch(xxx)` çš„å‡½æ•°ï¼š

```js
methods:{
  //é mapActionsç”Ÿæˆï¼šincrementOddã€incrementWaitï¼ˆå¯¹è±¡å½¢å¼ï¼‰ 
  ...mapActions({incrementOdd: 'addOdd', incrementWait: 'addWait'}),
    
  //é mapActionsç”Ÿæˆï¼šincrementOddã€incrementWaitï¼ˆæ•°ç»„å½¢å¼ï¼‰
  ...mapActions(['addOdd', 'addWait'])
}
```

+ `mapMutations` ï¼šç”¨äºå¸®åŠ©**ç”Ÿæˆä¸ `mutations` å¯¹è¯**çš„æ–¹æ³•ï¼ŒåŒ…å« `$store.commit(xxx)` çš„å‡½æ•°ï¼š

```js
methods:{
  //é mapActionsç”Ÿæˆï¼šincrementã€decrementï¼ˆå¯¹è±¡å½¢å¼ï¼‰
  ...mapMutations({increment: 'ADD', decrement: 'SUB'}), 
   
  //é mapMutationsç”Ÿæˆï¼šJIAã€JIANï¼ˆå¯¹è±¡å½¢å¼ï¼‰
  ...mapMutations(['ADD','SUB'])
}
```

::: warning

ä½¿ç”¨**æ•°ç»„æ³•**ç”Ÿæˆï¼Œè¦æ±‚äº‹ä»¶åä¸åœ¨ `actions` æˆ–è€… `mutations` ä¸­çš„æ–¹æ³•åç§°ç›¸åŒï¼Œå³åœ¨æ¨¡æ¿ä¸­è¦ä½¿ç”¨åœ¨ `actions` æˆ–è€… `mutations` ä¸­çš„æ–¹æ³•åç§°ã€‚

:::



::: warning

æ­¤æ—¶ `mapActions` ä¸ `mapMutations` å¸®æˆ‘ä»¬ç”Ÿæˆçš„å¯¹è±¡æ–¹æ³•ç›¸å½“äºï¼š

```js
increment(value) {
  this.$store.commit('ADD', value)
}
```

è¯´æ˜è¦ä¼ é€’å‚æ•°åˆ° `actions` æˆ–è€… `mutations` ä¸­çš„æ–¹æ³•ä¸­ï¼Œ**éœ€è¦åœ¨æ¨¡ç‰ˆä¸­ç»‘å®šäº‹ä»¶æ—¶å°±ä¼ é€’å¥½å‚æ•°**ï¼Œå¦åˆ™å‚æ•°æ˜¯äº‹ä»¶å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š`<button @click="increment(n)">+</button>`ã€‚

:::



::: tip

çœŸå®ä¾é è®¡ç®—å±æ€§è·å–ä¸ä½¿ç”¨ `map` è·å–åœ¨ Vue å¼€å‘è€…å·¥å…·ä¸­çš„åŒºåˆ«ï¼š

![image-20220407162402333](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/vqCj10.png)

:::



## Vuex çš„ä½¿ç”¨æ¡ˆä¾‹



### ğŸŒ° ä½¿ç”¨ Vuex å®ç°æ±‚å’Œæ¡ˆä¾‹

åœ¨ `store` æ“ä½œæ–‡ä»¶ `index.js` ä¸­ï¼š

+ åˆå§‹åŒ–æ•°æ®ï¼Œå‡†å¤‡ç”¨äºæ“ä½œçš„æ•°æ® `state` ï¼š

```js
const state = {
    sum: 0 // å½“å‰æ±‚å’Œçš„ç»“æœ
}
```

+ å‡†å¤‡ç”¨äºå“åº”ç»„ä»¶ä¸­çš„åŠ¨ä½œ `actions` ï¼š

```js
const actions = {
    add(context, value) {
        context.commit('ADD', value)
    },
    sub(context, value) {
        context.commit('SUB', value)
    },
    addOdd(context, value) {
        if (context.state.sum % 2) {
            context.commit('ADD', value) 
        }
    },
    addWait(context, value) {
        setTimeout(() => {
            context.commit('ADD', value) 
        }, 500)
    },
}
```

+ å‡†å¤‡æ“ä½œï¼ˆåŠ å·¥ï¼‰æ•°æ®ï¼ˆçŠ¶æ€ï¼‰çš„ `mutations`ï¼š

```js
const mutations = {
    ADD(state, value) {
        state.sum += value
    },
    SUB(state, value) {
        state.sum -= value
    }
}
```



åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ Vuex ï¼š

+ è¯»å– Vuex ä¸­çš„æ•°æ®ï¼š

```vue
<h1>å½“å‰çš„æ±‚å’Œä¸ºï¼š {{$store.state.sum}}</h1>
```

+ æ“ä½œ Vuex ä¸­çš„æ•°æ®ï¼š

```js
methods: {
  increment() {
    this.$store.dispatch('add', this.n)
  },
  decrement() {
    this.$store.dispatch('sub', this.n)
  },
  incrementOdd() {
    this.$store.dispatch('addOdd', this.n)
  },
  incrementWait() {
    this.$store.dispatch('addWait', this.n)
  }
},
```

æ³¨ï¼š`n` ä¸ºå®šä¹‰ç”¨æ¥é€‰æ‹©é€’å¢çš„æ•°å­—ã€‚



::: tip

å¯¹ä¸Šè¿°æ”¹è¿›ï¼Œå¯ä»¥çœ‹å‡ºåœ¨ `actions` ä¸­çš„ `add` å’Œ `sub` æ–¹æ³•å¹¶æ²¡æœ‰å…¶ä»–çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ‰€ä»¥åœ¨ç»„ä»¶ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ `commit` ç›´æ¥è¶Šè¿‡ `actioins`ï¼š

```js
methods: {
  increment() {
      this.$store.commit('ADD', this.n)
  },
  decrement() {
    this.$store.commit('SUB', this.n)
  }
}
```

:::



### ğŸŒ° å¤šç»„ä»¶å…±äº«æ•°æ®

é™¤äº†ç¬¬ä¸€ä¸ªä¾‹å­çš„ `Count` ç»„ä»¶ä»¥å¤–ï¼Œæ–°åŠ ä¸€ä¸ªç»„ä»¶ `Person` ï¼Œä½¿ç”¨ Vuex å…±äº«ä¸¤ä¸ªç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨çš„æ•°æ®ã€‚

è¯¦ç»†æ­¥éª¤ä¸èµ˜è¿°ï¼Œå…¶å®ä¸åŒç»„ä»¶è·å– Vuex ä¸­çš„æ•°æ®éƒ½å¯å¯ä»¥ä½¿ç”¨æ™®é€šæ–¹æ³•æˆ–è€… `map` æ–¹æ³•ï¼Œä»è€Œå®ç°å…±äº«æ•°æ®ã€‚



## Vuex çš„æ¨¡å—åŒ–ç¼–ç 

+ å½“å¤šä¸ªç»„ä»¶åŒæ—¶ä½¿ç”¨ Vuex å®ç°å…±äº«æ•°æ®å¹¶ä¸”æ“ä½œæ•°æ®æ—¶ï¼Œæ­¤æ—¶çš„ `store` æ–‡ä»¶å…¶å®ã€Œä¸å ªé‡è´Ÿã€ï¼Œåœ¨ `actions` å’Œ `mutations` ä¸­çš„æ–¹æ³•ç¹æ‚èµ·æ¥ï¼Œä¸åŒç»„ä»¶æ“ä½œä¸åŒçš„æ–¹æ³•ï¼Œé€ æˆç¼–ç æ··ä¹±å’Œç‰ˆæœ¬ç®¡ç†å›°éš¾ã€‚

+ ä½¿ç”¨æ¨¡å—åŒ–ç¼–ç çš„ç›®çš„ï¼šè®©ä»£ç æ›´å¥½ç»´æŠ¤ï¼Œ**è®©å¤šç§æ•°æ®åˆ†ç±»æ›´åŠ æ˜ç¡®**ã€‚



ğŸŒ° å°†ä¸Šè¿°çš„ Vuex ä¾‹å­è¿›è¡Œæ¨¡å—åŒ–ç¼–ç ï¼Œ

+ ä¿®æ”¹ Vuex `store.js` ï¼Œåˆ†å‰²ä¸ºå¦‚ä¸‹æ–‡ä»¶ï¼š

  + `countOptions.js`

  + `personOptions.js`

```js
export default {
  namespaced:true,//å¼€å¯å‘½åç©ºé—´
  state:{ ... },
  mutations: { ... },
  actions: { ... },
  getters: { ... }
}
```

> æ³¨æ„ï¼šå¼€å¯å‘½åç©ºé—´æ‰èƒ½åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å¦‚ `countOptions` çš„å‘½åã€‚

ç„¶ååœ¨ `store.js` æš´éœ²æ—¶ï¼Œä½¿ç”¨ `modules` åŒ…å«ä»¥ä¸Šçš„æ¨¡å—ï¼š

```js
export default new Vuex.Store({
    modules: {
        countOptions,
        personOptions
    }
})
```



+ åœ¨ç»„ä»¶ä¸­ï¼Œä½¿ç”¨æ¨¡å—åŒ–ç¼–ç åï¼š

è¯»å– `state` æ•°æ®ï¼š

```js
//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥è¯»å–
this.$store.state.personOptions.personlist

//æ–¹å¼äºŒï¼šå€ŸåŠ©mapStateè¯»å–ï¼š
...mapState('countOptions',['sum','school','subject']),
```



è¯»å– `getters` æ•°æ®ï¼š

```js
//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥è¯»å–
this.$store.getters['personOptions/firstPersonName']

//æ–¹å¼äºŒï¼šå€ŸåŠ©mapGettersè¯»å–ï¼š
...mapGetters('countOptions',['bigSum'])
```

> æ³¨æ„ï¼š `$store.getters` ä¸ `state` ä¸åŒã€‚



è°ƒç”¨ `dispatch` ï¼š

```js
//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥dispatch
this.$store.dispatch('personAbout/addPersonWang',person)

//æ–¹å¼äºŒï¼šå€ŸåŠ©mapActionsï¼š
...mapActions('countOptions',{incrementOdd:'addOdd',incrementWait:'addWait'})
```



è°ƒç”¨ `commit`ï¼š

```js
//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥commit
this.$store.commit('personOptions/ADD_PERSON',person)

//æ–¹å¼äºŒï¼šå€ŸåŠ©mapMutationsï¼š
...mapMutations('countOptions',{increment:'ADD',decrement:'SUB'}),
```

