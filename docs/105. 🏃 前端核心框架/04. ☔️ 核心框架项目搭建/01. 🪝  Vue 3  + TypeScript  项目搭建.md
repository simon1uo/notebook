---
title:  ğŸª  Vue 3  + TypeScript  é¡¹ç›®æ­å»º
date: 2022-04-28 11:14:31
permalink: /pages/bb1311/
categories:
  -  ğŸ“š å‰ç«¯ç¬”è®°
  -  â›½ï¸ é¡¹ç›®ç›¸å…³
tags:
  - 
author: 
  name: Simon
  link: https://github.com/simon1uo
---
åˆ›å»º Vue è„šæ‰‹æ¶æ—¶é€‰æ‹©çš„ featueï¼š

+ Babel
+ TypeScript
+ Vuex
+ CSS é¢„å¤„ç†å™¨
+ è¯­æ³•æ£€æŸ¥

<img src="https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/vCbVVO.png" alt="image-20220428111752017" style="zoom:33%;" />



<img src="https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/xKfWMb.png" alt="image-20220428112237499" style="zoom:33%;" />



## ä»£ç è§„èŒƒ



### `.editorconfig` é…ç½®

EditorConfig æœ‰åŠ©äºä¸ºä¸åŒ IDE ç¼–è¾‘å™¨ä¸Šå¤„ç†åŒä¸€é¡¹ç›®çš„å¤šä¸ªå¼€å‘äººå‘˜ç»´æŠ¤ä¸€è‡´çš„ç¼–ç é£æ ¼ã€‚

```
# http://editorconfig.org

root = true

[*] # è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶é€‚ç”¨
charset = utf-8 # è®¾ç½®æ–‡ä»¶å­—ç¬¦é›†ä¸º utf-8
indent_style = space # ç¼©è¿›é£æ ¼ï¼ˆtab | spaceï¼‰
indent_size = 2 # ç¼©è¿›å¤§å°
end_of_line = lf # æ§åˆ¶æ¢è¡Œç±»å‹(lf | cr | crlf)
trim_trailing_whitespace = true # å»é™¤è¡Œé¦–çš„ä»»æ„ç©ºç™½å­—ç¬¦
insert_final_newline = true # å§‹ç»ˆåœ¨æ–‡ä»¶æœ«å°¾æ’å…¥ä¸€ä¸ªæ–°è¡Œ

[*.md] # è¡¨ç¤ºä»… md æ–‡ä»¶é€‚ç”¨ä»¥ä¸‹è§„åˆ™
max_line_length = off
trim_trailing_whitespace = false
```



### Prettier å·¥å…·

> Prettier æ˜¯ä¸€æ¬¾å¼ºå¤§çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æŒ JavaScriptã€TypeScriptã€CSSã€SCSSã€Lessã€JSXã€Angularã€Vueã€GraphQLã€JSONã€Markdown ç­‰è¯­è¨€ï¼ŒåŸºæœ¬ä¸Šå‰ç«¯èƒ½ç”¨åˆ°çš„æ–‡ä»¶æ ¼å¼å®ƒéƒ½å¯ä»¥æå®šï¼Œæ˜¯å½“ä¸‹**æœ€æµè¡Œçš„ä»£ç æ ¼å¼åŒ–**å·¥å…·ã€‚

+ å®‰è£… prettier

```shell
npm install prettier -D
```

+ é…ç½® `.prettierrc` æ–‡ä»¶ï¼š

  * `useTabs`ï¼šä½¿ç”¨tabç¼©è¿›è¿˜æ˜¯ç©ºæ ¼ç¼©è¿›ï¼Œé€‰æ‹©falseï¼›

  * `tabWidth`ï¼štabæ˜¯ç©ºæ ¼çš„æƒ…å†µä¸‹ï¼Œæ˜¯å‡ ä¸ªç©ºæ ¼ï¼Œé€‰æ‹©2ä¸ªï¼›

  * `printWidth`ï¼šå½“è¡Œå­—ç¬¦çš„é•¿åº¦ï¼Œæ¨è80ï¼Œä¹Ÿæœ‰äººå–œæ¬¢100æˆ–è€…120ï¼›

  * `singleQuote`ï¼šä½¿ç”¨å•å¼•å·è¿˜æ˜¯åŒå¼•å·ï¼Œé€‰æ‹© `true`ï¼Œä½¿ç”¨å•å¼•å·ï¼›

  * `trailingComma`ï¼šåœ¨å¤šè¡Œè¾“å…¥çš„å°¾é€—å·æ˜¯å¦æ·»åŠ ï¼Œè®¾ç½®ä¸º `none`ï¼›

  * `semi`ï¼šè¯­å¥æœ«å°¾æ˜¯å¦è¦åŠ åˆ†å·ï¼Œé»˜è®¤å€¼ `true`ï¼Œé€‰æ‹© `false` è¡¨ç¤ºä¸åŠ ï¼›

```
{
  "useTabs": false,
  "tabWidth": 2,
  "printWidth": 80,
  "singleQuote": true,
  "trailingComma": "none",
  "semi": false
}
```

+ åˆ›å»º `.prettierignore` å¿½ç•¥æ–‡ä»¶ï¼š

```
/dist/*
.local
.output.js
/node_modules/**

**/*.svg
**/*.sh

/public/*
```

+ æµ‹è¯•prettieræ˜¯å¦ç”Ÿæ•ˆ

  * æµ‹è¯•ä¸€ï¼šåœ¨ä»£ç ä¸­ä¿å­˜ä»£ç ï¼›

  * æµ‹è¯•äºŒï¼šé…ç½®ä¸€æ¬¡æ€§ä¿®æ”¹çš„å‘½ä»¤ï¼›


åœ¨ `package.json` ä¸­é…ç½®ä¸€ä¸ª `scripts` ï¼š

```json
    "prettier": "prettier --write ."
```

<img src="https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/QQaf6K.png" alt="image-20220428113828750" style="zoom:50%;" />



### ä½¿ç”¨ ESLint æ£€æµ‹ä»£ç è§„èŒƒ

åœ¨å‰é¢åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œå°±é€‰æ‹©äº† ESLint ï¼Œæ‰€ä»¥Vueä¼šé»˜è®¤å¸®åŠ©æˆ‘ä»¬é…ç½®éœ€è¦çš„ ESLint ç¯å¢ƒã€‚

+ è§£å†³ eslint å’Œ prettier å†²çªçš„é—®é¢˜ï¼š
+ å®‰è£…æ’ä»¶ï¼šï¼ˆvueåœ¨åˆ›å»ºé¡¹ç›®æ—¶ï¼Œå¦‚æœé€‰æ‹© prettier + ESlintï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ’ä»¶ä¼šè‡ªåŠ¨å®‰è£…ï¼‰

```shell
npm i eslint-plugin-prettier eslint-config-prettier -D
```

åœ¨ `eslintrc.js` ä¸­æ·»åŠ  prettier æ’ä»¶ï¼š

```json
  extends: [
    "plugin:vue/vue3-essential",
    "eslint:recommended",
    "@vue/typescript/recommended",
    "@vue/prettier",
    "@vue/prettier/@typescript-eslint",
    'plugin:prettier/recommended' // æ·»åŠ 
  ],
```



### Before commit ä»£ç è§„èŒƒ / husky ä½¿ç”¨

è™½ç„¶æˆ‘ä»¬å·²ç»è¦æ±‚é¡¹ç›®ä½¿ç”¨ eslint äº†ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯ç»„å‘˜æäº¤ä»£ç ä¹‹å‰éƒ½å°† eslint ä¸­çš„é—®é¢˜è§£å†³æ‰äº†ï¼š

* **ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸Œæœ›ä¿è¯ä»£ç ä»“åº“ä¸­çš„ä»£ç éƒ½æ˜¯ç¬¦åˆ eslint è§„èŒƒçš„ï¼›**

* **é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ç»„å‘˜æ‰§è¡Œ  `git commit `  å‘½ä»¤çš„æ—¶å€™å¯¹å…¶è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœä¸ç¬¦åˆeslintè§„èŒƒï¼Œé‚£ä¹ˆè‡ªåŠ¨é€šè¿‡è§„èŒƒè¿›è¡Œä¿®å¤**ï¼›

é‚£ä¹ˆå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿå¯ä»¥é€šè¿‡ Husky å·¥å…·ï¼š

* husky æ˜¯ä¸€ä¸ª git hook å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§¦å‘ git æäº¤çš„å„ä¸ªé˜¶æ®µï¼špre-commitã€commit-msgã€pre-pushã€‚

è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåŠ¨é…ç½®å‘½ä»¤ï¼š

```shell
npx husky-init && npm install
```

![image-20220428114752669](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/BbkIwy.png)



::: details

è¿™é‡Œä¼šåšä¸‰ä»¶äº‹ï¼š

+ å®‰è£…huskyç›¸å…³çš„ä¾èµ–ï¼š

![image-20210723112648927](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/M2TttE.jpg)

+ åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º `.husky` æ–‡ä»¶å¤¹ï¼š

```
npx huksy install
```



![image-20210723112719634](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/nvD6wZ.jpg)

+ åœ¨package.jsonä¸­æ·»åŠ ä¸€ä¸ªè„šæœ¬ï¼š

![image-20210723112817691](https://tva1.sinaimg.cn/large/008i3skNgy1gsqq26phpxj30dj06fgm3.jpg)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å»å®Œæˆä¸€ä¸ªæ“ä½œï¼šåœ¨è¿›è¡Œ commit æ—¶ï¼Œæ‰§è¡Œ lint è„šæœ¬ï¼š

![image-20210723112932943](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/A5MB18.jpg)

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰§è¡Œ `git commit` çš„æ—¶å€™ä¼šè‡ªåŠ¨å¯¹ä»£ç è¿›è¡Œ lint æ ¡éªŒã€‚

::: 



### Git Commit è§„èŒƒ

#### ä»£ç æäº¤é£æ ¼

é€šå¸¸æˆ‘ä»¬çš„ git commit ä¼šæŒ‰ç…§ç»Ÿä¸€çš„é£æ ¼æ¥æäº¤ï¼Œè¿™æ ·å¯ä»¥å¿«é€Ÿå®šä½æ¯æ¬¡æäº¤çš„å†…å®¹ï¼Œ**æ–¹ä¾¿ä¹‹åå¯¹ç‰ˆæœ¬è¿›è¡Œæ§åˆ¶**ã€‚

ä½†æ˜¯å¦‚æœæ¯æ¬¡æ‰‹åŠ¨æ¥ç¼–å†™è¿™äº›æ˜¯æ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·¥å…·ï¼š**Commitizen**ï¼ˆCommitizen æ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬ç¼–å†™è§„èŒƒ commit message çš„å·¥å…·ï¼‰ã€‚

+ å®‰è£… Commitizen

  ```shell
  npm install commitizen -D
  ```

+ å®‰è£… cz-conventional-changelogï¼Œå¹¶ä¸”åˆå§‹åŒ– cz-conventional-changelogï¼š

  ```shell
  npx commitizen init cz-conventional-changelog --save-dev --save-exact
  ```

  è¿™ä¸ªå‘½ä»¤ä¼šå¸®åŠ©æˆ‘ä»¬å®‰è£…cz-conventional-changelogï¼š

  ![image-20210723145249096](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/ZhEDex.jpg)

  å¹¶ä¸”åœ¨ `package.json` ä¸­è¿›è¡Œé…ç½®ï¼š

  ```json
  "config": {
    "commitizen": {
      "path": "./node_mudules/cz-conventional-changelog"
    }
  }
  ```

  

**é…ç½®å®Œ Commitizen åï¼Œæäº¤ä»£ç éœ€è¦ä½¿ç”¨ `npx cz`**ï¼š

+ é€‰æ‹© typeï¼š

| Type     | ä½œç”¨                                                         |
| -------- | ------------------------------------------------------------ |
| feat     | æ–°å¢ç‰¹æ€§ (feature)                                           |
| fix      | ä¿®å¤ Bug(bug fix)                                            |
| docs     | ä¿®æ”¹æ–‡æ¡£ (documentation)                                     |
| style    | ä»£ç æ ¼å¼ä¿®æ”¹(white-space, formatting, missing semi colons, etc) |
| refactor | ä»£ç é‡æ„(refactor)                                           |
| perf     | æ”¹å–„æ€§èƒ½(A code change that improves performance)            |
| test     | æµ‹è¯•(when adding missing tests)                              |
| build    | å˜æ›´é¡¹ç›®æ„å»ºæˆ–å¤–éƒ¨ä¾èµ–ï¼ˆä¾‹å¦‚ scopes: webpackã€gulpã€npm ç­‰ï¼‰ |
| ci       | æ›´æ”¹æŒç»­é›†æˆè½¯ä»¶çš„é…ç½®æ–‡ä»¶å’Œ package ä¸­çš„ scripts å‘½ä»¤ï¼Œä¾‹å¦‚ scopes: Travis, Circle ç­‰ |
| chore    | å˜æ›´æ„å»ºæµç¨‹æˆ–è¾…åŠ©å·¥å…·(æ¯”å¦‚æ›´æ”¹æµ‹è¯•ç¯å¢ƒ)                     |
| revert   | ä»£ç å›é€€                                                     |

::: details

* ç¬¬äºŒæ­¥é€‰æ‹©æœ¬æ¬¡ä¿®æ”¹çš„èŒƒå›´ï¼ˆä½œç”¨åŸŸï¼‰

![image-20210723150147510](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/tdlPnm.jpg)

* ç¬¬ä¸‰æ­¥é€‰æ‹©æäº¤çš„ä¿¡æ¯

![image-20210723150204780](https://tva1.sinaimg.cn/large/008i3skNgy1gsqw8mq3zlj60ni01hmx402.jpg)

* ç¬¬å››æ­¥æäº¤è¯¦ç»†çš„æè¿°ä¿¡æ¯

![image-20210723150223287](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/y3P6Yc.jpg)

* ç¬¬äº”æ­¥æ˜¯å¦æ˜¯ä¸€æ¬¡é‡å¤§çš„æ›´æ”¹

![image-20210723150322122](https://tva1.sinaimg.cn/large/008i3skNgy1gsqw9z5vbij30bm00q744.jpg)

* ç¬¬å…­æ­¥æ˜¯å¦å½±å“æŸä¸ªopen issue

![image-20210723150407822](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/2xUjyK.jpg)

:::

æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ scripts ä¸­æ„å»ºä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œ czï¼š

![image-20210723150526211](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/lOOE8k.jpg)



#### ä»£ç æäº¤éªŒè¯

å¦‚æœæˆ‘ä»¬æŒ‰ç…§ cz æ¥è§„èŒƒäº†æäº¤é£æ ¼ï¼Œä½†æ˜¯ä¾ç„¶æœ‰åŒäº‹é€šè¿‡ `git commit` æŒ‰ç…§ä¸è§„èŒƒçš„æ ¼å¼æäº¤åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ

- æˆ‘ä»¬å¯ä»¥é€šè¿‡ commitlint æ¥é™åˆ¶æäº¤ï¼›

å®‰è£… @commitlint/config-conventional å’Œ @commitlint/cli

```
npm i @commitlint/config-conventional @commitlint/cli -D
```

åœ¨æ ¹ç›®å½•åˆ›å»º commitlint.config.js æ–‡ä»¶ï¼Œé…ç½® commitlint

```
module.exports = {
  extends: ['@commitlint/config-conventional']
}
```

ä½¿ç”¨ husky ç”Ÿæˆcommit-msgæ–‡ä»¶ï¼ŒéªŒè¯æäº¤ä¿¡æ¯ï¼š

```
npx husky add .husky/commit-msg "npx --no-install commitlint --edit $1"
```

ï¼ˆæ‹¦æˆªæäº¤ï¼‰



## ç¬¬ä¸‰æ–¹åº“é›†æˆ

### vue.config.js é…ç½®

vue.config.js æœ‰ä¸‰ç§é…ç½®æ–¹å¼ï¼š

* æ–¹å¼ä¸€ï¼š**ç›´æ¥é€šè¿‡ CLI æä¾›ç»™æˆ‘ä»¬çš„é€‰é¡¹æ¥é…ç½®**ï¼š
  * æ¯”å¦‚ publicPathï¼šé…ç½®åº”ç”¨ç¨‹åºéƒ¨ç½²çš„å­ç›®å½•ï¼ˆé»˜è®¤æ˜¯ `/`ï¼Œç›¸å½“äºéƒ¨ç½²åœ¨ `https://www.my-app.com/`ï¼‰ï¼›
  * æ¯”å¦‚ outputDirï¼šä¿®æ”¹è¾“å‡ºçš„æ–‡ä»¶å¤¹ï¼›
* æ–¹å¼äºŒï¼šé€šè¿‡ configureWebpack ä¿®æ”¹ webpack çš„é…ç½®ï¼š
  * å¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œ**ç›´æ¥ä¼šè¢«åˆå¹¶**ï¼›
  * å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šæ¥æ”¶ä¸€ä¸ª configï¼Œå¯ä»¥é€šè¿‡ config æ¥ä¿®æ”¹é…ç½®ï¼›
* æ–¹å¼ä¸‰ï¼šé€šè¿‡ chainWebpack ä¿®æ”¹ webpack çš„é…ç½®ï¼š
  * æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šæ¥æ”¶ä¸€ä¸ªåŸºäº  [webpack-chain](https://github.com/mozilla-neutrino/webpack-chain) çš„configå¯¹è±¡ï¼Œå¯ä»¥å¯¹é…ç½®è¿›è¡Œä¿®æ”¹ï¼›

### vue-routeré›†æˆ

å®‰è£… vue-router çš„æœ€æ–°ç‰ˆæœ¬ï¼š

```shell
npm install vue-router@next
```

åˆ›å»º router å¯¹è±¡ï¼ˆ`router/main.js`ï¼‰ï¼š

```typescript
import { createRouter, createWebHashHistory } from 'vue-router'
import { RouteRecordRaw } from 'vue-router' // çº¦æŸroutesçš„ç±»å‹

const routes: RouteRecordRaw[] = [
  {
    path: '/',
    redirect: '/main'
  },
  {
    path: '/main',
    component: () => import('../views/main/main.vue')
  },
  {
    path: '/login',
    component: () => import('../views/login/login.vue')
  }
]

const router = createRouter({
  routes,
  history: createWebHashHistory()
})

export default router
```

å®‰è£… routerï¼ˆ`main.ts` ï¼‰ï¼š

```typescript
import router from './router'

createApp(App).use(router).mount('#app')
```

åœ¨ `App.vue` ä¸­é…ç½®è·³è½¬ï¼š

```html
<template>
  <div id="app">
    <router-link to="/login">ç™»å½•</router-link>
    <router-link to="/main">é¦–é¡µ</router-link>
    <router-view></router-view>
  </div>
</template>
```



### vuexé›†æˆ

å®‰è£…æœ€æ–°ç‰ˆ vuexï¼š

```
npm install vuex@next
```

åˆ›å»ºstoreå¯¹è±¡ï¼š

```typescript
import { createStore } from 'vuex'

const store = createStore({
  state() {
    return {
      name: 'coderwhy'
    }
  }
})

export default store
```

å®‰è£…storeï¼š

```typescript
createApp(App).use(router).use(store).mount('#app')
```

åœ¨App.vueä¸­ä½¿ç”¨ï¼š

```html
<h2>{{ $store.state.name }}</h2>
```



### element-plusé›†æˆ

Element Plusï¼Œæ¡Œé¢ç«¯ç»„ä»¶åº“

* ç›¸ä¿¡å¾ˆå¤šåŒå­¦åœ¨ Vue2 ä¸­éƒ½ä½¿ç”¨è¿‡ element-uiï¼Œè€Œ element-plus æ­£æ˜¯ element-ui é’ˆå¯¹äº Vue3 å¼€å‘çš„ä¸€ä¸ª UI ç»„ä»¶åº“ï¼›
* å®ƒçš„ä½¿ç”¨æ–¹å¼å’Œå¾ˆå¤šå…¶ä»–çš„ç»„ä»¶åº“æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å­¦ä¼š element-plusï¼Œå…¶ä»–ç±»ä¼¼äº ant-design-vueã€NaiveUIã€VantUI éƒ½æ˜¯å·®ä¸å¤šçš„ï¼›

å®‰è£…element-plus

```shell
$ npm install element-plus
```

#### å…¨å±€å¼•å…¥

ä¸€ç§å¼•å…¥ element-plus çš„æ–¹å¼æ˜¯å…¨å±€å¼•å…¥ï¼Œä»£è¡¨çš„å«ä¹‰æ˜¯æ‰€æœ‰çš„ç»„ä»¶å’Œæ’ä»¶éƒ½ä¼šè¢«è‡ªåŠ¨æ³¨å†Œï¼š

```js
import ElementPlus from 'element-plus'
import 'element-plus/lib/theme-chalk/index.css'

import router from './router'
import store from './store'

createApp(App).use(router).use(store).use(ElementPlus).mount('#app')
```



#### å±€éƒ¨å¼•å…¥

ä½¿ç”¨ `unplugin-vue-components` å®ç°æŒ‰éœ€å¼•å…¥ï¼š

+ å®‰è£… `unplugin-vue-components` ï¼š

```
npm i unplugin-vue-components unplugin-auto-import -D
```

+ `vue.config.js`ï¼ˆè¿™é‡Œæ˜¯ Vue-CLI sé…ç½®æ–¹æ³•ï¼Œå…¶ä»–è„šæ‰‹æ¶éœ€è¦å‚è€ƒæ–‡æ¡£ï¼‰

  ```javascript
  const AutoImport = require('unplugin-auto-import/webpack')
  const Components = require('unplugin-vue-components/webpack')
  const { ElementPlusResolver } = require('unplugin-vue-components/resolvers')
  
  module.exports = {
      configureWebpack: {
        plugins: [
          AutoImport({
            resolvers: [ElementPlusResolver()],
          }),
          Components({
            resolvers: [ElementPlusResolver()],
          }),
        ],
      }
  }
  ```

+ ç„¶ååœ¨ `main.ts` å…¨å±€æ³¨å†Œç»„ä»¶ï¼š

  ```typescript
  import {
    ElButton,
    ElTable,
    ElAlert,
    ElAside,
    ElAutocomplete,
    ElAvatar,
    ElBacktop,
    ElBadge,
  } from 'element-plus'
  import 'element-plus/dist/index.css'
  
  const app = createApp(App)
  
  const components = [
    ElButton,
    ElTable,
    ElAlert,
    ElAside,
    ElAutocomplete,
    ElAvatar,
    ElBacktop,
    ElBadge
  ]
  
  for (const cpn of components) {
    app.component(cpn.name, cpn)
  }
  ```
  
  

from: [å®ç°è‡ªåŠ¨å¼•å…¥+æŒ‰éœ€å¼•å…¥element-plusåŸæ¥å¦‚æ­¤ç®€å• - SegmentFault æ€å¦](https://segmentfault.com/a/1190000041116726)

ï¼ˆåœ¨é `<template>` ä¸­ä½¿ç”¨ç»„ä»¶ä»ç„¶éœ€è¦æ‰‹åŠ¨å¼•å…¥ï¼‰

ï¼ˆæœ€æ–°å¼•å…¥è¿˜æ˜¯å¾—çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œç‰¹åˆ«æ˜¯å¼•å…¥ CSS åŒ…ï¼Œä¸€æ—¦æ‰¾ä¸åˆ°æ ·å¼å°±æ²¡æœ‰æ•ˆæœã€‚æ‰¾ bug éƒ½å¿«æ€€ç–‘äººç”Ÿäº†ï¼‰

::: details 

+ å®‰è£… `webpack-bundle-analyzer` çœ‹æ‰“åŒ…ä¿¡æ¯ï¼š

```shell
$ npm install --save-dev webpack-bundle-analyzer
```

```shell
npm run build --report
```

ä¸ç”¨åšä»»ä½•é…ç½®ï¼Œå°±å¯ä»¥çœ‹åˆ°ç»ˆç«¯æ‰“å°å‡ºæ¥æ‰“åŒ…åå„æ–‡ä»¶å¤§å°ã€‚

å¦‚æœæƒ³çœ‹è¯¦ç»†çš„æ‰“åŒ…åæ–‡ä»¶çš„ä¿¡æ¯ï¼Œå¯ä»¥åœ¨`vue.config.js`ä¸­åšå¦‚ä¸‹é…ç½®ï¼š

```java
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

module.exports = {
    configureWebpack: {
        plugins: [
            new BundleAnalyzerPlugin()
        ]
    }
}
```

ç„¶åæ‰“å¼€åœ°å€`http://127.0.0.1:8888`å°±å¯ä»¥äº†ã€‚
æ®æˆ‘ä¸ªäººæµ‹è¯•ï¼Œå®Œæ•´å¼•å…¥æ—¶ï¼Œæ‰“åŒ…å`chunk.js`æ–‡ä»¶å¤§å°ä¸º`400k`å·¦å³ã€‚æŒ‰éœ€å¼•å…¥åï¼Œæ‰“åŒ…å`chunk.js`æ–‡ä»¶å¤§å°ä¸º`200k`å·¦å³ã€‚

:::



é™„åŠ å†…å®¹ï¼šVue-CLI **ç¯å¢ƒå˜é‡**

### axios é›†æˆ

å®‰è£…axiosï¼š

```shell
npm install axios
```

å°è£…axiosï¼š

```ts
import axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios'
import { Result } from './types'
import { useUserStore } from '/@/store/modules/user'

class HYRequest {
  private instance: AxiosInstance

  private readonly options: AxiosRequestConfig

  constructor(options: AxiosRequestConfig) {
    this.options = options
    this.instance = axios.create(options)

    this.instance.interceptors.request.use(
      (config) => {
        const token = useUserStore().getToken
        if (token) {
          config.headers.Authorization = `Bearer ${token}`
        }
        return config
      },
      (err) => {
        return err
      }
    )

    this.instance.interceptors.response.use(
      (res) => {
        // æ‹¦æˆªå“åº”çš„æ•°æ®
        if (res.data.code === 0) {
          return res.data.data
        }
        return res.data
      },
      (err) => {
        return err
      }
    )
  }

  request<T = any>(config: AxiosRequestConfig): Promise<T> {
    return new Promise((resolve, reject) => {
      this.instance
        .request<any, AxiosResponse<Result<T>>>(config)
        .then((res) => {
          resolve((res as unknown) as Promise<T>)
        })
        .catch((err) => {
          reject(err)
        })
    })
  }

  get<T = any>(config: AxiosRequestConfig): Promise<T> {
    return this.request({ ...config, method: 'GET' })
  }

  post<T = any>(config: AxiosRequestConfig): Promise<T> {
    return this.request({ ...config, method: 'POST' })
  }

  patch<T = any>(config: AxiosRequestConfig): Promise<T> {
    return this.request({ ...config, method: 'PATCH' })
  }

  delete<T = any>(config: AxiosRequestConfig): Promise<T> {
    return this.request({ ...config, method: 'DELETE' })
  }
}

export default HYRequest
```



## `tsconfig.json`

[tsconfig.json Â· TypeScriptä¸­æ–‡ç½‘ Â· TypeScriptâ€”â€”JavaScriptçš„è¶…é›† (tslang.cn)](https://www.tslang.cn/docs/handbook/tsconfig-json.html)

```json
{
  // ç¼–è¯‘é…ç½®
  "compilerOptions": {
    // ç›®æ ‡ä»£ç 
    "target": "esnext",
    // ç›®æ ‡ä»£ç è¦ä½¿ç”¨çš„æ¨¡å—åŒ–æ–¹æ¡ˆ
    "module": "esnext",
    // å¼€å¯ä¸¥æ ¼æ¨¡å¼
    "strict": true,
    // jsxè¿›è¡Œæ€æ ·çš„å¤„ç†
    "jsx": "preserve",
    // è¾…åŠ©å¯¼å…¥åŠŸèƒ½
    "importHelpers": true,
    // æŒ‰ç…§nodeè§£ææ¨¡å—
    "moduleResolution": "node",
    // è·³è¿‡ä¸€äº›ç¬¬ä¸‰æ–¹åº“çš„ç±»å‹ç›‘æµ‹ï¼ˆaxios/loadashï¼‰
    "skipLibCheck": true,
    // esModuleå’ŒcommonJSæ··åˆä½¿ç”¨
    // export defalt / module.exports = {}
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    // ç”Ÿæˆæ˜ å°„æ–‡ä»¶ ï¼ˆts=>jsï¼‰
    "sourceMap": true,
		// æ–‡ä»¶è·¯å¾„è§£ææ—¶åŸºæœ¬è·¯å¾„
    "baseUrl": ".",
    // æŒ‡å®šå…·ä½“è¦è§£æä½¿ç”¨çš„ç±»å‹ webpack
    "types": ["webpack-env"],
    // è·¯å¾„è§£æåŒ¹é…ï¼ˆç±»ä¼¼webpack aliasï¼‰
    "paths": {
      "@/*": ["src/*"]
    },
    // å¯ä»¥æŒ‡å®šåœ¨é¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨å“ªäº›åº“çš„ç±»å‹(Proxy/window/Document)
    "lib": ["esnext", "dom", "dom.iterable", "scripthost"]
  },
  // è¦è§£æçš„æ–‡ä»¶åç¼€å
  "include": [
    "src/**/*.ts",
    "src/**/*.tsx",
    "src/**/*.vue",
    "tests/**/*.ts",
    "tests/**/*.tsx"
  ],
  // æ’é™¤çš„æ–‡ä»¶
  "exclude": ["node_modules"]
}
```



## `shims-vue.d.ts`

ç±»å‹å£°æ˜ï¼š

```typescript
/* eslint-disable */
declare module '*.vue' {
  import type { DefineComponent } from 'vue'
  const component: DefineComponent<{}, {}, any>
  export default component
}
```

> è§„èŒƒã€é™åˆ¶ç»„ä»¶ä¸­é…ç½®ä¼ å…¥çš„ç±»å‹ã€‚`preps` ã€ `setup()`â€¦ã€‚
