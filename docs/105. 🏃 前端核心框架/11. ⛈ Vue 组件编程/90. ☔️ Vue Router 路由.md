---
title: â˜”ï¸ Vue Router è·¯ç”±
date: 2022-04-07 23:45:48
permalink: /pages/c2ae57/
categories: 
  - ğŸ“š å‰ç«¯ç¬”è®°
  - ğŸƒ æ ¸å¿ƒéƒ¨åˆ†
  - â›ˆ Vue è„šæ‰‹æ¶
tags: 
  - Vue
author: 
  name: Simon
  link: https://github.com/simon1uo
---



åº”ç”¨ç†è§£ï¼šè¦å®ç° SPAï¼ˆSingle Page Web Applicationï¼‰ **å•é¡µé¢ç½‘é¡µåº”ç”¨**ï¼ˆæ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå®Œæ•´çš„é¡µé¢ï¼‰ï¼Œåœ¨å¯¼èˆªå»ç‚¹å‡»å¯¼èˆªé“¾æ¥åˆ‡æ¢ä¸åŒçš„å†…å®¹å±•ç¤ºï¼Œä½†é¡µé¢ä¸ä¼šæ•´ä½“åˆ·æ–°ï¼Œåªä¼šåšé¡µé¢çš„å±€éƒ¨åˆ·æ–°ï¼Œæ•°æ®éœ€è¦ AJAX è¯·æ±‚è·å–ã€‚è·¯ç”±å™¨ç›‘æµ‹åœ°å€è·¯å¾„å‘ç”Ÿå˜åŒ–ï¼ŒæŒ‰ç…§è·¯ç”±è§„åˆ™å¼•å¯¼åˆ°ç›¸åº”çš„å†…å®¹ã€‚

+ **è·¯ç”±ä¸è·¯ç”±å™¨çš„ç†è§£**ï¼š
  + ä¸€ä¸ª**è·¯ç”±ï¼ˆRouteï¼‰**å°±æ˜¯**ä¸€ç»„æ˜ å°„å…³ç³»**ï¼ˆ`key-value` å¯¹åº”å…³ç³»ï¼Œ `key` æ˜¯è·¯å¾„ï¼Œ `value` æ˜¯ `function` æˆ–è€… `component` ã€‚ï¼‰
  + å¤šä¸ªè·¯ç”±éœ€è¦**è·¯ç”±å™¨ï¼ˆRouterï¼‰** è¿›è¡Œç®¡ç†ã€‚

+ **è·¯ç”±çš„åˆ†ç±»**ï¼š

  + **å‰ç«¯è·¯ç”±**ï¼š`value` ä¸º `component` ï¼Œç”¨äºå±•ç¤ºé¡µé¢å†…å®¹ã€‚å·¥ä½œè¿‡ç¨‹ï¼š**å½“æµè§ˆå™¨è·¯å¾„æ”¹å˜æ—¶ï¼Œå¯¹åº”çš„ç»„ä»¶å°±ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ã€‚** **æ‰€ä»¥è¦ä½¿ç”¨è·¯ç”±çš„å‰ææ˜¯ï¼Œå±•ç¤ºçš„ä¸åŒå†…å®¹åŒºåˆ†ä¸ºä¸åŒçš„ç»„ä»¶ã€‚**

  + åç«¯è·¯ç”±ï¼š`value` ä¸º `function` ï¼Œç”¨äºå¤„ç†å®¢æˆ·ç«¯æäº¤çš„è¯·æ±‚ã€‚å·¥ä½œè¿‡ç¨‹ï¼šæœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œæ ¹æ®è¯·æ±‚è·¯å¾„æ‰¾åˆ°åŒ¹é…çš„å‡½æ•°æ¥å¤„ç†è¯·æ±‚ï¼Œè¿”å›å“åº”æ•°æ®ã€‚



## è·¯ç”±çš„åŸºæœ¬ä½¿ç”¨

+ å®‰è£… `vue-router` ï¼š

```
$ npm i vue-router@3
```

> 2022 å¹´ 2 æœˆ 7 æ—¥ä»¥åï¼Œ vue-router çš„é»˜è®¤ç‰ˆæœ¬ä¸º vue-router 4ï¼Œå¹¶ä¸” vue-router 4 åªèƒ½åœ¨ Vue 3 ä¸‹è¿è¡Œã€‚æ‰€ä»¥ï¼Œåœ¨åŸºäº Vue 2 çš„å­¦ä¹ ä¸­å¯ä»¥å®‰è£… vue-router 3ã€‚

+ ç¼–å†™è·¯ç”±æ–‡ä»¶ `src/router/index.js` ï¼š

```js
// è¯¥æ–‡ä»¶ä¸“é—¨ç”¨äºåˆ›å»ºæ•´ä¸ªåº”ç”¨çš„è·¯ç”±å™¨
// å¼•å…¥VueRouter
import VueRouter from "vue-router"
// å¼•å…¥è·¯ç”±ç»„ä»¶

// åˆ›å»ºå¹¶æš´éœ²ä¸€ä¸ªè·¯ç”±å™¨
export default new VueRouter({
    routes: [
        {
        	path: '',
        	component: ,
        } 
    ]
})
```

+ åœ¨å…¥å£æ–‡ä»¶ `main.js` ä¸­å¼•å…¥ `router` ï¼Œåº”ç”¨æ’ä»¶ï¼š

```js
...
// å¼•å…¥VueRouter
import VueRouter from "vue-router"
// å¼•å…¥è·¯ç”±å™¨
import router from './router'

...

// åº”ç”¨æ’ä»¶
Vue.use(VueRouter)

new Vue({
    el: '#app',
    render: h => h(app),
    router: router
})
```



### ç®€å•çš„è·¯ç”±æ¡ˆä¾‹

![image-20220408115540976](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/8X4qDg.png)

+ åœ¨ `App` ç»„ä»¶ä¸­ï¼Œå®ç°å¯¼èˆªæ çš„åˆ‡æ¢ï¼š**ä½¿ç”¨ `router-link` æ ‡ç­¾**ï¼Œå¯ä»¥å®ç°ç±»ä¼¼ `<a> ` æ ‡ç­¾çš„é¡µé¢è·³è½¬åŠŸèƒ½ã€‚

```vue
<div class="list-group">
  <!--åŸå§‹HTMLä¸­ä½¿ç”¨aæ ‡ç­¾å®ç°é¡µé¢çš„è·³è½¬-->
  <!-- <a class="list-group-item" href="./about.html">About</a>
       <a class="list-group-item active" href="./home.html">Home</a>-->
  <!--Vueä¸­å€ŸåŠ©router-linkæ ‡ç­¾å®ç°ç±»ä¼¼aæ ‡ç­¾çš„è·¯ç”±åˆ‡æ¢-->
  <router-link class="list-group-item" active-class="active" to="/about">about</router-link>
  <router-link class="list-group-item" active-class="active" to="/home">home</router-link>
</div>
```

> æ ·å¼åŒæ ·ä½¿ç”¨ `class` å±æ€§é…ç½®ç›¸åº”çš„æ ·å¼ï¼Œå¹¶ä¸”**é«˜äº®æ ·å¼å¯ä»¥ä½¿ç”¨ `active-class` é…ç½®**ã€‚ 



+ åœ¨æŒ‡å®šä½ç½®å±•ç¤ºæŒ‡å®šçš„è·¯ç”±ç»„ä»¶å†…å®¹ï¼š**ä½¿ç”¨ `<router-view>` æ ‡ç­¾ã€‚**

```vue
<div class="panel-body">
  <!--åˆ¶å®šç»„ä»¶çš„å‘ˆç°ä½ç½®-->
  <router-view></router-view>
</div>
```



### è·¯ç”±ä½¿ç”¨çš„å‡ ä¸ªæ³¨æ„ç‚¹

+ **è·¯ç”±ç»„ä»¶**ï¼ˆé€šè¿‡è·¯ç”±å±•ç¤ºé¡µé¢çš„å†…å®¹ï¼‰é€šå¸¸å­˜æ”¾åœ¨ `pages` æ–‡ä»¶å¤¹ï¼Œ**ä¸€èˆ¬ç»„ä»¶**ï¼ˆæ™®é€šé€šè¿‡æ ‡ç­¾å¼•å…¥ç»„ä»¶çš„å†…å®¹ï¼‰é€šå¸¸å­˜æ”¾åœ¨ `components` æ–‡ä»¶å¤¹ã€‚

+ å½“åˆ‡æ¢è·¯ç”±ç»„ä»¶æ—¶ï¼Œã€Œè¢«éšè—ã€ï¼ˆè¢«åˆ‡èµ°ï¼‰çš„è·¯ç”±ç»„ä»¶ï¼Œ**é»˜è®¤æ˜¯è¢«é”€æ¯çš„ï¼Œéœ€è¦çš„æ—¶å€™æ‰ä¼šå»æŒ‚è½½ã€‚**

  <img src="https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/V5JAdQ.png" alt="image-20220408141550134" style="zoom: 50%;" />

> ä¸¤ä¸ªè·¯ç”±ç»„ä»¶çš„ç»„ä»¶å®ä¾‹éƒ½æœ‰ `$route` ï¼Œä½†æ˜¯é‡Œé¢çš„è·¯ç”±å†…å®¹åªä¸ç›®å‰çš„è·¯ç”±ç»„ä»¶ç›¸å…³ï¼›å¦å¤–éƒ½æœ‰åŒä¸€ä¸ª `$router`ã€‚
>
> <img src="https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/sVBRyA.png" alt="image-20220408142128011" style="zoom:50%;" /> 

+ æ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„ `$route` å±æ€§ï¼Œå­˜å‚¨è‡ªå·±çš„è·¯ç”±ä¿¡æ¯ã€‚
+ æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ª `$router` ï¼Œå¯ä»¥é€šè¿‡ç»„ä»¶çš„ `$router` å±æ€§è·å–ã€‚



## å¤šçº§è·¯ç”±ï¼ˆåµŒå¥—è·¯ç”±ï¼‰

### åµŒå¥—è·¯ç”±æ¡ˆä¾‹

![image-20220408160744950](https://cdn.jsdelivr.net/gh/simon1uo/image-flow@master/image/eUmTS7.png)

åœ¨ `Home` ç»„ä»¶ä¸­å®ç°å†…å®¹ç”±ä¸åŒçš„ç»„ä»¶å‘ˆç°ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨åµŒå¥—è·¯ç”±ã€‚

+ é…ç½®è·¯ç”±è§„åˆ™ï¼Œ**ä½¿ç”¨ `children` é…ç½®é¡¹é…ç½®åµŒå¥—è·¯ç”±**ï¼š

```js
routes: [
    {
        path: '/about',
        component: About
    },
    {
        path: '/home',
        component: Home,
        children: [
            {
                path: 'message',
                component: Message
            },
            {
                path: 'news',
                component: News
            },
        ]
    }
]
```

::: warning

ä¸ä¸€çº§è·¯ç”±çš„è·¯å¾„å†™æ³•ä¸åŒï¼Œåœ¨å¤šçº§è·¯ç”±ä¸­çš„ `path` è·¯å¾„é…ç½®é¡¹ä¸­ï¼Œä¸å¿…å†åœ¨è·¯å¾„å‰é¢æ·»åŠ  `/` ï¼Œå› ä¸º `children` ä¸‹çš„é…ç½®é»˜è®¤ä¸ºä¸Šä¸€çº§è·¯ç”±çš„å­çº§è·¯ç”±ã€‚ 

:::

+ åœ¨ç»„ä»¶ä¸­åŒæ ·é€‚ç”¨ `router-link` å®Œæˆè·¯ç”±è·³è½¬ï¼Œæ³¨æ„ `to` å±æ€§çš„è·¯å¾„è¦å†™å®Œæ•´çš„è·¯å¾„ï¼Œå¦åˆ™æ— æ³•åŒ¹é…ã€‚

```vue
<ul class="nav nav-tabs">
  <li>
    <router-link class="list-group-item" active-class="active" to="/home/news">News</router-link>
  </li>
  <li>
    <router-link class="list-group-item" active-class="active" to="/home/message">Message</router-link>
  </li>
</ul>
```



## è·¯ç”±çš„æ›´å¤šé…ç½®

### è·¯ç”±ä¼ å‚

#### `query` ä¼ å‚

é€šè¿‡ `router-link` ç»™ç›®æ ‡ç»„ä»¶ä¼ é€’å‚æ•°æ—¶å¯ä»¥ä½¿ç”¨ `query` ä¼ é€’ã€‚

ğŸŒ° ä½¿ç”¨ `query` ä¼ é€’å‚æ•°çš„ä¾‹å­ï¼š

+ ä¼ é€’å‚æ•°ï¼š

```vue
<li v-for="message in messageList" :key="message.id">
  <!--è·³è½¬è·¯ç”±å¹¶ä¸”æºå¸¦queryå‚æ•°ï¼Œtoçš„å­—ç¬¦ä¸²å†™æ³•-->
  <!--<router-link :to="`/home/message/detail?id=${message.id}&title=${message.title}`"> {{ message.title }}</router-link>-->

  <!--è·³è½¬è·¯ç”±å¹¶ä¸”æºå¸¦queryå‚æ•°ï¼Œtoçš„å¯¹è±¡å†™æ³•-->
  <router-link :to="{
    path: '/home/message/detail',
    query: {
      id: message.id,
      title: message.title
    }
  }"> {{ message.title }}</router-link>
</li>
```

> `router-link` æ ‡ç­¾ä¸­çš„ `to` æœ‰ä¸¤ç§å†™æ³•ï¼Œå­—ç¬¦ä¸²å½¢å¼ï¼ˆç”±äºè¦ä¼ å…¥å‚æ•°æ‰€ä»¥è¦ä½¿ç”¨ ` `` ` ç¬¦å·åŒ…è£¹ ï¼‰è¿‡äºç¹çå¯ä»¥ä½¿ç”¨å¯¹è±¡å½¢å¼ï¼ˆæ³¨æ„è¦ä½¿ç”¨å¯¹è±¡å½¢å¼ï¼Œå¿…é¡»ä½¿å­—ç¬¦ä¸²å†…ä¸ºè¡¨è¾¾å¼ï¼Œæ‰€ä»¥å±æ€§åä¸º `:to` ï¼‰ï¼Œä¼ é€’åˆ°ç›®æ ‡ç»„ä»¶çš„ `$route` ä¸­ã€‚

+ æ¥æ”¶å‚æ•°ï¼š

```vue
<ul>
  <li>æ¶ˆæ¯ç¼–å· {{ $route.query.id }}</li>
  <li>æ¶ˆæ¯æ ‡é¢˜ {{ $route.query.title }}</li>
</ul>
```



#### `params` ä¼ å‚

é€šè¿‡ `router-link` ä¼ é€’å‚æ•°çš„ä¸åŒäº `query` çš„å†™æ³•ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰çš„å¦ä¸€ç§ä¼ é€’å‚æ•°æ–¹æ³•ã€‚ä½¿ç”¨æ–¹æ³•ï¼šè¦ç°åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ä¸­å£°æ˜ä¼ é€’çš„å‚æ•°åœ¨è·¯å¾„ä¸­çš„æ ¼å¼ï¼Œç„¶åæ‰èƒ½åœ¨è·¯ç”±è·¯å¾„ä¸­åŒ¹é…å‡ºå¯¹åº”çš„å‚æ•°ï¼ˆæˆ–è€…ç›´æ¥ä½¿ç”¨å¯¹è±¡æŒ‡å®šåç§°ä¼ é€’ï¼‰ã€‚**ä¸€èˆ¬ç›´æ¥ç”¨äºç®€åŒ–å­—ç¬¦ä¸²å½¢å¼**ã€‚

ğŸŒ°ï¼šä½¿ç”¨ `params` ä¼ é€’å‚æ•°çš„ä¾‹å­ï¼š

+ é…ç½®è·¯ç”±æ–‡ä»¶çš„ `Detail` ç›¸å…³çš„è·¯ç”±ï¼š

```js
... 
{
    path: 'message', // å­çº§è·¯ç”±ä¸ç”¨æ–œæ 
    component: Message,
    children: [
        {
            name: 'detail',
            path: 'detail/:id/:title',
            component: Detail
        }
    ]
},
...
```

+ ä¼ é€’å‚æ•°ï¼š

```vue
<li v-for="message in messageList" :key="message.id">
  <!--è·³è½¬è·¯ç”±å¹¶ä¸”æºå¸¦paramså‚æ•°ï¼Œtoçš„å­—ç¬¦ä¸²å†™æ³•-->
  <router-link :to="`/home/message/detail/${message.id}/${message.title}`"> {{ message.title }}</router-link>

  <!--è·³è½¬è·¯ç”±å¹¶ä¸”æºå¸¦paramså‚æ•°ï¼Œtoçš„å¯¹è±¡å†™æ³•-->
  <router-link :to="{
    name: 'detail',
    params:{
      id: message.id,
      title: message.title
    }
  }"> {{ message.title }}
  </router-link>
</li>
```

> ä½¿ç”¨ `params` ä¼ é€’å‚æ•°æ—¶ï¼Œ`to` çš„å¯¹è±¡å†™æ³•**ä¸€å®šè¦ä½¿ç”¨ `name` é…ç½®é¡¹**ï¼Œä¸èƒ½ä½¿ç”¨ `path` é…ç½®é¡¹ã€‚

+ æ¥æ”¶å‚æ•°ï¼š

```vue
<ul>
  <li>æ¶ˆæ¯ç¼–å· {{ $route.params.id }}</li>
  <li>æ¶ˆæ¯æ ‡é¢˜ {{ $route.params.title }}</li>
</ul>
```

 

### å‘½åè·¯ç”±

å°†è·¯ç”±è¯­ä¹‰åŒ–çš„é…ç½® `name` ï¼Œå¯ä»¥ç®€åŒ–è·³è½¬çš„è·¯å¾„ï¼Œæ³¨**æ„åªèƒ½ä½¿ç”¨å¯¹è±¡å½¢å¼çš„ `name` é…ç½®å‘½å**ï¼Œä¸èƒ½ç”¨äºç®€åŒ–å½¢å¼ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œç®€åŒ–å½¢å¼é»˜è®¤å€¼ç»™çš„æ˜¯ `path` é…ç½®ã€‚

ğŸŒ° ï¼šä½¿ç”¨å‘½åè·¯ç”±çš„ä¾‹å­ï¼š

+ åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ä¸­ï¼Œç»™ç›¸å…³çš„è·¯ç”±å‘½åï¼š

```js
routes: [
    {
        name: 'about',
        path: '/about',
        component: About
    },
    {
        name: 'home',
        path: '/home',
        component: Home,
    }
]
```

+ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ `router-link` é…ç½® `:to` å±æ€§æ—¶ï¼š

```vue
<router-link class="list-group-item" active-class="active" :to="{ name: 'About' }">about</router-link>
```

> ä¸€èˆ¬ç”¨äºè·¯ç”±è·¯å¾„è¾ƒé•¿çš„æƒ…å†µã€‚ä¾‹å¦‚ä¸Šè¿°ä¾‹å­è·¯ç”±è·¯å¾„è¾ƒçŸ­å¯ä»¥ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²å½¢å¼çš„è·¯ç”±è·¯å¾„å³å¯ã€‚

### `props` é…ç½®

å‰é¢ä½¿ç”¨ `params` æˆ–è€… `query` ä¼ é€’å‚æ•°åœ¨æ¥æ”¶å‚æ•°æ—¶ï¼Œéƒ½æ˜¯ç›´æ¥åœ¨æ¨¡ç‰ˆä¸­ä½¿ç”¨ `$route` ç›´æ¥è¯»å–ã€‚`props` é…ç½®å¯ä»¥è®©è·¯ç”±ç»„ä»¶æ›´åŠ æ–¹ä¾¿åœ°æ¥æ”¶åˆ°å‚æ•°ã€‚

ğŸŒ° ä½¿ç”¨ `props` ä¼ é€’å‚æ•°æ—¶ï¼š

+ åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ä¸­åœ¨**è¦æ¥æ”¶å‚æ•°çš„ç»„ä»¶è·¯ç”±**é…ç½® `props` ï¼Œæœ‰ä¸‰ç§å†™æ³•ï¼š

```js
...
{
    name: 'detail',
    path: 'detail/:id/:title',
    component: Detail,

    // 1 propsä¸­å€¼ä¸ºå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­çš„æ‰€æœ‰key-valueéƒ½ä¼šä»¥propsä¼ ç»™Detailç»„ä»¶ä¸­çš„$route.props
    // props: {a: 1, b: hello}

    // 2 å€¼ä¸ºå¸ƒå°”å€¼ï¼Œè‹¥å¸ƒå°”å€¼ä¸ºçœŸå°±ä¼šæŠŠè·¯ç”±ç»„ä»¶æ”¶åˆ°çš„æ‰€æœ‰paramså‚æ•°ï¼Œä»¥propsçš„å½¢å¼ä¼ é€ç»™Detailç»„ä»¶ï¼ˆåªèƒ½é€‚ç”¨paramsä¼ å‚ï¼‰
    // props: true

    // 3 propså€¼ä¸ºå‡½æ•°ï¼Œè¯¥å¯¹è±¡ä¸­çš„æ‰€æœ‰key-valueéƒ½ä¼šä»¥propsä¼ ç»™Detailç»„ä»¶
    props($route) {
        return {
            id: $route.params.id,
            title: $route.params.title
        }
    }
   /*props({query: id,title}) {
        return { id, title }
    }*/
}
```

+ ä¼ é€’å‚æ•°æ—¶å¯ä»¥ä½¿ç”¨ `query` æˆ–è€… `params` é…ç½®ã€‚
+ æ¥æ”¶å‚æ•°æ—¶ï¼Œå…ˆä½¿ç”¨ `props` æ¥æ”¶ï¼Œç„¶åå†åœ¨æ¨¡ç‰ˆä¸­ç®€åŒ–ä½¿ç”¨ã€‚

```js
props: ['id', 'title']
```

```vue
<ul>
  <li>æ¶ˆæ¯ç¼–å· {{ id }}</li>
  <li>æ¶ˆæ¯æ ‡é¢˜ {{ title }}</li>
</ul>
```



### `replace` å±æ€§

ä½œç”¨ï¼š**æ§åˆ¶è·¯ç”±è·³è½¬æ—¶æ“ä½œæµè§ˆå™¨å†å²è®°å½•çš„æ¨¡å¼**ã€‚

> æµè§ˆå™¨çš„å†å²è®°å½•æœ‰ä¸¤ç§å†™å…¥æ–¹å¼ï¼š
>
> + `push` ï¼šè¿½åŠ å†å²è®°å½•ï¼›
> + `replace`ï¼š**æ›¿æ¢**å½“å‰è®°å½•ï¼Œå‰é¢çš„è®°å½•ä¸ä¼šå—åˆ°å½±å“ã€‚
>
> è·¯ç”±è·³è½¬æ—¶é»˜è®¤ä¸º `push` æ–¹å¼ã€‚



ä½¿ç”¨ï¼šåœ¨ `<router-link>` ä¸­æ·»åŠ  `replace` å±æ€§ï¼Œä¿®æ”¹æµè§ˆå™¨çš„å†å²è®°å½•å†™å…¥æ–¹å¼ã€‚

```vue
<router-link replace .......>News</router-link>
```

> `:replace=â€œtrueâ€` ç®€å†™ä¸º `replace`ã€‚



### ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª

ä½œç”¨ï¼šä¸å€ŸåŠ© `<router-link>` å®ç°è·¯ç”±çš„è·³è½¬ï¼Œè®©è·¯ç”±è·³è½¬æ›´åŠ çµæ´»ã€‚ï¼ˆå½“æœ€ç»ˆæ ·å¼ä¸ä¸º `<a>` æ ‡ç­¾ï¼Œä¸ºå…¶ä»–çš„æ ‡ç­¾æ ·å¼æˆ–è€…å­˜åœ¨å…¶ä»–åŠŸèƒ½ï¼‰ä¸»è¦ä½¿ç”¨ `$router`  ä¸­çš„ APIã€‚

ğŸŒ° ä½¿ç”¨ `$router` å®ç° `push`ã€`replace`ã€`back`ã€`forward` è·³è½¬çš„ä¾‹å­ï¼š

+ åœ¨ç»„ä»¶ä¸­ï¼Œè·³è½¬å¹¶ä¸”ä¼ é€’å‚æ•°ï¼Œæ›¿æ¢æ‰ä¹‹å‰ä½¿ç”¨çš„ `router-link` æ ‡ç­¾ã€‚

```js
methods: {
  pushShow(message) {
    this.$router.push({
      name: 'detail',
      params:{
        id: message.id,
        title: message.title
      }
    })
  },
  replaceShow(message) {
    this.$router.replace({
      name: 'detail',
      params:{
        id: message.id,
        title: message.title
      }
    })
  }
}
```



+ ä½¿ç”¨ä¸¤ä¸ªæŒ‰é’®å®ç°é¡µé¢çš„å‰è¿›å’Œåé€€ï¼Œæˆ–è€…å‰è¿›æˆ–è€…åé€€æŒ‡å®šçš„æ­¥æ•°ã€‚

```js
methods: {
  back() {
    this.$router.back()
  },
  forward() {
    this.$router.forward()
  },
  go(){
    this.$router.go(-2) // å‚æ•°ä¸ºæ­¥æ•°
  }
}
```



### ç¼“å­˜è·¯ç”±ç»„ä»¶

ä½œç”¨ï¼šè®©ä¸å±•ç¤ºçš„è·¯ç”±ç»„ä»¶ä¿æŒæŒ‚è½½ï¼Œä¸è¢«é”€æ¯ã€‚

ä½¿ç”¨ï¼šä½¿ç”¨ `<keep alive>` åŒ…è£¹è¦ä¿ç•™çš„è·¯ç”±è§†å›¾ã€‚å±æ€§ `include` æŒ‡å®šè¦ä¿ç•™çš„**ç»„ä»¶åç§°**ã€‚ 

```vue
<keep-alive include="News">
  <router-view/>
</keep-alive>
```

```vue
<keep-alive :include="['News','Message']">
  <router-view/>
</keep-alive>
```



### è·¯ç”±ç”Ÿå‘½å‘¨æœŸé’©å­

1. ä½œç”¨ï¼šè·¯ç”±ç»„ä»¶æ‰€ç‹¬æœ‰çš„ä¸¤ä¸ªé’©å­ï¼Œ**ç”¨äºæ•è·è·¯ç”±ç»„ä»¶çš„æ¿€æ´»çŠ¶æ€**ã€‚
2. å…·ä½“åå­—ï¼š
   1. ```activated``` è·¯ç”±ç»„ä»¶è¢«æ¿€æ´»æ—¶è§¦å‘ã€‚
   2. ```deactivated ```è·¯ç”±ç»„ä»¶å¤±æ´»æ—¶è§¦å‘ã€‚



ğŸŒ° ä¾‹å­ï¼š

```js
activated() {
  console.log('Newsç»„ä»¶è¢«æ¿€æ´»')
  this.timer = setInterval(() => {
    // console.log('@')
    this.opacity -= 0.01
    if (this.opacity <= 0) this.opacity = 1
  }, 16)
},
deactivated() {
  console.log('Newsç»„ä»¶å¤±æ´»äº†')
  clearInterval(this.timer)
}
```



### è·¯ç”±å®ˆå«

1. ä½œç”¨ï¼šå¯¹è·¯ç”±è¿›è¡Œ**æƒé™æ§åˆ¶**ã€‚
2. åˆ†ç±»ï¼šå…¨å±€å®ˆå«ã€ç‹¬äº«å®ˆå«ã€ç»„ä»¶å†…å®ˆå«ã€‚





ğŸŒ° å…¨å±€å®ˆå«çš„ä¾‹å­ï¼š

+ **å…¨å±€å‰ç½®å®ˆå«ï¼šåˆå§‹åŒ–æ‰§è¡Œã€æ¯æ¬¡è·¯ç”±åˆ‡æ¢å‰æ‰§è¡Œ**ï¼š

```js
router.beforeEach((to, from, next) => {
  console.log('@', to, from)
  if(to.meta.isAuth) {
    if (localStorage.getItem('name') === 'simon') {
      next()
    } else {
      alert('æ²¡æœ‰æƒé™')
      }
  } else {
    next()
  }
})
```

+ åœ¨è¦ä½¿ç”¨æƒé™åˆ¤æ–­çš„ç»„ä»¶è·¯ç”±é…ç½®ä¸­æ·»åŠ æ–°çš„é…ç½® `meta` å­˜å‚¨ç›¸å…³çš„å±æ€§ï¼Œå¦‚ `isAuth`ï¼Œå½“ `isAuth` ä¸º `true` æ—¶è¡¨ç¤ºéœ€è¦è¿›è¡Œæƒé™åˆ¤æ–­ï¼š

```js
{
    name: 'Message',
    path: 'message',
    component: Message,
    meta: {isAuth: true, title:'æ¶ˆæ¯'},
}
```



+ **åç½®è·¯ç”±å®ˆå«ï¼šåˆå§‹åŒ–æ‰§è¡Œã€æ¯æ¬¡è·¯ç”±åˆ‡æ¢ä¹‹åæ‰§è¡Œ**ï¼š

```js
router.afterEach((to, from) => {
    console.log('afterEach',to, from)
    // å€ŸåŠ©åç½®è·¯ç”±å®ˆå«ä¿®æ”¹ç½‘é¡µæ ‡é¢˜ï¼Œå¦‚æœä½¿ç”¨å‰ç½®å®ˆå«ç¼–ç é‡å¤
    document.title = to.meta.title || 'Vue Guard DEMO'
})
```

> æ³¨æ„ï¼šåç½®è·¯ç”±å®ˆå«ä¸ä¼šæœ‰ `next` ã€‚





ğŸŒ° ç‹¬äº«å®ˆå«ä¾‹å­ï¼š

**ç‹¬äº«è·¯ç”±åªæœ‰åœ¨åˆ‡æ¢ç›®æ ‡è·¯ç”±çš„ä¹‹å‰æ‰§è¡Œ**ï¼Œå³**åªèƒ½é…ç½® `beforeEnter`**ï¼š

+ ç»™ `News` ç»„ä»¶é…ç½® `beforeEnter`ï¼š

```js
{
    name: 'News',
    path: 'news',
    component: News,
    meta: {isAuth: true, title: 'æ–°é—»'},
    beforeEnter: (to, from, next) => {
        if (to.meta.isAuth) {
            if (localStorage.getItem('name') === 'simon') {
                next()
            } else {
                alert('æ²¡æœ‰æƒé™')
            }
        } else {
            next()
        }
    }
},
```



ğŸŒ° ç»„ä»¶å†…å®ˆå«ï¼š

> + æ˜¯é€šè¿‡è·¯ç”±è§„åˆ™åˆ‡æ¢è·¯ç”±æˆ–è€…è¿›å…¥è·¯ç”±æ—¶è§¦å‘çš„ã€‚
> + è¦ä¸å‰ç½®è·¯ç”±ä¸åç½®è·¯ç”±åŒºåˆ†ï¼Œè¿™æ˜¯å‘ç”Ÿåœ¨å‰ç½®è·¯ç”±ä¹‹åï¼Œä»¥åŠåç½®è·¯ç”±ä¹‹å‰ï¼Œåœ¨ç»„ä»¶å†…éƒ¨å¤„ç†çš„å®ˆå«é€»è¾‘ï¼Œå¹¶ä¸”ä¸ç¦»å¼€å½“å‰ç»„ä»¶ä¸ä¼šè°ƒç”¨ `beforeRouteLeave`ã€‚

```js
// é€šè¿‡è·¯ç”±è§„åˆ™ï¼Œè¿›å…¥è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨
beforeRouteEnter(to, from, next) {
  // ...
},
// é€šè¿‡è·¯ç”±è§„åˆ™ï¼Œç¦»å¼€è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨
beforeRouteLeave(to, from, next) {
	// ... 
}
```





## è·¯ç”±å™¨çš„ä¸¤ç§å·¥ä½œæ¨¡å¼



å…³äº Hash å€¼ï¼š

+ æ˜¯ URL  åœ°å€ä» `#` å¼€å§‹ä»¥åŠå…¶åé¢çš„å†…å®¹ã€‚

+ Hash å€¼ä¸ä¼šåŒ…å«åœ¨ HTTP è¯·æ±‚ä¸­ï¼Œå³ Hash å€¼ä¸ä¼šåšä¸ºè·¯å¾„çš„ä¸€éƒ¨åˆ†å‘é€ç»™æœåŠ¡å™¨ã€‚



è·¯ç”±å™¨æœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼Œé»˜è®¤æ˜¯ **Hash æ¨¡å¼**ï¼š

+ Hash æ¨¡å¼ï¼š

  + URL åœ°å€æ€»æ˜¯ä¼šå¸¦ç€ `#`ã€‚
  + åœ°å€åˆ†äº«æ—¶å¯èƒ½ä¼šæ ‡è®°ä¸ºä¸åˆæ³•ã€‚
  + æµè§ˆå™¨å…¼å®¹æ€§è¾ƒå¥½ã€‚

+ history æ¨¡å¼ï¼š

  + URL åœ°å€ä¸ Hash æ¨¡å¼ç›¸æ¯”ä¸å¸¦æœ‰ `#` ã€‚

  + æµè§ˆå™¨å…¼å®¹æ€§ä¸ Hash æ¨¡å¼ç›¸æ¯”ç›¸æ¯”ç•¥å·®ã€‚

  + åº”ç”¨éƒ¨ç½²ä¸Šçº¿æ—¶éœ€è¦åç«¯äººå‘˜æ”¯æŒï¼Œ**è¦è§£å†³åˆ·æ–°é¡µé¢æ—¶æœåŠ¡ç«¯æ‰¾ä¸åˆ°èµ„æºçš„é—®é¢˜ã€‚**  

    > ğŸ”— ç›¸å…³é“¾æ¥ï¼š[connect-history-api-fallback - npm (npmjs.com)](https://www.npmjs.com/package/connect-history-api-fallback) Middleware to proxy requests through a specified index page, useful for Single Page Applications that utilise the HTML5 History API. 



ğŸŒ° ä¿®æ”¹è·¯ç”±å™¨çš„å·¥ä½œæ¨¡å¼çš„ä¾‹å­ï¼š

+ åœ¨è·¯ç”±å™¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ  `mode` é…ç½®ï¼š

```js
const router = new VueRouter({
    mode: 'history',
    routes: ...
})
```
